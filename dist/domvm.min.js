/*
 https://github.com/leeoniya/domvm (1.x-dev)
*/
("undefined"!==typeof global?global:this).domvm={};(function(x){var u=("undefined"==typeof window?{}:window).requestAnimationFrame,v={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},m={TYPE_ELEM:1,
TYPE_TEXT:2,isArr:function(c){return c instanceof Array},isVal:function(c){c=typeof c;return"string"===c||"number"===c},isObj:function(c){return"object"===typeof c&&null!==c&&!m.isArr(c)},isFunc:function(c){return"function"===typeof c},isProm:function(c){return"object"===typeof c&&m.isFunc(c.then)},execAll:function(c,f,n,a,p,g){var t;c&&(m.isArr(c)?c:[c]).forEach(function(c){t=c.call(null,f,n,a,p,g)});return t},tick:function(c,f){f&&u?u&&u(function(){m.tick(c,f-1)}):m.isArr(c)?c[0].apply(null,c.slice(1)):
c()},insertArr:function(c,f,n,a){c.splice.apply(c,[n,a].concat(f))},isEvProp:function(c){return"on"===c.substr(0,2)},isDynProp:function(c,f){switch(c){case "input":case "textarea":case "select":case "option":switch(f){case "value":case "checked":case "selected":case "selectedIndex":return!0}}},camelDash:function(c){return c.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},autoPx:function(c,f){return isNaN(f)||v[c]?f:f+"px"},deepSet:function(c,f,n,a,p,g){f=f.split(".");var t=f.pop();f.forEach(function(a){c[a]||
(c[a]={});c=c[a]});if(m.isFunc(c[t]))c[t](n,a,p,g);else c[t]=n},deepGet:function(c,f){var n=f.split(".");do c=c[n.shift()];while(n.length);return c},keyedIdx:function(c,f,n,a,p){for(a=0;a<f.length;a++)if(p=f[a],p.key===c)if(n){if(p.vm&&p.vm.view[0]===n)return a}else return a;return-1},raft:function(c){function f(){n=0;c.apply(a,p)}if(!u)return c;var n,a,p;return function(){a=this;p=arguments;n||(n=u(f))}}};x.utils=m})(domvm);(function(x){function u(){for(var b;b=K.pop();)b[0].apply(null,b.slice(1))}function v(b,e){return!1===e?null:null==e&&null!=b?b:k.isVal(e)||k.isObj(e)||k.isArr(e)||k.isFunc(e)?e:null}function m(b,e,z,a,d,D){function l(b,e,d){if(d)b[e]=b[e]||[],b[e].push(d);else for(var c in e)b[c]=b[c]||[],b[c].push(e[c])}function r(b,e,c){d=b;D=e;q.update(c,!1);null!=q.node&&(d.body[D]=q.node);return m(0,!1)}function E(b){return null==b?"":b}function m(b,c){if(b){for(var a=q;b--&&a.parent;)a=a.parent;a.redraw(0,
!0);return a.vm}(a=q.node)&&f(q,"willRedraw",q);var y=q.refs;q.refs={};var h=q.render.call(q.api,q,e,z);if(!1===h)return q.node.moved=!0,q.node.wasSame=!0,q.refs=y,q;y=p(h,d,D,q);y.vm=q;q.node=y;h=k.isVal(z)&&"^"===z[0]?z.substr(1):k.isVal(y.ref)&&"^"===y.ref[0]?y.ref.substr(1):null;y.key=null!=z?z:y.key;for(var r=d;r;)r.vm&&(q.parent||(q.parent=r.vm),null!==h&&k.deepSet(r.vm.refs,h,y)),r=r.parent;if((h=a)&&(y.type!==a.type||y.tag!==a.tag))var h=null,l=!0,E=a.el.parentNode;g(y,h);d&&(d.body[D]=y);
!1!==c&&(a&&n(a),!a&&w||t(y,null,y.el),l&&(E||y.parent.el).insertBefore(y.el,E.childNodes[a.idx]));a&&f(q,"didRedraw",q);!1!==c&&k.tick(u,2);return q}var w=!d;k.isArr(b)&&(e=b[1],z=b[2],a=b[3],b=b[0]);z=v(e,z);var q={api:{},node:null,view:[b,z],model:e,opts:a||{},render:null,update:function(b,d){null==b||z===e&&!k.isVal(z)||(e=q.model=b);return!1!==d?m(0):q},on:function(b,e){l(q.events,b,e)},hook:function(b,e){q.hooks=q.hooks||{};l(q.hooks,b,e)},events:{},hooks:null,redraw:I.useRaf?k.raft(m):m,patch:function(b,
e){var d=null!=b.el;if(k.isObj(e)){var c="class"in e?(E(b["class"])+" "+E(e["class"])).trim():b.props["class"],a="style"in e?e.style:b.props.style;d&&(d=Object.create(b.props),d["class"]=c,d.style=a,d={tag:b.tag,el:b.el,ns:b.ns,props:d},h(d,b));b.props["class"]=c;b.props.style=a}else c=b.parent,d=g(p(e,c,b.idx,q),b),c.body[b.idx]=d},emit:function(b){for(var e=Array.prototype.slice.call(arguments),d=q,c;d;){if(c=d.events[b]){e[0]=c;k.execAll.apply(null,e);break}d=d.parent}},refs:{},parent:null,mount:function(b,
e){var d=null;e&&(b.textContent="",d=b,b=null);t(q.node,d,null,b);return q},attach:function(b){c(q.node,b);return q},unmount:function(){n(q.node)},moveTo:r,updIdx:function(b){D=b}};a&&a.hooks&&q.hook(a.hooks);k.execAll(F,q);q.render=b.call(q.api,q,e,z);return d?r(d,D):m(0)}function c(b,e){b.el=e;e._node=b;for(var a in b.props){var y=b.props[a],d=k.isEvProp(a)?a:"."===a[0]?a.substr(1):null;null!==d&&(e[d]=y)}if(k.isArr(b.body))for(a=0;a<b.body.length;a++)c(b.body[a],e.childNodes[a])}function f(b,e,
a,c,d,h){if(b&&b.hooks&&(b=b.hooks[e]))if(I.useRaf&&"did"==e.substr(0,3))K.push([k.execAll,b,a,c,d,h]);else return k.execAll(b,a,c,d,h)}function n(b,e){var c=b.el&&!b.moved;if(c){var y=f(b.vm,"willUnmount",b.vm),d=f(b,"willRemove",b),h=y||d;b.removed=!0}b.wasSame?b.wasSame=!1:(k.isArr(b.body)&&b.body.forEach(function(b,d){n(b,e||h)}),e||(h?h.then(function(){a(b,c)}):a(b,c)));b.moved=!1}function a(b,e){null!=b.el&&b.el.parentNode&&(e&&(b.el.parentNode.removeChild(b.el),b.el=null,f(b.vm,"didUnmount",
b.vm),f(b,"didRemove",b)),k.isArr(b.body)&&b.body.forEach(function(b,e){a(b,!b.moved)}))}function p(b,e,a,c){var d=b;b={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,wasSame:!1,removed:!1,hooks:null,tag:null,"class":null,ns:null,guard:!1,raw:!1,props:null,el:null,hasKeys:!1,body:null};k.isFunc(d)&&(d=d());var h=d.length;if(k.isArr(d)&&h){b.type=k.TYPE_ELEM;if(1<h){var l=1;k.isObj(d[1])&&(b.props=d[1],l=2);b.body=h==l+1?k.isVal(d[l])?d[l]:k.isFunc(d[l])?d[l]():d.slice(l):d.slice(l)}d=d[0];
h=L[d];h||(h=["",""],h={tag:(d.match(/^[-\w]+/)||["div"])[0],id:(d.match(/#([-\w]+)/)||h)[1],"class":(d.match(/\.([-\w.]+)/)||h)[1].replace(/\./g," ")},L[d]=h);b.tag=h.tag;if(h.id||h["class"])d=b.props||{},h.id&&null==d.id&&(d.id=h.id),h["class"]&&(b["class"]=h["class"],d["class"]=h["class"]+(null!=d["class"]?" "+d["class"]:"")),b.props=d;if(b.props){var d=b.props,r;for(r in d)k.isEvProp(r)?d[r]=A(d[r],c.opts.evctx||c.model||null,b,c):k.isFunc(d[r])&&("href"==r?(d.onclick=d[r],d.href=d[r].href):d[r]=
d[r]()),k.isDynProp(b.tag,r)&&(d["."+r]=d[r]);if(k.isObj(d.style))for(var g in d.style)r=d.style[g],k.isFunc(r)&&(d.style[g]=r());k.isObj(d._hooks)&&(b.hooks=d._hooks,d._hooks=null);b.key=k.isVal(d._key)?d._key:k.isVal(d._ref)?d._ref:k.isVal(d.id)?d.id:k.isVal(d.name)?d.name:null;null!=d._ref&&(b.ref=d._ref);d._raw&&(b.raw=!0);null!=d._data&&(b.data=d._data);d._guard&&(b.guard=!0);d._ref=d._key=d._raw=d._data=d._guard=null}}else k.isVal(d)&&(b.type=k.TYPE_TEXT,b.body=d);null!==b.ref&&k.deepSet(c.refs,
b.ref,b);b.parent=e;b.idx=a;b.ns=e&&e.ns?e.ns:"svg"===b.tag||"math"===b.tag?b.tag:null;if(k.isArr(b.body))for(e=0,a=b.body.length;e<a;e++){g=b.body[e];d=r=null;l=h=!1;k.isFunc(g)&&(g=g());if(null==g)h=!0;else{var f=k.isArr(g),t=f?!1:k.isObj(g);if(f)g.length?"string"==typeof g[0]&&""!==g[0]?(d=p(g,b,e,c),r=d.key):k.isFunc(g[0])?r=v(g[1],g[2]):l=!0:h=!0;else if(t)if(k.isFunc(g.redraw))g.moveTo(b,e),d=g.node,r=g.view[1];else{b.body[e--]=""+g;continue}else""===g?h=!0:0<e&&b.body[e-1].type===k.TYPE_TEXT?
(b.body[e-1].body+=""+g,h=!0):d=p(""+g,b,e,c)}h||l?(l?k.insertArr(b.body,g,e,1):b.body.splice(e,1),a=b.body.length,e--):(null!==r&&(b.hasKeys=!0),b.body[e]=d||g)}return b}function g(b,e){e&&(f(b,"willRecycle",e,b),G(e,b),f(b,"didRecycle",e,b));if(k.isArr(b.body)){var c=0;b.body.forEach(function(a,d){var h=k.isArr(a);if(e){var l=w(a,b,e,c);if(null!==l){var r=l[0],l=l[1];r===c&&c++;r=e.body[r];r.vm?h?2===l?r.vm.moveTo(b,d,a[1]):1===l&&m(a[0],a[1],a[2],a[3],b,d):a.vm&&2===l&&a.vm===r.vm&&r.vm.moveTo(b,
d):b.body[d]=g(a,r);return}}h?m(a[0],a[1],a[2],a[3],b,d):b.body[d]=g(a)})}return b}function t(b,e,a,c){for(var d=!b.el;a&&a._node.removed;)a=a.nextSibling;d&&f(b.vm,"willMount",b.vm);if(b.type==k.TYPE_ELEM)if(d&&(b.el=e||(b.ns?C.createElementNS(J[b.ns],b.tag):C.createElement(b.tag)),b.props&&h(b)),k.isArr(b.body)){e=0;for(var g=b.el.firstChild;e<b.body.length;e++)g=t(b.body[e],null,g)}else k.isVal(b.body)&&(b.raw?b.el.innerHTML=b.body:d&&(b.el.textContent=b.body));else b.type==k.TYPE_TEXT&&d&&(b.el=
C.createTextNode(b.body));b.el._node=b;e=b.parent;a!==b.el&&(c||e&&e.el)&&(e=d?"Insert":"Reinsert",f(b,"will"+e,b),(c||b.parent.el).insertBefore(b.el,a),f(b,"did"+e,b));d&&b.vm&&b.vm.hooks&&!b.moved&&f(b.vm,"didMount",b.vm);return a!==b.el?a:a.nextSibling}function w(b,e,a,c,d){var h=k.isArr(b),g=h?v(b[1],b[2]):b.key,l=a.hasKeys,p=e.hasKeys;a=a.body;e=e.body;if(null!==g&&l)return b=k.keyedIdx(g,a,h?b[0]:null),-1<b?[b,2]:null;c=c||0;if(c>a.length-1)return null;d=0===d?0:d||a.length-1;for(g=null;c<=
d;c++)if(l=a[c],null!==l&&l.el)if(h&&l.vm){if(l.vm.view[0]===b[0]){if(l.vm.view[1]===v(b[1],b[2]))return[c,2];!g&&p&&-1==k.keyedIdx(l.key,e,l.vm.view[0])&&(g=[c,1])}}else if(b.type===l.type&&(b.type===k.TYPE_TEXT||null!==b.tag&&b.tag===l.tag)&&(null===l.key||!p||-1==k.keyedIdx(l.key,e,l.vm?l.vm.view[0]:null)))return[c,1];return g}function G(b,e){e.el=b.el;b.el=null;e.el&&(e.el._node=e);if(e.type===k.TYPE_TEXT&&e.body!==b.body)e.el.nodeValue=e.body;else{h(e,b);var a=!k.isArr(e.body),c=!k.isArr(b.body);
a&&e.body!==b.body?c&&e.el.firstChild?e.el.firstChild.nodeValue=e.body:e.raw?e.el.innerHTML=e.body:e.el.textContent=e.body:c&&!a&&(e.el.textContent="");b.moved=!0}}function A(b,e,a,c){return function(a){var h,l=a.target._node,g=null;if(k.isFunc(b))h=b.call(e,a,l,c);else if(k.isArr(b))g=b.slice(1),h=b[0].apply(e,g.concat(a,l,c));else if(k.isObj(b))for(var p in b){var f=b[p];a.target.matches(p)&&(k.isArr(f)?(g=f.slice(1),h=f[0].apply(e,g.concat(a,l,c))):k.isFunc(f)&&(h=f.call(e,a,l,c)))}!1===h&&(a.preventDefault(),
a.stopPropagation());c.opts.hasOwnProperty("watch")&&c.opts.watch.fire({type:"event",vm:c,node:l,event:a,data:g})}}function h(b,a){var c=!a;a=a||{};if(a.props||b.props){var h=a.props||{},d=b.props||{},g=h.style,p=d.style;if(k.isObj(g)||k.isObj(p))l(b.el,b.tag,g||{},p||{},M,N,b.ns,c),h.style=d.style=null;l(b.el,b.tag,h,d,B,H,b.ns,c);p&&(d.style=p)}}function l(b,a,c,h,d,g,l,p){for(var k in h)null!==h[k]&&("."===k[0]?b[k.substr(1)]!==h[k]:h[k]!==c[k])&&d(b,k,h[k],l,p);for(k in c)null!==c[k]&&null==h[k]&&
g(b,k,l,p)}function M(b,a,c){b.style[a]=k.autoPx(a,c)}function N(b,a){b.style[a]=""}function B(b,a,c,h,d){"."===a[0]?(a=a.substr(1),"svg"===h?b[a].baseVal=c:b[a]=c):"class"===a?b.className=c:"id"===a||k.isEvProp(a)?b[a]=c:!1===c?H(b,a,h,d):b.setAttribute(a,!0===c?"":c)}function H(b,a,c,h){h||("."===a[0]?(a=a.substr(1),"svg"===c?b[a].baseVal=null:b[a]=null):"class"===a?b.className="":"id"===a||k.isEvProp(a)?b[a]=null:b.removeAttribute(a))}var J={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},
C="undefined"==typeof document?{}:document,L={},K=[],I={useRaf:!0};x.view=m;x.view.config=function(b){I=b};var F=null;x.view.extend=function(b,a){F=!F||a?[]:F;F.push(b)};var k=x.utils;return x})(domvm);(function(x){var u=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,v=x.utils;x.html=function(m){var c="";switch(m.type){case v.TYPE_ELEM:c+="<"+m.tag;if(m.props){var f=v.isVal(m.props.style)?m.props.style:"",n=v.isObj(m.props.style)?m.props.style:null;if(n)for(var a in n)null!==n[a]&&(f+=v.camelDash(a)+": "+v.autoPx(a,n[a])+"; ");for(a in m.props)v.isEvProp(a)||"."===a[0]||(n=m.props[a],v.isFunc(n)&&(n=n()),v.isObj(n)||(!0===n?c+=" "+a:!1!==n&&null!==n&&
"."!==a[0]&&(c+=" "+a+'="'+n+'"')));f.length&&(c+=' style="'+f.trim()+'"')}if(m.ns&&"svg"!==m.tag&&"math"!==m.tag&&!m.body)return c+"/>";c+=">";break;case v.TYPE_TEXT:return m.body}u.test(m.tag)||(v.isArr(m.body)?m.body.forEach(function(a){c+=x.html(a)}):c+=m.body||"",c+="</"+m.tag+">");return c}})(domvm);(function(x){var u=x.utils;x.watch=function(v){function m(){}function c(a,c,g,f,w){w=w||{};w.method=a.toUpperCase();"credentials"in w||(w.credentials="same-origin");null!==g&&(u.isArr(g)||u.isObj(g)?(w.headers=w.headers||new Headers,w.headers.set("Content-Type","application/json"),w.body=JSON.stringify(g)):w.body=""+g);var G=f,A=m;f instanceof Array&&(G=f[0],f[1]&&(A=f[1]));var h={type:"fetch",fetch:{method:a,url:c,body:g}};f=fetch(c,w).then(function(a){if(200<=a.status&&300>a.status)return a;var c=
Error(a.status+": "+a.statusText);c.data=a;return Promise.reject(c)}).then(function(a){switch(a.headers.get("Content-Type").split("; ")[0]){case "application/json":return a.json();case "text/plain":return a.text();default:return a}}).then(G,A).then(function(a){!1!==a&&n.fire(h);return a},function(a){h.error=a;n.fire(h);return a});f._fetchArgs=[a,c,g,[G,A],w];return f}var f=[];u.isFunc(v)&&f.push(v);var n={on:function(a){f.push(a);return n},off:function(a){f.splice(f.indexOf(a),1);return n},fire:u.raft(function(a){u.execAll(f,
a);return n}),prop:function(a,f){var g=a,t=function(a,c,h){if(arguments.length&&a!==g){var l=g;g=a;h=h||{type:"prop",prop:t,data:{old:l,"new":a}};u.isFunc(c)?c(h):!1!==c&&n.fire(h)}return g};t._prop=!0;if(f&&f.then){t.update=m;if(f._fetchArgs){var w=f._fetchArgs[3];f._fetchArgs[3]=[function(a){return t(w[0]?w[0](a):a)},w[1]];t.update=function(){c.apply(null,f._fetchArgs)}}f.then(t)}return t.toString=t},sync:function(a,c,g){var f=a,m=c;u.isFunc(f)||(f=function(c,g,h){if("string"==typeof a){var l,f;
"e."==a.substr(0,2)?(l=c,f=a.substr(2)):(l=c.target,f=a)}return u.deepGet(l,f)});u.isArr(m)&&(m=function(a,g,h){var f=c[0],m=c[1];u.isFunc(m)&&(m=m(h.event,h.node,h.vm));var t=u.deepGet(f,m);a!==t&&(u.deepSet(f,m,a,g,h),u.isFunc(g)?g(h):!1!==g&&n.fire(h))});return function(a,c,h){var l={type:"sync",vm:h,node:c,event:a};m(f(a,c,h),g,l)}},fetch:c,get:function(a,f,g){g?a+=n.query(f):g=f;return c("get",a,null,g)},"delete":function(a,f,g){g?a+=n.query(f):g=f;return c("delete",a,null,g)},post:function(a,
f,g){return c("post",a,f,g)},put:function(a,f,g){return c("put",a,f,g)},patch:function(a,f,g){return c("patch",a,f,g)},query:function(a){if(!u.isObj(a))return"";var c=[],g=encodeURIComponent,f;for(f in a)c.push(g(f)+"="+g(a[f]));return c.length?"?"+c.join("&"):""}};return n}})(domvm);(function(x){function u(a,c,g,f,m,n){var u=null,h=null,l=null;if("/"==g[0]){l=g;h=!1;f={};n=l.split("#");c=n[0].split("?");u=c[0];n=n[1];c[1]&&(m={},c[1].split("&").map(function(a){a=a.split("=");m[a[0]]=null==a[1]?!0:a[1]}));var v,x;for(x in a){g=a[x];var B=g.path;if(v=u.match(g.regexPath)){h=x;-1!==B.indexOf(":")&&(f={},v.shift(),B.replace(/:([^\/]+)/g,function(a,c){f[c]=v.shift()}));break}}}else{h=g;g=a[h];var B=c+g.path,H=g.vars||{},J=/^[^\/]+$/,l=-1!==B.indexOf(":")?u=B.replace(/:([^\/]+)/g,
function(a,c){if((H[c]||J).test(f[c]))return f[c]+="";throw Error("Invalid value for route '"+B+"' segment '"+c+"': '"+f[c]+"'");}):u=B;if(m){var l=l+"?",C;for(C in m)l+=C+(!0!==m[C]?"="+m[C]:"")+"&";l=l.slice(0,-1)}l+=n?"#"+n:""}return{href:l,name:h,path:u,segs:f,hash:n,query:m}}function v(a,c){for(var f in a){var m=a[f];m.regexPath=new RegExp("^"+c+m.path.replace(/:([^\/]+)/g,function(a,c){var f=""+m.vars[c];return"("+f.substring(1,f.lastIndexOf("/"))+")"})+"$")}}var m=[],c=null,f=!1,n="";x.route=
function(a,p){function g(){var a=location,a=f?a.href.substr(a.origin.length):a.hash.substr(1)||"/";return u(A,n,a)}var t=null,w={href:function(a,c,g,m,p){var t=u(A,n,a,c,g,m);return f?(a=function(a){w["goto"](t,null,null,null,p);a.preventDefault()},a.href=t.href,a):"#"+t.href},config:function(a){(f=a.useHist)&&(n=a.root||"");t=a.init||null},refresh:function(){w["goto"](g(),null,null,null,!0)},"goto":function(a,g,p,t,v){v=v||x;a.href||(a=u(A,n,a,g,p,t));if(!1===a.name)console.log("Could not find route");
else{g=null;for(p=0;p<m.length;p++)if(m[p].href===a.href){g=p;break}null===g&&(m.splice(c+1,1E4),m.push(a),g=m.length-1);a=m[c];p=m[g];t=!0;null!==c&&(t=(t=A[a.name].onexit)?t.apply(null,(a?[a.segs,a.query,a.hash]:[]).concat(p)):!0);if(!1!==t&&!1!==A[p.name].onenter.apply(null,(p?[p.segs,p.query,p.hash]:[]).concat(a))){if(f)history[v?"replaceState":"pushState"](null,"title",p.href);c=g}x=!1}},location:function(){return x?g():m[c]}},x=!0,A=a(w,p);v(A,n);window.onhashchange=window.onpopstate=function(a){(f||
"popstate"!=a.type)&&w["goto"](g(),null,null,null,!0)};t&&t();return w}})(domvm);
