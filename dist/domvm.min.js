/*
 https://github.com/leeoniya/domvm (1.x-dev)
*/
("undefined"!==typeof global?global:this).domvm={};(function(x){var t=("undefined"==typeof window?{}:window).requestAnimationFrame,v={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},l={TYPE_ELEM:1,
TYPE_TEXT:2,isArr:function(c){return c instanceof Array},isVal:function(c){c=typeof c;return"string"===c||"number"===c},isObj:function(c){return"object"===typeof c&&null!==c&&!l.isArr(c)},isFunc:function(c){return"function"===typeof c},isProm:function(c){return"object"===typeof c&&l.isFunc(c.then)},execAll:function(c,d,m,b,p,n){var r;c&&(l.isArr(c)?c:[c]).forEach(function(c){r=c.call(null,d,m,b,p,n)});return r},tick:function(c,d){d&&t?t&&t(function(){l.tick(c,d-1)}):l.isArr(c)?c[0].apply(null,c.slice(1)):
c()},insertArr:function(c,d,m,b){c.splice.apply(c,[m,b].concat(d))},isEvProp:function(c){return"on"===c.substr(0,2)},isDynProp:function(c,d){switch(c){case "input":case "textarea":case "select":case "option":switch(d){case "value":case "checked":case "selected":case "selectedIndex":return!0}}},camelDash:function(c){return c.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},autoPx:function(c,d){return isNaN(d)||v[c]?d:d+"px"},deepSet:function(c,d,m){d=d.split(".");var b=d.pop();d.forEach(function(b){c[b]||
(c[b]={});c=c[b]});c[b]=m},deepGet:function(c,d){var m=d.split(".");do c=c[m.shift()];while(m.length);return c},keyedIdx:function(c,d,m,b,p){for(b=0;b<d.length;b++)if(p=d[b],p.key===c)if(m){if(p.vm&&p.vm.view[0]===m)return b}else return b;return-1},raft:function(c){function d(){m=0;c.apply(b,p)}if(!t)return c;var m,b,p;return function(){b=this;p=arguments;m||(m=t(d))}}};x.utils=l})(domvm);(function(x){function t(){for(var a;a=L.pop();)a[0].apply(null,a.slice(1))}function v(a,f){return!1===f?null:null==f&&null!=a?a:k.isVal(f)||k.isObj(f)||k.isArr(f)||k.isFunc(f)?f:null}function l(a,f,z,b,e,D){function h(a,f,e){if(e)a[f]=a[f]||[],a[f].push(e);else for(var c in f)a[c]=a[c]||[],a[c].push(f[c])}function u(a,f,c){e=a;D=f;q.update(c,!1);null!=q.node&&(e.body[D]=q.node);return l(0,!1)}function E(a){return null==a?"":a}function l(a,c){if(a){for(var b=q;a--&&b.parent;)b=b.parent;b.redraw(0,
!0);return b.vm}(b=q.node)&&d(q,"willRedraw",q);var y=q.refs;q.refs={};var u=q.render.call(q.api,q,f,z);if(!1===u)return q.node.moved=!0,q.node.wasSame=!0,q.refs=y,q;y=p(u,e,D,q);y.vm=q;q.node=y;u=k.isVal(z)&&"^"===z[0]?z.substr(1):k.isVal(y.ref)&&"^"===y.ref[0]?y.ref.substr(1):null;y.key=null!=z?z:y.key;for(var g=e;g;)g.vm&&(q.parent||(q.parent=g.vm),null!==u&&k.deepSet(g.vm.refs,u,y)),g=g.parent;if((u=b)&&(y.type!==b.type||y.tag!==b.tag))var u=null,h=!0,E=b.el.parentNode;n(y,u);e&&(e.body[D]=y);
!1!==c&&(b&&m(b),!b&&w||r(y,null,y.el),h&&(E||y.parent.el).insertBefore(y.el,E.childNodes[b.idx]));b&&d(q,"didRedraw",q);!1!==c&&k.tick(t,2);return q}var w=!e;k.isArr(a)&&(f=a[1],z=a[2],b=a[3],a=a[0]);z=v(f,z);var q={api:{},node:null,view:[a,z],model:f,opts:b||{},render:null,update:function(a,e){null==a||z===f&&!k.isVal(z)||(f=q.model=a);return!1!==e?l(0):q},on:function(a,f){h(q.events,a,f)},hook:function(a,f){q.hooks=q.hooks||{};h(q.hooks,a,f)},events:{},hooks:null,redraw:J.useRaf?k.raft(l):l,patch:function(a,
f){var e=null!=a.el;if(k.isObj(f)){var b="class"in f?(E(a["class"])+" "+E(f["class"])).trim():a.props["class"],c="style"in f?f.style:a.props.style;e&&(e=Object.create(a.props),e["class"]=b,e.style=c,e={tag:a.tag,el:a.el,ns:a.ns,props:e},g(e,a));a.props["class"]=b;a.props.style=c}else b=a.parent,e=n(p(f,b,a.idx,q),a),b.body[a.idx]=e},emit:function(a){for(var f=Array.prototype.slice.call(arguments),e=q,b;e;){if(b=e.events[a]){f[0]=b;k.execAll.apply(null,f);break}e=e.parent}},refs:{},parent:null,mount:function(a,
f){var e=null;f&&(a.textContent="",e=a,a=null);r(q.node,e,null,a);return q},attach:function(a){c(q.node,a);return q},unmount:function(){m(q.node)},moveTo:u,updIdx:function(a){D=a}};b&&b.hooks&&q.hook(b.hooks);k.execAll(F,q);q.render=a.call(q.api,q,f,z);return e?u(e,D):l(0)}function c(a,f){a.el=f;f._node=a;for(var b in a.props){var y=a.props[b],e=k.isEvProp(b)?b:"."===b[0]?b.substr(1):null;null!==e&&(f[e]=y)}if(k.isArr(a.body))for(b=0;b<a.body.length;b++)c(a.body[b],f.childNodes[b])}function d(a,f,
b,c,e,g){if(a&&a.hooks&&(a=a.hooks[f]))if(J.useRaf&&"did"==f.substr(0,3))L.push([k.execAll,a,b,c,e,g]);else return k.execAll(a,b,c,e,g)}function m(a,f){var c=a.el&&!a.moved;if(c){var y=d(a.vm,"willUnmount",a.vm),e=d(a,"willRemove",a),g=y||e;a.removed=!0}a.wasSame?a.wasSame=!1:(k.isArr(a.body)&&a.body.forEach(function(a,e){m(a,f||g)}),f||(g?g.then(function(){b(a,c)}):b(a,c)));a.moved=!1}function b(a,f){null!=a.el&&a.el.parentNode&&(f&&(a.el.parentNode.removeChild(a.el),a.el=null,d(a.vm,"didUnmount",
a.vm),d(a,"didRemove",a)),k.isArr(a.body)&&a.body.forEach(function(a,f){b(a,!a.moved)}))}function p(a,f,b,c){var e=a;a={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,wasSame:!1,removed:!1,hooks:null,tag:null,"class":null,ns:null,guard:!1,raw:!1,props:null,el:null,hasKeys:!1,body:null};k.isFunc(e)&&(e=e());var g=e.length;if(k.isArr(e)&&g){a.type=k.TYPE_ELEM;if(1<g){var h=1;k.isObj(e[1])&&(a.props=e[1],h=2);a.body=g==h+1?k.isVal(e[h])?e[h]:k.isFunc(e[h])?e[h]():e.slice(h):e.slice(h)}e=e[0];
g=M[e];g||(g=["",""],g={tag:(e.match(/^[-\w]+/)||["div"])[0],id:(e.match(/#([-\w]+)/)||g)[1],"class":(e.match(/\.([-\w.]+)/)||g)[1].replace(/\./g," ")},M[e]=g);a.tag=g.tag;if(g.id||g["class"])e=a.props||{},g.id&&null==e.id&&(e.id=g.id),g["class"]&&(a["class"]=g["class"],e["class"]=g["class"]+(null!=e["class"]?" "+e["class"]:"")),a.props=e;if(a.props){var e=a.props,u;for(u in e)k.isEvProp(u)?e[u]=A(e[u],c.opts.evctx||c.model||null,a,c):k.isFunc(e[u])&&("href"==u?(e.onclick=e[u],e.href=e[u].href):e[u]=
e[u]()),k.isDynProp(a.tag,u)&&(e["."+u]=e[u]);if(k.isObj(e.style))for(var d in e.style)u=e.style[d],k.isFunc(u)&&(e.style[d]=u());k.isObj(e._hooks)&&(a.hooks=e._hooks,e._hooks=null);a.key=k.isVal(e._key)?e._key:k.isVal(e._ref)?e._ref:k.isVal(e.id)?e.id:k.isVal(e.name)?e.name:null;null!=e._ref&&(a.ref=e._ref);e._raw&&(a.raw=!0);null!=e._data&&(a.data=e._data);e._guard&&(a.guard=!0);e._ref=e._key=e._raw=e._data=e._guard=null}}else k.isVal(e)&&(a.type=k.TYPE_TEXT,a.body=e);null!==a.ref&&k.deepSet(c.refs,
a.ref,a);a.parent=f;a.idx=b;a.ns=f&&f.ns?f.ns:"svg"===a.tag||"math"===a.tag?a.tag:null;if(k.isArr(a.body))for(f=0,b=a.body.length;f<b;f++){d=a.body[f];e=u=null;h=g=!1;k.isFunc(d)&&(d=d());if(null==d)g=!0;else{var n=k.isArr(d),m=n?!1:k.isObj(d);if(n)d.length?"string"==typeof d[0]&&""!==d[0]?(e=p(d,a,f,c),u=e.key):k.isFunc(d[0])?u=v(d[1],d[2]):h=!0:g=!0;else if(m)if(k.isFunc(d.redraw))d.moveTo(a,f),e=d.node,u=d.view[1];else{a.body[f--]=""+d;continue}else""===d?g=!0:0<f&&a.body[f-1].type===k.TYPE_TEXT?
(a.body[f-1].body+=""+d,g=!0):e=p(""+d,a,f,c)}g||h?(h?k.insertArr(a.body,d,f,1):a.body.splice(f,1),b=a.body.length,f--):(null!==u&&(a.hasKeys=!0),a.body[f]=e||d)}return a}function n(a,f){f&&(d(a,"willRecycle",f,a),G(f,a),d(a,"didRecycle",f,a));if(k.isArr(a.body)){var b=0;a.body.forEach(function(c,e){var g=k.isArr(c);if(f){var d=w(c,a,f,b);if(null!==d){var h=d[0],d=d[1];h===b&&b++;h=f.body[h];h.vm?g?2===d?h.vm.moveTo(a,e,c[1]):1===d&&l(c[0],c[1],c[2],c[3],a,e):c.vm&&2===d&&c.vm===h.vm&&h.vm.moveTo(a,
e):a.body[e]=n(c,h);return}}g?l(c[0],c[1],c[2],c[3],a,e):a.body[e]=n(c)})}return a}function r(a,f,b,c){for(var e=!a.el;b&&b._node.removed;)b=b.nextSibling;e&&d(a.vm,"willMount",a.vm);if(a.type==k.TYPE_ELEM)if(e&&(a.el=f||(a.ns?C.createElementNS(K[a.ns],a.tag):C.createElement(a.tag)),a.props&&g(a)),k.isArr(a.body)){f=0;for(var h=a.el.firstChild;f<a.body.length;f++)h=r(a.body[f],null,h)}else k.isVal(a.body)&&(a.raw?a.el.innerHTML=a.body:e&&(a.el.textContent=a.body));else a.type==k.TYPE_TEXT&&e&&(a.el=
C.createTextNode(a.body));a.el._node=a;f=a.parent;b!==a.el&&(c||f&&f.el)&&(f=e?"Insert":"Reinsert",d(a,"will"+f,a),(c||a.parent.el).insertBefore(a.el,b),d(a,"did"+f,a));e&&a.vm&&a.vm.hooks&&!a.moved&&d(a.vm,"didMount",a.vm);return b!==a.el?b:b.nextSibling}function w(a,f,b,c,e){var g=k.isArr(a),d=g?v(a[1],a[2]):a.key,h=b.hasKeys,p=f.hasKeys;b=b.body;f=f.body;if(null!==d&&h)return a=k.keyedIdx(d,b,g?a[0]:null),-1<a?[a,2]:null;c=c||0;if(c>b.length-1)return null;e=0===e?0:e||b.length-1;for(d=null;c<=
e;c++)if(h=b[c],null!==h&&h.el)if(g&&h.vm){if(h.vm.view[0]===a[0]){if(h.vm.view[1]===v(a[1],a[2]))return[c,2];!d&&p&&-1==k.keyedIdx(h.key,f,h.vm.view[0])&&(d=[c,1])}}else if(a.type===h.type&&(a.type===k.TYPE_TEXT||null!==a.tag&&a.tag===h.tag)&&(null===h.key||!p||-1==k.keyedIdx(h.key,f,h.vm?h.vm.view[0]:null)))return[c,1];return d}function G(a,f){f.el=a.el;a.el=null;f.el&&(f.el._node=f);if(f.type===k.TYPE_TEXT&&f.body!==a.body)f.el.nodeValue=f.body;else{g(f,a);var b=!k.isArr(f.body),c=!k.isArr(a.body);
b&&f.body!==a.body?c&&f.el.firstChild?f.el.firstChild.nodeValue=f.body:f.raw?f.el.innerHTML=f.body:f.el.textContent=f.body:c&&!b&&(f.el.textContent="");a.moved=!0}}function A(a,f,b,c){return function(b){var g,h=b.target._node,d=null;if(k.isFunc(a))g=a.call(f,b,h,c);else if(k.isArr(a))d=a.slice(1),g=a[0].apply(f,d.concat(b,h,c));else if(k.isObj(a))for(var p in a){var n=a[p];b.target.matches(p)&&(k.isArr(n)?(d=n.slice(1),g=n[0].apply(f,d.concat(b,h,c))):k.isFunc(n)&&(g=n.call(f,b,h,c)))}!1===g&&(b.preventDefault(),
b.stopPropagation());c.opts.hasOwnProperty("watch")&&c.opts.watch.fire({type:"event",vm:c,node:h,event:b,data:d})}}function g(a,b){var c=!b;b=b||{};if(b.props||a.props){var g=b.props||{},e=a.props||{},d=g.style,p=e.style;if(k.isObj(d)||k.isObj(p))h(a.el,a.tag,d||{},p||{},H,N,a.ns,c),g.style=e.style=null;h(a.el,a.tag,g,e,B,I,a.ns,c);p&&(e.style=p)}}function h(a,b,c,g,e,d,h,p){for(var k in g)null!==g[k]&&("."===k[0]?a[k.substr(1)]!==g[k]:g[k]!==c[k])&&e(a,k,g[k],h,p);for(k in c)null!==c[k]&&null==g[k]&&
d(a,k,h,p)}function H(a,b,c){a.style[b]=k.autoPx(b,c)}function N(a,b){a.style[b]=""}function B(a,b,c,g,e){"."===b[0]?(b=b.substr(1),"svg"===g?a[b].baseVal=c:a[b]=c):"class"===b?a.className=c:"id"===b||k.isEvProp(b)?a[b]=c:!1===c?I(a,b,g,e):a.setAttribute(b,!0===c?"":c)}function I(a,b,c,g){g||("."===b[0]?(b=b.substr(1),"svg"===c?a[b].baseVal=null:a[b]=null):"class"===b?a.className="":"id"===b||k.isEvProp(b)?a[b]=null:a.removeAttribute(b))}var K={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},
C="undefined"==typeof document?{}:document,M={},L=[],J={useRaf:!0};x.view=l;x.view.config=function(a){J=a};var F=null;x.view.extend=function(a,b){F=!F||b?[]:F;F.push(a)};var k=x.utils;return x})(domvm);(function(x){var t=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,v=x.utils;x.html=function(l){var c="";switch(l.type){case v.TYPE_ELEM:c+="<"+l.tag;if(l.props){var d=v.isVal(l.props.style)?l.props.style:"",m=v.isObj(l.props.style)?l.props.style:null;if(m)for(var b in m)null!==m[b]&&(d+=v.camelDash(b)+": "+v.autoPx(b,m[b])+"; ");for(b in l.props)v.isEvProp(b)||"."===b[0]||(m=l.props[b],v.isFunc(m)&&(m=m()),v.isObj(m)||(!0===m?c+=" "+b:!1!==m&&null!==m&&
"."!==b[0]&&(c+=" "+b+'="'+m+'"')));d.length&&(c+=' style="'+d.trim()+'"')}if(l.ns&&"svg"!==l.tag&&"math"!==l.tag&&!l.body)return c+"/>";c+=">";break;case v.TYPE_TEXT:return l.body}t.test(l.tag)||(v.isArr(l.body)?l.body.forEach(function(b){c+=x.html(b)}):c+=l.body||"",c+="</"+l.tag+">");return c}})(domvm);(function(x){var t=x.utils;x.watch=function(v){function l(){}function c(b,c,d,r,w){w=w||{};w.method=b.toUpperCase();"credentials"in w||(w.credentials="same-origin");null!==d&&(t.isArr(d)||t.isObj(d)?(w.headers=w.headers||new Headers,w.headers.set("Content-Type","application/json"),w.body=JSON.stringify(d)):w.body=""+d);var G=r,A=l;r instanceof Array&&(G=r[0],r[1]&&(A=r[1]));var g={type:"fetch",fetch:{method:b,url:c,body:d}};r=fetch(c,w).then(function(b){if(200<=b.status&&300>b.status)return b;var c=
Error(b.status+": "+b.statusText);c.data=b;return Promise.reject(c)}).then(function(b){switch(b.headers.get("Content-Type").split("; ")[0]){case "application/json":return b.json();case "text/plain":return b.text();default:return b}}).then(G,A).then(function(b){!1!==b&&m.fire(g);return b},function(b){g.error=b;m.fire(g);return b});r._fetchArgs=[b,c,d,[G,A],w];return r}var d=[];t.isFunc(v)&&d.push(v);var m={on:function(b){d.push(b);return m},off:function(b){d.splice(d.indexOf(b),1);return m},fire:t.raft(function(b){t.execAll(d,
b);return m}),prop:function(b,d){var n=b,r=function(b,c,g){if(arguments.length&&b!==n){var d=n;n=b;g=g||{type:"prop",prop:r,data:{old:d,"new":b}};t.isFunc(c)?c(g):!1!==c&&m.fire(g)}return n};r._prop=!0;if(d&&d.then){r.update=l;if(d._fetchArgs){var w=d._fetchArgs[3];d._fetchArgs[3]=[function(b){return r(w[0]?w[0](b):b)},w[1]];r.update=function(){c.apply(null,d._fetchArgs)}}d.then(r)}return r.toString=r},sync:function(b,c,d){var r=b,l=c;t.isFunc(r)||(r=function(c,d,g){if("string"==typeof b){var h,p;
"e."==b.substr(0,2)?(h=c,p=b.substr(2)):(h=c.target,p=b)}return t.deepGet(h,p)});t.isArr(l)&&(l=function(b,d,g){var h=t.deepGet(c[0],c[1]);b!==h&&(t.deepSet(c[0],c[1],b),t.isFunc(d)?d(g):!1!==d&&m.fire(g))});return function(b,c,g){var h={type:"sync",vm:g,node:c,event:b};l(r(b,c,g),d,h)}},fetch:c,get:function(b,d,n){n?b+=m.query(d):n=d;return c("get",b,null,n)},"delete":function(b,d,n){n?b+=m.query(d):n=d;return c("delete",b,null,n)},post:function(b,d,n){return c("post",b,d,n)},put:function(b,d,n){return c("put",
b,d,n)},patch:function(b,d,n){return c("patch",b,d,n)},query:function(b){if(!t.isObj(b))return"";var c=[],d=encodeURIComponent,l;for(l in b)c.push(d(l)+"="+d(b[l]));return c.length?"?"+c.join("&"):""}};return m}})(domvm);(function(x){function t(b,c,d,l,m,t){var v=null,g=null,h=null;if("/"==d[0]){h=d;g=!1;l={};t=h.split("#");c=t[0].split("?");v=c[0];t=t[1];c[1]&&(m={},c[1].split("&").map(function(b){b=b.split("=");m[b[0]]=null==b[1]?!0:b[1]}));var H,x;for(x in b){d=b[x];var B=d.path;if(H=v.match(d.regexPath)){g=x;-1!==B.indexOf(":")&&(l={},H.shift(),B.replace(/:([^\/]+)/g,function(b,c){l[c]=H.shift()}));break}}}else{g=d;d=b[g];var B=c+d.path,I=d.vars||{},K=/^[^\/]+$/,h=-1!==B.indexOf(":")?v=B.replace(/:([^\/]+)/g,
function(b,c){if((I[c]||K).test(l[c]))return l[c]+="";throw Error("Invalid value for route '"+B+"' segment '"+c+"': '"+l[c]+"'");}):v=B;if(m){var h=h+"?",C;for(C in m)h+=C+(!0!==m[C]?"="+m[C]:"")+"&";h=h.slice(0,-1)}h+=t?"#"+t:""}return{href:h,name:g,path:v,segs:l,hash:t,query:m}}function v(b,c){for(var d in b){var l=b[d];l.regexPath=new RegExp("^"+c+l.path.replace(/:([^\/]+)/g,function(b,c){var d=""+l.vars[c];return"("+d.substring(1,d.lastIndexOf("/"))+")"})+"$")}}var l=[],c=null,d=!1,m="";x.route=
function(b,p){function n(){var b=location,b=d?b.href.substr(b.origin.length):b.hash.substr(1)||"/";return t(A,m,b)}var r=null,w={href:function(b,c,l,n,p){var r=t(A,m,b,c,l,n);return d?(b=function(b){w["goto"](r,null,null,null,p);b.preventDefault()},b.href=r.href,b):"#"+r.href},config:function(b){(d=b.useHist)&&(m=b.root||"");r=b.init||null},refresh:function(){w["goto"](n(),null,null,null,!0)},"goto":function(b,h,n,p,r){r=r||x;b.href||(b=t(A,m,b,h,n,p));if(!1===b.name)console.log("Could not find route");
else{h=null;for(n=0;n<l.length;n++)if(l[n].href===b.href){h=n;break}null===h&&(l.splice(c+1,1E4),l.push(b),h=l.length-1);b=l[c];n=l[h];p=!0;null!==c&&(p=(p=A[b.name].onexit)?p.apply(null,(b?[b.segs,b.query,b.hash]:[]).concat(n)):!0);if(!1!==p&&!1!==A[n.name].onenter.apply(null,(n?[n.segs,n.query,n.hash]:[]).concat(b))){if(d)history[r?"replaceState":"pushState"](null,"title",n.href);c=h}x=!1}},location:function(){return x?n():l[c]}},x=!0,A=b(w,p);v(A,m);window.onhashchange=window.onpopstate=function(b){(d||
"popstate"!=b.type)&&w["goto"](n(),null,null,null,!0)};r&&r();return w}})(domvm);
