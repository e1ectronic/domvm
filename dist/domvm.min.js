/*
 https://github.com/leeoniya/domvm
*/
("object"===typeof module&&"object"===typeof module.exports&&function(q){module.exports=q()}||"function"===typeof define&&function(q){define("domvm",q)}||function(q){window.domvm=q()})(function(){return{}});(function(q){var w="undefined"==typeof window?{}:window,r={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(b){return b instanceof Array},isVal:function(b){b=typeof b;return"string"===b||"number"===b},isObj:function(b){return"object"===typeof b&&null!==b&&!r.isArr(b)},isFunc:function(b){return"function"===typeof b},execAll:function(b,g){b.forEach(function(b){return b.apply(null,g)})},insertArr:function(b,g,n,f){b.splice.apply(b,[n,f].concat(g))},isEvProp:function(b){return"on"===b.substr(0,2)},camelDash:function(b){return b.replace(/([a-z])([A-Z])/g,
"$1-$2").toLowerCase()},raft:function(b){function g(){n=0;b.apply(f,d)}if(!w.requestAnimationFrame)return b;var n,f,d;return function(){f=this;d=arguments;n||(n=w.requestAnimationFrame(g))}}};domvm.util=r})(domvm);(function(q){function w(a,e,m,z,c,d,y){function k(a,c,e){d=a;y=c;return u(e,!1)}function u(a,c){l.execAll(p.events.willRedraw);p.imp=null!=a?a:z;p.refs={};var k=p.node,h=p.render.call(e,p.imp),h=g(h,d,y,p);h.key=l.isVal(m)?m:h.key;h.vm=p;p.node=h;var v=k;if(k&&(h.type!==k.type||h.tag!==k.tag))var v=null,x=!0;n(h,v);d&&(d.body[y]=h);!1!==c&&(k&&b(k),!k&&A||f(h),x&&(k.el.parentNode.replaceChild(h.el,k.el),k.el=null));setTimeout(function(){var a=p,c;for(c in a.refs)a.refs[c]=a.refs[c].el;l.execAll(p.events.didRedraw)},
0);return p}function h(a){var c=null,e=a.split(":");2==e.length&&(a=e[0],c=+e[1]);var e=Array.prototype.slice.call(arguments,1),m=p.node;if(null!==c){for(;c&&m.parent;)m=m.parent,m.vm&&c--;(c=(c=m.vm?m.vm.events:null)?c[a]:null)&&c.apply(null,e)}else for(;m&&(!m.vm||!(c=(c=m.vm.events)?c[a]:null)||!1!==c.apply(null,e));)m=m.parent}var A=!d;l.isArr(a)&&(e=a[1],m=a[2],z=a[3],c=a[4],a=a[0]);!1===m&&(z=e,m=e=null);var p={exp:{},imp:z||{},node:null,view:[a,e,m],opts:c||{},render:null,on:function(a,c){if(c)p.events[a].push(c);
else for(var e in a)p.events[e].push(a[e])},events:{willRedraw:[],didRedraw:[],willDestroy:[],didDestroy:[]},redraw:C.useRaf?l.raft(u):u,patch:function(a,c){var e=a.parent,m=n(g(c,e,a.idx,p),a);e.body[a.idx]=m;var d=m.key;l.isVal(d)&&(e.keyMap[d]=m)},emit:h,refs:{},mount:function(a){f(p.node);a.insertBefore(p.node.el,null);return p},attach:function(a){r(p.node,a);return p},destroy:function(a){l.execAll(p.events.willDestroy);if(d)if(a){for(a=y+1;a<d.body.length;a++){var c=d.body[a];c.idx=a-1;c.vm&&
c.vm.updIdx(c.idx)}d.body.splice(y,1)}else d.body[y]=null;b(p.node,!0);p.node.vm=null;l.execAll(p.events.didDestroy)},moveTo:k,updIdx:function(a){y=a}};p.events._redraw=p.redraw;p.render=a.call(p.exp,p,e,m,z);h.redraw=function(a){a=l.isVal(a)?a:1E3;h("_redraw:"+a)};return d?k(d,y,z):u(z)}function r(a,e){a.el=e;if(l.isArr(a.body))for(var m=0;m<a.body.length;m++)r(a.body[m],e.childNodes[m])}function b(a,e){l.isArr(a.body)&&(a.body.forEach(function(a,e){a&&(a.vm&&!a.moved?a.vm.destroy():a.el&&a.el.parentNode?
a.el.parentNode.removeChild(a.el):b(a))}),a.body=null);a.vm=null;e&&a.el&&(a.el.parentNode.removeChild(a.el),a.el=null)}function g(a,e,m,d){var c=a;a={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,keyMap:null,body:null};l.isFunc(c)&&(c=c());if(l.isArr(c)&&c.length){a.type=l.TYPE_ELEM;if(1<c.length){var b=1;l.isObj(c[1])&&(a.props=c[1],b=2);a.body=c.length==b+1?l.isVal(c[b])?c[b]:l.isFunc(c[b])?c[b]():c.slice(b):c.slice(b)}c=c[0];if(/[.#]/.test(c)){if(c=
h(c),a.tag=c.tag,c.id||c["class"])a.props=a.props||{},a.props.id=c.id,a.props["class"]=c["class"]}else a.tag=c;if(a.props){var c=a.props,f;for(f in c)l.isEvProp(f)?c[f]=t(c[f],d.opts.evctx||d.view[1]||d.imp||null,a,d):l.isFunc(c[f])&&("href"==f?(c.onclick=c[f],c.href=c[f].url):c[f]=c[f]());if(l.isObj(c.style))for(var k in c.style)f=c.style[k],l.isFunc(f)&&(c.style[k]=f());a.key=l.isVal(c._key)?c._key:l.isVal(c._ref)?c._ref:l.isVal(c.id)?c.id:l.isVal(c.name)?c.name:null;c._ref&&(a.ref=c._ref);c._raw&&
(a.raw=!0);c._guard&&(a.guard=!0);c._ref=c._key=c._raw=c._guard=null}}else l.isVal(c)&&(a.type=l.TYPE_TEXT,a.body=c);null!==a.ref&&(d.refs[a.ref]=a);a.parent=e;a.idx=m;a.ns=e&&e.ns?e.ns:"svg"===a.tag||"math"===a.tag?a.tag:null;if(l.isArr(a.body)){e={};m=!1;k=0;for(f=a.body.length;k<f;k++){var c=a.body[k],u=b=null,v=!1,A=!1;l.isFunc(c)&&(c=c());if(null==c)v=!0;else{var p=l.isArr(c),x=p?!1:l.isObj(c);if(p)c.length?l.isArr(c[0])?A=!0:l.isFunc(c[0])?b=c[2]:(u=g(c,a,k,d),b=u.key):v=!0;else if(x)if(l.isFunc(c.redraw))c.moveTo(a,
k),u=c.node,b=c.view[2];else{a.body[k--]=""+c;continue}else""===c?v=!0:0<k&&a.body[k-1].type===l.TYPE_TEXT?(a.body[k-1].body+=""+c,v=!0):u=g(""+c,a,k,d)}v||A?(A?l.insertArr(a.body,c,k,1):a.body.splice(k,1),f=a.body.length,k--):(l.isVal(b)&&(e[b]=k,m=!0),a.body[k]=u||c)}m&&(a.keyMap=e)}return a}function n(a,e){e&&v(e,a);l.isArr(a.body)&&a.body.forEach(function(m,b){var c=l.isArr(m);if(e){var f=d(m,a,e);if(null!==f){var h=f[1],f=e.body[f[0]];c&&f.vm?2===h?f.vm.moveTo(a,b,m[3]):1===h&&w(m[0],m[1],m[2],
m[3],m[4],a,b):a.body[b]=n(m,f);return}}c?w(m[0],m[1],m[2],m[3],m[4],a,b):a.body[b]=n(m)});return a}function f(a){var e=!a.el;a.type==l.TYPE_ELEM?(e&&(a.el=a.ns?D.createElementNS(B[a.ns],a.tag):D.createElement(a.tag),a.props&&u(a)),l.isArr(a.body)?a.body.forEach(f):e&&l.isVal(a.body)&&(a.raw?a.el.innerHTML=a.body:a.el.textContent=a.body)):a.type==l.TYPE_TEXT&&e&&(a.el=D.createTextNode(a.body));a.el._node=a;(e=a.parent)&&e.el&&e.el.childNodes[a.idx]!==a.el&&e.el.insertBefore(a.el,e.el.childNodes[a.idx])}
function d(a,e,m,b,c){var f=l.isArr(a),d=f?a[2]||null:a.key,k=m.keyMap,h=e.keyMap;m=m.body;e=e.body;if(null!==d&&k&&l.isVal(k[d]))return[k[d],2];b=b||0;if(b>m.length-1)return null;c=0===c?0:c||m.length-1;for(d=null;b<=c;b++)if(k=m[b],null!==k&&k.el)if(f&&k.vm){if(k.vm.view[0]===a[0]){if(k.vm.view[1]===a[1])return[b,2];var u=!1;if(C.viewScan)for(var g=0;g<e.length;g++){var p=e[g];if(!p.el&&p.vm&&p.vm.view[0]===k.vm.view[0]&&p.vm.view[1]===k.vm.view[1]){u=!0;break}}u||d||!h||l.isVal(h[k.key])||(d=[b,
1])}}else if(!(a.type!==k.type||a.type!==l.TYPE_TEXT&&(null===a.tag||a.tag!==k.tag)||null!==k.key&&h&&l.isVal(h[k.key])))return[b,1];return d}function v(a,e){e.el=a.el;a.el=null;if(e.type===l.TYPE_TEXT&&e.body!==a.body)e.el.nodeValue=e.body;else{u(e,a);var b=!l.isArr(e.body),d=!l.isArr(a.body);b&&e.body!==a.body?d&&e.el.firstChild?e.el.firstChild.nodeValue=e.body:e.raw?e.el.innerHTML=e.body:e.el.textContent=e.body:d&&!b&&(e.el.textContent="");a.moved=!0}}function h(a){if(a in E)return E[a];var e=
{tag:null,id:null,"class":null};e.tag=a.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(a,b,c,d){c&&(e.id=c);d&&(e["class"]=d.replace(/\./g," ").trim());return b||"div"});return E[a]=e}function t(a,e,b,d){return function(c){var f;if(l.isFunc(a))f=a.call(e,c,b,d);else if(l.isObj(a))for(var h in a)c.target.matches(h)&&(f=a[h].call(e,c,b,d));!1===f&&(c.preventDefault(),c.stopPropagation());d.opts.watch&&d.opts.watch.fire({vm:d})}}function u(a,e){var b=!e;e=e||{};if(e.props||a.props){var d=
e.props||{},c=a.props||{},f=d.style,h=c.style;if(l.isObj(f)||l.isObj(h))x(a.el,f||{},h||{},A,G,a.ns,b),d.style=c.style=null;x(a.el,d,c,H,F,a.ns,b);h&&(c.style=h)}}function x(a,e,b,d,c,f,h){for(var k in b)null!==b[k]&&(k in e&&b[k]===e[k]||d(a,k,b[k],f,h));for(k in e)null!==e[k]&&(k in b||c(a,k,f,h))}function A(a,e,b){a.style[e]=isNaN(b)||I[e]?b:b+"px"}function G(a,e){a.style[e]=""}function H(a,e,b,d,c){"."===e[0]?(e=e.substr(1),"svg"===d?a[e].baseVal=b:a[e]=b):"class"===e?a.className=b:"id"===e||
l.isEvProp(e)?a[e]=b:!1===b?F(a,e,d,c):(!0===b&&(b=""),a.setAttribute(e,b))}function F(a,e,b,d){d||("."===e[0]?(e=e.substr(1),"svg"===b?a[e].baseVal=null:a[e]=null):"class"===e?a.className="":"id"===e||l.isEvProp(e)?a[e]=null:a.removeAttribute(e))}var B={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},E={},D="undefined"==typeof document?{}:document,I={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,
flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},C={useRaf:!0,viewScan:!1,useDOM:!1};q.view=w;q.config=function(a){C=a};var l=q.util;return q})(domvm);(function(q){var w=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,r=q.util;q.html=function(b){var g="";switch(b.type){case r.TYPE_ELEM:g+="<"+b.tag;if(b.props){var n=r.isVal(b.props.style)?b.props.style:"",f=r.isObj(b.props.style)?b.props.style:null;if(f)for(var d in f)null!==f[d]&&(n+=r.camelDash(d)+": "+f[d]+";");for(d in b.props)r.isEvProp(d)||(f=b.props[d],r.isFunc(f)&&(f=f()),r.isObj(f)||(!0===f?g+=" "+d:!1!==f&&null!==f&&"."!==d[0]&&(g+=" "+d+'="'+
f+'"')));n.length&&(g+=' style="'+n+'"')}if(b.ns&&"svg"!==b.tag&&"math"!==b.tag&&!b.body)return g+"/>";g+=">";break;case r.TYPE_TEXT:return b.body}w.test(b.tag)||(r.isArr(b.body)?b.body.forEach(function(b){g+=q.html(b)}):g+=b.body||"",g+="</"+b.tag+">");return g}})(domvm);(function(q){var w=q.util;q.watch=function(){function r(){}function b(b,d,g,h,t){t=t||{};t.method=(t.method||b).toUpperCase();if(null!==g){var u=Object.prototype.toString.call(g);"[object Array]"===u||"[object Object]"===u?(t.headers=t.headers||new Headers,t.headers.set("Content-Type","application/json"),t.body=JSON.stringify(g)):t.body=""+g}var u=h,x=r;h instanceof Array&&(u=h[0],h[1]&&(x=h[1]));h=fetch(d,t).then(function(b){if(200<=b.status&&300>b.status)return b;var d=Error(b.statusText);d.resp=
b;throw d;}).then(function(b){switch(b.headers.get("Content-Type").split("; ")[0]){case "application/json":return b.json();case "text/plain":return b.text();default:return b}}).then(u,x).then(function(b){!1!==b&&n.fire();return b},r);h._fetchArgs=[b,d,g,[u,x],t];return h}var g=[],n={on:function(b){g.push(b);return n},off:function(b){g.splice(g.indexOf(b),1);return n},fire:function(){w.execAll(g,arguments);return n},prop:function(f,d){var g=f,h=function(b,d){arguments.length&&b!==g&&(g=b,!1!==d&&n.fire());
return g};if(d&&d.then){h.freshen=r;if(d._fetchArgs){var t=d._fetchArgs[3];d._fetchArgs[3]=[function(b){return h(t[0]?t[0](b):b)},t[1]];h.freshen=function(){b.apply(null,d._fetchArgs)}}d.then(h)}return h.toString=h},sync:function(b,d,g){var h=b,n=d;"string"==typeof b&&(h=function(d){return"e."===b.substr(0,2)?d[b.substr(2)]:d.target[b]});return function(b){var f=this!==window?this:null;f&&"string"==typeof d&&(n=function(b,h){var g=f[d];f[d]=b;handler&&b!==g&&!1!==h&&handler()});n(h(b),g)}},get:function(f,
d,g){return b("get",f,null,d,g)},"delete":function(f,d,g){return b("delete",f,null,d,g)},post:function(f,d,g,h){return b("post",f,d,g,h)},put:function(f,d,g,h){return b("put",f,d,g,h)},patch:function(f,d,g,h){return b("patch",f,d,g,h)}};return n}})(domvm);(function(q){q.route=function(q,r){function b(b,d){var f=h[b],g=t+f.url;if(d&&-1!==g.indexOf(":")){d=d.slice();var n=!0,g=g.replace(/:([^\/]+)/g,function(b,g){var h=d.shift();if(f.params&&f.params[g]){if((""+h).match(f.params[g]))return h;n=!1}else return h});return n?g:n}return g}var g=!0,n={href:function(){var d=arguments,f=function(b){n["goto"].apply(null,d);b.preventDefault()};f.url=b.apply(null,d);return f},"goto":function(n,q,r){q=q||[];r=r||g;var t=b(n,q);if(!1===t)console.log("Could not find route");
else{for(var v=null,w=0;w<d.length;w++)if(d[w].url===t){v=w;break}null===v&&(d.splice(f+1,1E4),d.push({name:n,route:h[n],params:q,url:t}),v=d.length-1);w=d[v];Array.prototype.slice.call(arguments);var B=!0;null!==f&&(B=d[f].route.onexit.call(null,d[v].params.concat(w)));!1!==B&&!1!==d[v].route.onenter.apply(null,q.concat(d[f]))&&(history[r?"replaceState":"pushState"]([n,q],"title",t),f=v);g=!1}},current:function(){return d[f]}},f=null,d=[],v=q(n,r),h=v.routes,t=v.root||"/";window.onpopstate=function(b){n["goto"].apply(null,
b.state.concat(!0))};return n}})(domvm);
