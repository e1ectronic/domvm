/*
 https://github.com/leeoniya/domvm
*/
("undefined"!==typeof global?global:this).domvm={};(function(v){var z="undefined"==typeof window?{}:window,u={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},a={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(c){return c instanceof
Array},isVal:function(c){c=typeof c;return"string"===c||"number"===c},isObj:function(c){return"object"===typeof c&&null!==c&&!a.isArr(c)},isFunc:function(c){return"function"===typeof c},isProm:function(c){return"object"===typeof c&&a.isFunc(c.then)},execAll:function(c,x){c&&(a.isArr(c)?c:[c]).forEach(function(c){return c.apply(null,x)})},insertArr:function(c,a,l,p){c.splice.apply(c,[l,p].concat(a))},isEvProp:function(c){return"on"===c.substr(0,2)},isDynProp:function(c,a){switch(c){case "input":case "textarea":case "select":case "option":switch(a){case "value":case "checked":case "selected":case "selectedIndex":return!0}}},
camelDash:function(c){return c.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},autoPx:function(c,a){return isNaN(a)||u[c]?a:a+"px"},indexOfKey:function(c,a,l,p){for(l=0;l<a.length;l++)if(a[l].key===c)return l;return-1},raft:function(c){function a(){l=0;c.apply(p,A)}if(!z.requestAnimationFrame)return c;var l,p,A;return function(){p=this;A=arguments;l||(l=z.requestAnimationFrame(a))}}};v.util=a})(domvm);(function(v){function z(b,d){return!1===d?null:null==d&&null!=b?b:f.isVal(d)||f.isObj(d)||f.isArr(d)||f.isFunc(d)?d:null}function u(b,d,C,B,e,h){function k(b,d,e){if(e)b[d]=b[d]||[],b[d].push(e);else for(var h in d)b[h]=b[h]||[],b[h].push(d[h])}function g(b,d,c){e=b;h=d;n.update(c,!1);return w(0,!1)}function w(b,B){if(b){for(var g=n;b--&&g.parent;)g=g.parent;g.redraw(0,!0);return g.vm}n.hooks&&f.execAll(n.hooks.willRedraw);n.refs={};var g=n.node,k=n.render.call(n.api,n,d,C),k=l(k,e,h,n);k.vm=n;n.node=
k;var a=f.isVal(C)&&"^"===C[0]?C.substr(1):f.isVal(k.ref)&&"^"===k.ref[0]?k.ref.substr(1):null;k.key=f.isVal(C)?C:k.key;for(var t=e;t;)t.vm&&(n.parent||(n.parent=t.vm),null!==a&&(t.vm.refs[a]=k)),t=t.parent;if((a=g)&&(k.type!==g.type||k.tag!==g.tag))var a=null,r=!0;p(k,a);e&&(e.body[h]=k);!1!==B&&(g&&c(g),!g&&m||A(k,null,k.el),r&&(g.el.parentNode.replaceChild(k.el,g.el),g.el=null));Promise.resolve().then(function(){n.hooks&&f.execAll(n.hooks.didRedraw)});return n}function t(b){n.hooks&&f.execAll(n.hooks.willUnmount);
if(e)if(b){for(b=h+1;b<e.body.length;b++){var d=e.body[b];d.idx=b-1;d.vm&&d.vm.updIdx(d.idx)}e.body.splice(h,1)}else e.body[h]=null;c(n.node,!0);n.node.vm=null;n.hooks&&f.execAll(n.hooks.didUnmount)}var m=!e;f.isArr(b)&&(d=b[1],C=b[2],B=b[3],b=b[0]);C=z(d,C);var n={api:{},node:null,view:[b,C],model:d,opts:B||{},render:null,update:function(b,e){null!=b&&C!==d&&(d=n.model=b);return!1!==e?w(0):n},on:function(b,d){k(n.events,b,d)},hook:function(b,d){n.hooks=n.hooks||{};k(n.hooks,b,d)},events:{},hooks:null,
redraw:I.useRaf?f.raft(w):w,patch:function(b,d){var e=b.parent,h=p(l(d,e,b.idx,n),b);e.body[b.idx]=h},emit:function(b){for(var d=Array.prototype.slice.call(arguments,1),e=n;e;){if(e.events[b]){f.execAll(e.events[b],d);break}e=e.parent}},refs:{},parent:null,mount:function(b,d){n.hooks&&f.execAll(n.hooks.willMount);d&&(b.textContent="");A(n.node,d?b:null);d||b.insertBefore(n.node.el,null);n.hooks&&f.execAll(n.hooks.didMount);return n},attach:function(b){a(n.node,b);return n},unmount:function(){y(n.hooks,
"Unmount",t,[])},moveTo:g,updIdx:function(b){h=b}};B&&B.hooks&&n.hook(B.hooks);f.execAll(G,[n]);n.render=b.call(n.api,n,d,C);return e?g(e,h):w(0)}function a(b,d){b.el=d;if(f.isArr(b.body))for(var c=0;c<b.body.length;c++)a(b.body[c],d.childNodes[c])}function c(b,d){f.isArr(b.body)&&(b.body.forEach(function(b,d){b&&(b.vm&&!b.moved?b.vm.unmount():c(b,!0))}),b.body=null);b.vm=null;d&&b.el&&b.el.parentNode&&y(b.hooks,"Remove",x,[b])}function x(b){b.el.parentNode.removeChild(b.el);b.el=null}function l(b,
d,c,B){var e=b,h={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,hooks:null,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,hasKeys:!1,body:null};f.isFunc(e)&&(e=e());if(f.isArr(e)&&e.length){h.type=f.TYPE_ELEM;if(1<e.length){var k=1;f.isObj(e[1])&&(h.props=e[1],k=2);h.body=e.length==k+1?f.isVal(e[k])?e[k]:f.isFunc(e[k])?e[k]():e.slice(k):e.slice(k)}e=e[0];if(/[.#]/.test(e)){if(e=D(e),h.tag=e.tag,e.id||e["class"])h.props=h.props||{},h.props.id=e.id,h.props["class"]=e["class"]}else h.tag=
e;if(h.props){var e=h.props,g;for(g in e)f.isEvProp(g)?e[g]=w(e[g],B.opts.evctx||B.model||null,h,B):f.isFunc(e[g])&&("href"==g?(e.onclick=e[g],e.href=e[g].href):e[g]=e[g]()),f.isDynProp(h.tag,g)&&(e["."+g]=e[g]);if(f.isObj(e.style))for(var a in e.style)g=e.style[a],f.isFunc(g)&&(e.style[a]=g());f.isObj(e._hooks)&&(h.hooks=e._hooks,e._hooks=null);h.key=f.isVal(e._key)?e._key:f.isVal(e._ref)?e._ref:f.isVal(e.id)?e.id:f.isVal(e.name)?e.name:null;e._ref&&(h.ref=e._ref);e._raw&&(h.raw=!0);e._data&&(h.data=
e._data);e._guard&&(h.guard=!0);e._ref=e._key=e._raw=e._data=e._guard=null}}else f.isVal(e)&&(h.type=f.TYPE_TEXT,h.body=e);null!==h.ref&&(B.refs[h.ref]=h);h.parent=d;h.idx=c;h.ns=d&&d.ns?d.ns:"svg"===h.tag||"math"===h.tag?h.tag:null;if(f.isArr(h.body))for(d=0,c=h.body.length;d<c;d++){a=h.body[d];var e=g=null,p=k=!1;f.isFunc(a)&&(a=a());if(null==a)k=!0;else{var t=f.isArr(a),n=t?!1:f.isObj(a);if(t)a.length?f.isArr(a[0])?p=!0:f.isFunc(a[0])?g=z(b[1],b[2]):(e=l(a,h,d,B),g=e.key):k=!0;else if(n)if(f.isFunc(a.redraw))a.moveTo(h,
d),e=a.node,g=a.view[1];else{h.body[d--]=""+a;continue}else""===a?k=!0:0<d&&h.body[d-1].type===f.TYPE_TEXT?(h.body[d-1].body+=""+a,k=!0):e=l(""+a,h,d,B)}k||p?(p?f.insertArr(h.body,a,d,1):h.body.splice(d,1),c=h.body.length,d--):(null!==g&&(h.hasKeys=!0),h.body[d]=e||a)}return h}function p(b,d){d&&y(b.hooks,"Recycle",q,[d,b]);if(f.isArr(b.body)){var c=0;b.body.forEach(function(a,e){var h=f.isArr(a);if(d){var k=m(a,b,d,c);if(null!==k){var g=k[0],k=k[1];g===c&&c++;g=d.body[g];h&&g.vm?2===k?g.vm.moveTo(b,
e,a[1]):1===k&&u(a[0],a[1],a[2],a[3],b,e):b.body[e]=p(a,g);return}}h?u(a[0],a[1],a[2],a[3],b,e):b.body[e]=p(a)})}return b}function A(b,d,a){var c=!b.el;if(b.type==f.TYPE_ELEM)if(c&&(b.el=d&&d.nodeName?d:b.ns?J.createElementNS(E[b.ns],b.tag):J.createElement(b.tag),b.props&&t(b)),f.isArr(b.body)){d=0;for(var e=b.el.firstChild;d<b.body.length;d++)e=A(b.body[d],null,e)?e:e.nextSibling||null}else f.isVal(b.body)&&(b.raw?b.el.innerHTML=b.body:c&&(b.el.textContent=b.body));else b.type==f.TYPE_TEXT&&c&&(b.el=
J.createTextNode(b.body));b.el._node=b;if(a===b.el)return!1;if((d=b.parent)&&d.el)return y(b.hooks,c?"Insert":"Reinsert",r,[b,a]),!0}function r(b,d){b.parent.el.insertBefore(b.el,d)}function m(b,d,a,c,e){var h=f.isArr(b),k=h?b[2]||null:b.key,g=a.hasKeys,p=d.hasKeys;a=a.body;d=d.body;if(null!==k&&g&&(k=f.indexOfKey(k,a),-1<k))return[k,2];c=c||0;if(c>a.length-1)return null;e=0===e?0:e||a.length-1;for(k=null;c<=e;c++)if(g=a[c],null!==g&&g.el)if(h&&g.vm){if(g.vm.view[0]===b[0]){if(g.vm.view[1]===z(b[1],
b[2]))return[c,2];var t=!1;if(I.viewScan)for(var w=0;w<d.length;w++){var n=d[w];if(!n.el&&n.vm&&n.vm.view[0]===g.vm.view[0]&&n.vm.view[1]===g.vm.view[1]){t=!0;break}}t||k||!p||-1!=f.indexOfKey(g.key,d)||(k=[c,1])}}else if(b.type===g.type&&(b.type===f.TYPE_TEXT||null!==b.tag&&b.tag===g.tag)&&(null===g.key||!p||-1==f.indexOfKey(g.key,d)))return[c,1];return k}function q(b,d){d.el=b.el;b.el=null;if(d.type===f.TYPE_TEXT&&d.body!==b.body)d.el.nodeValue=d.body;else{t(d,b);var a=!f.isArr(d.body),c=!f.isArr(b.body);
a&&d.body!==b.body?c&&d.el.firstChild?d.el.firstChild.nodeValue=d.body:d.raw?d.el.innerHTML=d.body:d.el.textContent=d.body:c&&!a&&(d.el.textContent="");b.moved=!0}}function y(b,d,a,c,e,h){if(b){var k=b["will"+d];f.isArr(k)&&(k=k[0]);var g=b["did"+d];f.isArr(g)&&(g=g[0]);b=function(){a.apply(null,c);g&&g.apply(null,h||e||c)};k?(k=k.apply(null,e||c),f.isProm(k)?k.then(b):b()):b()}else a.apply(null,c)}function D(b){if(b in K)return K[b];var d={tag:null,id:null,"class":null};d.tag=b.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,
function(b,c,e,a){e&&(d.id=e);a&&(d["class"]=a.replace(/\./g," ").trim());return c||"div"});return K[b]=d}function w(b,d,a,c){return function(e){var a,k=e.target._node,g=null;if(f.isFunc(b))a=b.call(d,k,e);else if(f.isArr(b))g=b.slice(1),a=b[0].apply(d,g.concat(k,e));else if(f.isObj(b))for(var p in b){var t=b[p];e.target.matches(p)&&(f.isArr(t)?(g=t.slice(1),a=t[0].apply(d,g.concat(k,e))):f.isFunc(t)&&(a=t.call(d,k,e)))}!1===a&&(e.preventDefault(),e.stopPropagation());c.opts.hasOwnProperty("watch")&&
c.opts.watch.fire({type:"event",vm:c,node:k,event:e,data:g})}}function t(b,d){var a=!d;d=d||{};if(d.props||b.props){var c=d.props||{},e=b.props||{},h=c.style,k=e.style;if(f.isObj(h)||f.isObj(k))F(b.el,b.tag,h||{},k||{},L,M,b.ns,a),c.style=e.style=null;F(b.el,b.tag,c,e,N,H,b.ns,a);k&&(e.style=k)}}function F(b,d,a,c,e,h,k,g){for(var f in c)null!==c[f]&&(c[f]===a[f]&&"."!==f[0]||e(b,f,c[f],k,g));for(f in a)null!==a[f]&&null==c[f]&&h(b,f,k,g)}function L(b,d,a){b.style[d]=f.autoPx(d,a)}function M(b,d){b.style[d]=
""}function N(b,d,a,c,e){"."===d[0]?(d=d.substr(1),"svg"===c?b[d].baseVal=a:b[d]=a):"class"===d?b.className=a:"id"===d||f.isEvProp(d)?b[d]=a:!1===a?H(b,d,c,e):b.setAttribute(d,!0===a?"":a)}function H(b,d,a,c){c||("."===d[0]?(d=d.substr(1),"svg"===a?b[d].baseVal=null:b[d]=null):"class"===d?b.className="":"id"===d||f.isEvProp(d)?b[d]=null:b.removeAttribute(d))}var E={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},K={},J="undefined"==typeof document?{}:document,I={useRaf:!0,
viewScan:!1,useDOM:!1};v.view=u;v.view.config=function(b){I=b};var G=null;v.view.extend=function(b,d){G=!G||d?[]:G;G.push(b)};var f=v.util;return v})(domvm);(function(v){var z=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,u=v.util;v.html=function(a){var c="";switch(a.type){case u.TYPE_ELEM:c+="<"+a.tag;if(a.props){var x=u.isVal(a.props.style)?a.props.style:"",l=u.isObj(a.props.style)?a.props.style:null;if(l)for(var p in l)null!==l[p]&&(x+=u.camelDash(p)+": "+u.autoPx(p,l[p])+"; ");for(p in a.props)u.isEvProp(p)||"."===p[0]||(l=a.props[p],u.isFunc(l)&&(l=l()),u.isObj(l)||(!0===l?c+=" "+p:!1!==l&&null!==l&&
"."!==p[0]&&(c+=" "+p+'="'+l+'"')));x.length&&(c+=' style="'+x.trim()+'"')}if(a.ns&&"svg"!==a.tag&&"math"!==a.tag&&!a.body)return c+"/>";c+=">";break;case u.TYPE_TEXT:return a.body}z.test(a.tag)||(u.isArr(a.body)?a.body.forEach(function(a){c+=v.html(a)}):c+=a.body||"",c+="</"+a.tag+">");return c}})(domvm);(function(v){var z=v.util;v.watch=function(u){function a(){}function c(c,A,r,m,q){q=q||{};q.method=(q.method||c).toUpperCase();if(null!==r){var y=Object.prototype.toString.call(r);"[object Array]"===y||"[object Object]"===y?(q.headers=q.headers||new Headers,q.headers.set("Content-Type","application/json"),q.body=JSON.stringify(r)):q.body=""+r}var y=m,D=a;m instanceof Array&&(y=m[0],m[1]&&(D=m[1]));var w={type:"fetch",fetch:{method:c,url:A,body:r}};m=fetch(A,q).then(function(a){if(200<=a.status&&300>
a.status)return a;var c=Error(a.status+": "+a.statusText);c.data=a;return Promise.reject(c)}).then(function(a){switch(a.headers.get("Content-Type").split("; ")[0]){case "application/json":return a.json();case "text/plain":return a.text();default:return a}}).then(y,D).then(function(a){!1!==a&&l.fire(w);return a},function(a){w.error=a;l.fire(w);return a});m._fetchArgs=[c,A,r,[y,D],q];return m}var x=[];z.isFunc(u)&&x.push(u);var l={on:function(a){x.push(a);return l},off:function(a){x.splice(x.indexOf(a),
1);return l},fire:z.raft(function(){z.execAll(x,arguments);return l}),prop:function(p,A){var r=p,m=function(a,c){if(arguments.length&&a!==r){var p=r;r=a;!1!==c&&l.fire({type:"prop",prop:m,data:{old:p,"new":a}})}return r};if(A&&A.then){m.update=a;if(A._fetchArgs){var q=A._fetchArgs[3];A._fetchArgs[3]=[function(a){return m(q[0]?q[0](a):a)},q[1]];m.update=function(){c.apply(null,A._fetchArgs)}}A.then(m)}return m.toString=m},sync:function(a,c,l){var m=a,q=c;"string"==typeof a&&(m=function(c){return"e."===
a.substr(0,2)?c[a.substr(2)]:c.target[a]});return function(a,p){var w=this!==window?this:null;w&&"string"==typeof c&&(q=function(a,p){var l=w[c];w[c]=a;u&&a!==l&&!1!==p&&u()});q(m(p),l)}},get:function(a,l,r){return c("get",a,null,l,r)},"delete":function(a,l,r){return c("delete",a,null,l,r)},post:function(a,l,r,m){return c("post",a,l,r,m)},put:function(a,l,r,m){return c("put",a,l,r,m)},patch:function(a,l,r,m){return c("patch",a,l,r,m)}};return l}})(domvm);(function(v){function z(a,c,l,m,q,y){var u=null,w=null,t=null;if("/"==l[0]){t=l;w=!1;m={};y=t.split("#");c=y[0].split("?");u=c[0];y=y[1];c[1]&&(q={},c[1].split("&").map(function(a){a=a.split("=");q[a[0]]=null==a[1]?!0:a[1]}));var F,x;for(x in a){l=a[x];var v=l.path;if(F=u.match(l.regexPath)){w=x;-1!==v.indexOf(":")&&(m={},F.shift(),v.replace(/:([^\/]+)/g,function(a,c){m[c]=F.shift()}));break}}}else{w=l;l=a[w];var v=c+l.path,z=l.vars||{},H=/^[^\/]+$/,t=-1!==v.indexOf(":")?u=v.replace(/:([^\/]+)/g,
function(a,c){if((z[c]||H).test(m[c]))return m[c]+="";throw Error("Invalid value for route '"+v+"' segment '"+c+"': '"+m[c]+"'");}):u=v;if(q){var t=t+"?",E;for(E in q)t+=E+(!0!==q[E]?"="+q[E]:"")+"&";t=t.slice(0,-1)}t+=y?"#"+y:""}return{href:t,name:w,path:u,segs:m,hash:y,query:q}}function u(a,c){for(var l in a){var m=a[l];m.regexPath=new RegExp("^"+c+m.path.replace(/:([^\/]+)/g,function(a,c){var l=""+m.vars[c];return"("+l.substring(1,l.lastIndexOf("/"))+")"})+"$")}}var a=[],c=null,x=!1,l="";v.route=
function(p,v){function r(){var a=location,a=x?a.href.substr(a.origin.length):a.hash.substr(1)||"/";return z(D,l,a)}var m=null,q={href:function(a,c,m,p,u){var r=z(D,l,a,c,m,p);return x?(a=function(a){q["goto"](r,null,null,null,u);a.preventDefault()},a.href=r.href,a):"#"+r.href},config:function(a){(x=a.useHist)&&(l=a.root||"");m=a.init||null},refresh:function(){q["goto"](r(),null,null,null,!0)},"goto":function(m,p,q,r,u){u=u||y;m.href||(m=z(D,l,m,p,q,r));if(!1===m.name)console.log("Could not find route");
else{p=null;for(q=0;q<a.length;q++)if(a[q].path===m.path){p=q;break}null===p&&(a.splice(c+1,1E4),a.push(m),p=a.length-1);m=a[c];q=a[p];r=!0;null!==c&&(r=(r=D[m.name].onexit)?r.apply(null,(m?[m.segs,m.query,m.hash]:[]).concat(q)):!0);if(!1!==r&&!1!==D[q.name].onenter.apply(null,(q?[q.segs,q.query,q.hash]:[]).concat(m))){if(x)history[u?"replaceState":"pushState"](null,"title",q.href);c=p}y=!1}},location:function(){return y?r():a[c]}},y=!0,D=p(q,v);u(D,l);onhashchange=onpopstate=function(a){(x||"popstate"!=
a.type)&&q["goto"](r(),null,null,null,!0)};m&&m();return q}})(domvm);
