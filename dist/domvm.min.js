/*
 https://github.com/leeoniya/domvm
*/
("object"===typeof module&&"object"===typeof module.exports&&function(q){module.exports=q()}||"function"===typeof define&&function(q){define("domvm",q)}||function(q){window.domvm=q()})(function(){return{}});(function(q){var u="undefined"==typeof window?{}:window,r={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(d){return d instanceof Array},isVal:function(d){d=typeof d;return"string"===d||"number"===d},isObj:function(d){return"object"===typeof d&&null!==d&&!r.isArr(d)},isFunc:function(d){return"function"===typeof d},execAll:function(d,h){d.forEach(function(d){return d.apply(null,h)})},insertArr:function(d,h,n,b){d.splice.apply(d,[n,b].concat(h))},isEvProp:function(d){return"on"===d.substr(0,2)},camelDash:function(d){return d.replace(/([a-z])([A-Z])/g,
"$1-$2").toLowerCase()},raft:function(d){function h(){n=0;d.apply(b,f)}if(!u.requestAnimationFrame)return d;var n,b,f;return function(){b=this;f=arguments;n||(n=u.requestAnimationFrame(h))}}};domvm.util=r})(domvm);(function(q){function u(a,e,m,x,c,w,f){function k(a,c,e){w=a;f=c;return v(e,!1)}function v(a,c){l.execAll(p.events.willRedraw);p.imp=null!=a?a:x;p.refs={};var k=p.node,g=p.render.call(e,p.imp),g=h(g,w,f,p);g.key=l.isVal(m)?m:g.key;g.vm=p;p.node=g;var y=k;if(k&&(g.type!==k.type||g.tag!==k.tag))var y=null,q=!0;n(g,y);w&&(w.body[f]=g);!1!==c&&(k&&d(k),!k&&z||b(g),q&&(k.el.parentNode.replaceChild(g.el,k.el),k.el=null));setTimeout(function(){var a=p,c;for(c in a.refs)a.refs[c]=a.refs[c].el;l.execAll(p.events.didRedraw)},
0);return p}function g(a){var c=null,e=a.split(":");2==e.length&&(a=e[0],c=+e[1]);var e=Array.prototype.slice.call(arguments,1),m=p.node;if(null!==c){for(;c&&m.parent;)m=m.parent,m.vm&&c--;(c=(c=m.vm?m.vm.events:null)?c[a]:null)&&c.apply(null,e)}else for(;m&&(!m.vm||!(c=(c=m.vm.events)?c[a]:null)||!1!==c.apply(null,e));)m=m.parent}var z=!w;l.isArr(a)&&(e=a[1],m=a[2],x=a[3],c=a[4],a=a[0]);!1===m&&(x=e,m=e=null);var p={exp:{},imp:x||{},node:null,view:[a,e,m],opts:c||{},render:null,on:function(a,c){if(c)p.events[a].push(c);
else for(var e in a)p.events[e].push(a[e])},events:{willRedraw:[],didRedraw:[],willDestroy:[],didDestroy:[]},redraw:B.useRaf?l.raft(v):v,patch:function(a,c){var e=a.parent,m=n(h(c,e,a.idx,p),a);e.body[a.idx]=m;var b=m.key;l.isVal(b)&&(e.keyMap[b]=m)},emit:g,refs:{},mount:function(a){b(p.node);a.insertBefore(p.node.el,null);return p},attach:function(a){r(p.node,a);return p},destroy:function(a){l.execAll(p.events.willDestroy);if(w)if(a){for(a=f+1;a<w.body.length;a++){var c=w.body[a];c.idx=a-1;c.vm&&
c.vm.updIdx(c.idx)}w.body.splice(f,1)}else w.body[f]=null;d(p.node,!0);p.node.vm=null;l.execAll(p.events.didDestroy)},moveTo:k,updIdx:function(a){f=a}};p.events._redraw=p.redraw;p.render=a.call(p.exp,p,e,m,x);g.redraw=function(a){a=l.isVal(a)?a:1E3;g("_redraw:"+a)};return w?k(w,f,x):v(x)}function r(a,e){a.el=e;if(l.isArr(a.body))for(var m=0;m<a.body.length;m++)r(a.body[m],e.childNodes[m])}function d(a,e){l.isArr(a.body)&&(a.body.forEach(function(a,e){a&&(a.vm&&!a.moved?a.vm.destroy():a.el&&a.el.parentNode?
a.el.parentNode.removeChild(a.el):d(a))}),a.body=null);a.vm=null;e&&a.el&&(a.el.parentNode.removeChild(a.el),a.el=null)}function h(a,e,m,b){var c=a;a={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,keyMap:null,body:null};l.isFunc(c)&&(c=c());if(l.isArr(c)&&c.length){a.type=l.TYPE_ELEM;if(1<c.length){var d=1;l.isObj(c[1])&&(a.props=c[1],d=2);a.body=c.length==d+1?l.isVal(c[d])?c[d]:l.isFunc(c[d])?c[d]():c.slice(d):c.slice(d)}c=c[0];if(/[.#]/.test(c)){if(c=
y(c),a.tag=c.tag,c.id||c["class"])a.props=a.props||{},a.props.id=c.id,a.props["class"]=c["class"]}else a.tag=c;if(a.props){var c=a.props,f;for(f in c)l.isEvProp(f)?c[f]=t(c[f],b.opts.evctx||b.view[1]||b.imp||null,a,b):l.isFunc(c[f])&&("href"==f?(c.onclick=c[f],c.href=c[f].url):c[f]=c[f]());if(l.isObj(c.style))for(var k in c.style)f=c.style[k],l.isFunc(f)&&(c.style[k]=f());a.key=l.isVal(c._key)?c._key:l.isVal(c._ref)?c._ref:l.isVal(c.id)?c.id:l.isVal(c.name)?c.name:null;c._ref&&(a.ref=c._ref);c._raw&&
(a.raw=!0);c._guard&&(a.guard=!0);c._ref=c._key=c._raw=c._guard=null}}else l.isVal(c)&&(a.type=l.TYPE_TEXT,a.body=c);null!==a.ref&&(b.refs[a.ref]=a);a.parent=e;a.idx=m;a.ns=e&&e.ns?e.ns:"svg"===a.tag||"math"===a.tag?a.tag:null;if(l.isArr(a.body)){e={};m=!1;k=0;for(f=a.body.length;k<f;k++){var c=a.body[k],g=d=null,v=!1,n=!1;l.isFunc(c)&&(c=c());if(null==c)v=!0;else{var p=l.isArr(c),z=p?!1:l.isObj(c);if(p)c.length?l.isArr(c[0])?n=!0:l.isFunc(c[0])?d=c[2]:(g=h(c,a,k,b),d=g.key):v=!0;else if(z)if(l.isFunc(c.redraw))c.moveTo(a,
k),g=c.node,d=c.view[2];else{a.body[k--]=""+c;continue}else""===c?v=!0:0<k&&a.body[k-1].type===l.TYPE_TEXT?(a.body[k-1].body+=""+c,v=!0):g=h(""+c,a,k,b)}v||n?(n?l.insertArr(a.body,c,k,1):a.body.splice(k,1),f=a.body.length,k--):(l.isVal(d)&&(e[d]=k,m=!0),a.body[k]=g||c)}m&&(a.keyMap=e)}return a}function n(a,e){e&&g(e,a);l.isArr(a.body)&&a.body.forEach(function(m,d){var c=l.isArr(m);if(e){var b=f(m,a,e);if(null!==b){var g=b[1],b=e.body[b[0]];c&&b.vm?2===g?b.vm.moveTo(a,d,m[3]):1===g&&u(m[0],m[1],m[2],
m[3],m[4],a,d):a.body[d]=n(m,b);return}}c?u(m[0],m[1],m[2],m[3],m[4],a,d):a.body[d]=n(m)});return a}function b(a){var e=!a.el;a.type==l.TYPE_ELEM?(e&&(a.el=a.ns?C.createElementNS(A[a.ns],a.tag):C.createElement(a.tag),a.props&&v(a)),l.isArr(a.body)?a.body.forEach(b):e&&l.isVal(a.body)&&(a.raw?a.el.innerHTML=a.body:a.el.textContent=a.body)):a.type==l.TYPE_TEXT&&e&&(a.el=C.createTextNode(a.body));a.el._node=a;(e=a.parent)&&e.el&&e.el.childNodes[a.idx]!==a.el&&e.el.insertBefore(a.el,e.el.childNodes[a.idx])}
function f(a,e,m,b,c){var d=l.isArr(a),f=d?a[2]||null:a.key,k=m.keyMap,g=e.keyMap;m=m.body;e=e.body;if(null!==f&&k&&l.isVal(k[f]))return[k[f],2];b=b||0;if(b>m.length-1)return null;c=0===c?0:c||m.length-1;for(f=null;b<=c;b++)if(k=m[b],null!==k&&k.el)if(d&&k.vm){if(k.vm.view[0]===a[0]){if(k.vm.view[1]===a[1])return[b,2];var v=!1;if(B.viewScan)for(var h=0;h<e.length;h++){var p=e[h];if(!p.el&&p.vm&&p.vm.view[0]===k.vm.view[0]&&p.vm.view[1]===k.vm.view[1]){v=!0;break}}v||f||!g||l.isVal(g[k.key])||(f=[b,
1])}}else if(!(a.type!==k.type||a.type!==l.TYPE_TEXT&&(null===a.tag||a.tag!==k.tag)||null!==k.key&&g&&l.isVal(g[k.key])))return[b,1];return f}function g(a,e){e.el=a.el;a.el=null;if(e.type===l.TYPE_TEXT&&e.body!==a.body)e.el.nodeValue=e.body;else{v(e,a);var b=!l.isArr(e.body),d=!l.isArr(a.body);b&&e.body!==a.body?d&&e.el.firstChild?e.el.firstChild.nodeValue=e.body:e.raw?e.el.innerHTML=e.body:e.el.textContent=e.body:d&&!b&&(e.el.textContent="");a.moved=!0}}function y(a){if(a in D)return D[a];var e=
{tag:null,id:null,"class":null};e.tag=a.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(a,b,c,d){c&&(e.id=c);d&&(e["class"]=d.replace(/\./g," ").trim());return b||"div"});return D[a]=e}function t(a,e,b,d){return function(c){var f;if(l.isFunc(a))f=a.call(e,c,b,d);else if(l.isObj(a))for(var g in a)c.target.matches(g)&&(f=a[g].call(e,c,b,d));!1===f&&(c.preventDefault(),c.stopPropagation());d.opts.watch&&d.opts.watch.fire({vm:d})}}function v(a,e){var b=!e;e=e||{};if(e.props||a.props){var d=
e.props||{},c=a.props||{},f=d.style,g=c.style;if(l.isObj(f)||l.isObj(g))z(a.el,f||{},g||{},F,G,a.ns,b),d.style=c.style=null;z(a.el,d,c,H,E,a.ns,b);g&&(c.style=g)}}function z(a,e,b,d,c,f,g){for(var k in b)null!==b[k]&&(k in e&&b[k]===e[k]||d(a,k,b[k],f,g));for(k in e)null!==e[k]&&(k in b||c(a,k,f,g))}function F(a,e,b){a.style[e]=isNaN(b)||I[e]?b:b+"px"}function G(a,e){a.style[e]=""}function H(a,e,b,d,c){"."===e[0]?(e=e.substr(1),"svg"===d?a[e].baseVal=b:a[e]=b):"class"===e?a.className=b:"id"===e||
l.isEvProp(e)?a[e]=b:!1===b?E(a,e,d,c):(!0===b&&(b=""),a.setAttribute(e,b))}function E(a,b,d,f){f||("."===b[0]?(b=b.substr(1),"svg"===d?a[b].baseVal=null:a[b]=null):"class"===b?a.className="":"id"===b||l.isEvProp(b)?a[b]=null:a.removeAttribute(b))}var A={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},D={},C="undefined"==typeof document?{}:document,I={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,
flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},B={useRaf:!0,viewScan:!1,useDOM:!1};q.view=u;q.config=function(a){B=a};var l=q.util;return q})(domvm);(function(q){var u=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,r=q.util;q.html=function(d){var h="";switch(d.type){case r.TYPE_ELEM:h+="<"+d.tag;if(d.props){var n=r.isVal(d.props.style)?d.props.style:"",b=r.isObj(d.props.style)?d.props.style:null;if(b)for(var f in b)null!==b[f]&&(n+=r.camelDash(f)+": "+b[f]+";");for(f in d.props)r.isEvProp(f)||(b=d.props[f],r.isFunc(b)&&(b=b()),r.isObj(b)||(!0===b?h+=" "+f:!1!==b&&null!==b&&"."!==f[0]&&(h+=" "+f+'="'+
b+'"')));n.length&&(h+=' style="'+n+'"')}if(d.ns&&"svg"!==d.tag&&"math"!==d.tag&&!d.body)return h+"/>";h+=">";break;case r.TYPE_TEXT:return d.body}u.test(d.tag)||(r.isArr(d.body)?d.body.forEach(function(b){h+=q.html(b)}):h+=d.body||"",h+="</"+d.tag+">");return h}})(domvm);(function(q){var u=q.util;q.watch=function(){function q(){}function d(b,d,g,h,t){t=t||{};t.method=(t.method||b).toUpperCase();null!==g&&(b=Object.prototype.toString.call(g),"[object Array]"===b||"[object Object]"===b?(t.headers=t.headers||new Headers,t.headers.set("Content-Type","application/json"),t.body=JSON.stringify(g)):t.body=""+g);g=h;b=q;h instanceof Array&&(g=h[0],h[1]&&(b=h[1]));d=fetch(d,t).then(function(b){if(200<=b.status&&300>b.status)return b;var d=Error(b.statusText);d.resp=b;throw d;
}).then(function(b){switch(b.headers.get("Content-Type").split("; ")[0]){case "application/json":return b.json();case "text/plain":return b.text();default:return b}}).then(g,b).then(function(b){!1!==b&&n.fire()},q);return"_prop"===g._name?g:d}var h=[],n={on:function(b){h.push(b);return n},off:function(b){h.splice(h.indexOf(b),1);return n},fire:function(){u.execAll(h,arguments);return n},prop:function(b){var d=b;b=function(b,h){arguments.length&&b!==d&&(d=b,!1!==h&&n.fire());return d};b._name="_prop";
return b.toString=b},sync:function(b,d,g){var h=b,n=d;"string"==typeof b&&(h=function(d){return"e."===b.substr(0,2)?d[b.substr(2)]:d.target[b]});return function(b){var q=this!==window?this:null;q&&"string"==typeof d&&(n=function(b,g){var h=q[d];q[d]=b;handler&&b!==h&&!1!==g&&handler()});n(h(b),g)}},get:function(b,f,g){return d("get",b,null,f,g)},"delete":function(b,f,g){return d("delete",b,null,f,g)},post:function(b,f,g,h){return d("post",b,f,g,h)},put:function(b,f,g,h){return d("put",b,f,g,h)},patch:function(b,
f,g,h){return d("patch",b,f,g,h)}};return n}})(domvm);(function(q){q.route=function(q,r){function d(b,d){var f=y[b],g=t+f.url;if(d&&-1!==g.indexOf(":")){d=d.slice();var h=!0,g=g.replace(/:([^\/]+)/g,function(b,g){var n=d.shift();if(f.params&&f.params[g]){if((""+n).match(f.params[g]))return n;h=!1}else return n});return h?g:h}return g}var h=!0,n={href:function(){var b=arguments,f=function(d){n["goto"].apply(null,b);d.preventDefault()};f.url=d.apply(null,b);return f},"goto":function(g,n,q){n=n||[];q=q||h;var r=d(g,n);if(!1===r)console.log("Could not find route");
else{for(var t=null,u=0;u<f.length;u++)if(f[u].url===r){t=u;break}null===t&&(f.splice(b+1,1E4),f.push({name:g,route:y[g],params:n,url:r}),t=f.length-1);u=f[t];Array.prototype.slice.call(arguments);var A=!0;null!==b&&(A=f[b].route.onexit.call(null,f[t].params.concat(u)));!1!==A&&!1!==f[t].route.onenter.apply(null,n.concat(f[b]))&&(history[q?"replaceState":"pushState"]([g,n],"title",r),b=t);h=!1}},current:function(){return f[b]}},b=null,f=[],g=q(n,r),y=g.routes,t=g.root||"/";window.onpopstate=function(b){n["goto"].apply(null,
b.state.concat(!0))};return n}})(domvm);
