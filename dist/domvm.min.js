/*
 https://github.com/leeoniya/domvm
*/
("undefined"!==typeof global?global:this).domvm={};(function(v){var z="undefined"==typeof window?{}:window,r={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},c={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(a){return a instanceof
Array},isVal:function(a){a=typeof a;return"string"===a||"number"===a},isObj:function(a){return"object"===typeof a&&null!==a&&!c.isArr(a)},isFunc:function(a){return"function"===typeof a},isProm:function(a){return"object"===typeof a&&c.isFunc(a.then)},execAll:function(a,x){a&&(c.isArr(a)?a:[a]).forEach(function(a){return a.apply(null,x)})},insertArr:function(a,c,l,p){a.splice.apply(a,[l,p].concat(c))},isEvProp:function(a){return"on"===a.substr(0,2)},isDynProp:function(a,c){switch(a){case "input":case "textarea":case "select":case "option":switch(c){case "value":case "checked":case "selected":case "selectedIndex":return!0}}},
camelDash:function(a){return a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},autoPx:function(a,c){return isNaN(c)||r[a]?c:c+"px"},indexOfKey:function(a,c,l,p){for(l=0;l<c.length;l++)if(c[l].key===a)return l;return-1},raft:function(a){function c(){l=0;a.apply(p,A)}if(!z.requestAnimationFrame)return a;var l,p,A;return function(){p=this;A=arguments;l||(l=z.requestAnimationFrame(c))}}};v.util=c})(domvm);(function(v){function z(b,d){return!1===d?null:null==d&&null!=b?b:f.isVal(d)||f.isObj(d)||f.isArr(d)||f.isFunc(d)?d:null}function r(b,d,C,B,e,h){function k(b,d,e){if(e)b[d]=b[d]||[],b[d].push(e);else for(var h in d)b[h]=b[h]||[],b[h].push(d[h])}function g(b,d,a){e=b;h=d;n.update(a,!1);return w(0,!1)}function w(b,B){if(b){for(var g=n;b--&&g.parent;)g=g.parent;g.redraw(0,!0);return g.vm}n.hooks&&f.execAll(n.hooks.willRedraw);n.refs={};var g=n.node,k=n.render.call(n.api,n,d,C),k=l(k,e,h,n);k.vm=n;n.node=
k;var c=f.isVal(C)&&"^"===C[0]?C.substr(1):f.isVal(k.ref)&&"^"===k.ref[0]?k.ref.substr(1):null;k.key=f.isVal(C)?C:k.key;for(var t=e;t;)t.vm&&(n.parent||(n.parent=t.vm),null!==c&&(t.vm.refs[c]=k)),t=t.parent;if((c=g)&&(k.type!==g.type||k.tag!==g.tag))var c=null,L=!0;p(k,c);e&&(e.body[h]=k);!1!==B&&(g&&a(g),!g&&m||A(k,null,k.el),L&&(g.el.parentNode.replaceChild(k.el,g.el),g.el=null));Promise.resolve().then(function(){n.hooks&&f.execAll(n.hooks.didRedraw)});return n}function t(b){n.hooks&&f.execAll(n.hooks.willUnmount);
if(e)if(b){for(b=h+1;b<e.body.length;b++){var d=e.body[b];d.idx=b-1;d.vm&&d.vm.updIdx(d.idx)}e.body.splice(h,1)}else e.body[h]=null;a(n.node,!0);n.node.vm=null;n.hooks&&f.execAll(n.hooks.didUnmount)}var m=!e;f.isArr(b)&&(d=b[1],C=b[2],B=b[3],b=b[0]);C=z(d,C);var n={api:{},node:null,view:[b,C],model:d,opts:B||{},render:null,update:function(b,e){null!=b&&C!==d&&(d=n.model=b);return!1!==e?w(0):n},on:function(b,d){k(n.events,b,d)},hook:function(b,d){n.hooks=n.hooks||{};k(n.hooks,b,d)},events:{},hooks:null,
redraw:I.useRaf?f.raft(w):w,patch:function(b,d){var e=b.parent,h=p(l(d,e,b.idx,n),b);e.body[b.idx]=h},emit:function(b){for(var d=Array.prototype.slice.call(arguments,1),e=n;e;){if(e.events[b]){f.execAll(e.events[b],d);break}e=e.parent}},refs:{},parent:null,mount:function(b,d){n.hooks&&f.execAll(n.hooks.willMount);d&&(b.textContent="");A(n.node,d?b:null);d||b.insertBefore(n.node.el,null);n.hooks&&f.execAll(n.hooks.didMount);return n},attach:function(b){c(n.node,b);return n},unmount:function(){y(n.hooks,
"Unmount",t,[])},moveTo:g,updIdx:function(b){h=b}};B&&B.hooks&&n.hook(B.hooks);f.execAll(G,[n]);n.render=b.call(n.api,n,d,C);return e?g(e,h):w(0)}function c(b,d){b.el=d;if(f.isArr(b.body))for(var a=0;a<b.body.length;a++)c(b.body[a],d.childNodes[a])}function a(b,d){f.isArr(b.body)&&(b.body.forEach(function(b,d){b&&(b.vm&&!b.moved?b.vm.unmount():a(b,!0))}),b.body=null);b.vm=null;d&&b.el&&b.el.parentNode&&y(b.hooks,"Remove",x,[b])}function x(b){b.el.parentNode.removeChild(b.el);b.el=null}function l(b,
d,a,B){var e=b,h={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,hooks:null,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,hasKeys:!1,body:null};f.isFunc(e)&&(e=e());if(f.isArr(e)&&e.length){h.type=f.TYPE_ELEM;if(1<e.length){var k=1;f.isObj(e[1])&&(h.props=e[1],k=2);h.body=e.length==k+1?f.isVal(e[k])?e[k]:f.isFunc(e[k])?e[k]():e.slice(k):e.slice(k)}e=e[0];if(/[.#]/.test(e)){if(e=D(e),h.tag=e.tag,e.id||e["class"])h.props=h.props||{},h.props.id=e.id,h.props["class"]=e["class"]}else h.tag=
e;if(h.props){var e=h.props,g;for(g in e)f.isEvProp(g)?e[g]=w(e[g],B.opts.evctx||B.model||null,h,B):f.isFunc(e[g])&&("href"==g?(e.onclick=e[g],e.href=e[g].href):e[g]=e[g]()),f.isDynProp(h.tag,g)&&(e["."+g]=e[g]);if(f.isObj(e.style))for(var c in e.style)g=e.style[c],f.isFunc(g)&&(e.style[c]=g());f.isObj(e._hooks)&&(h.hooks=e._hooks,e._hooks=null);h.key=f.isVal(e._key)?e._key:f.isVal(e._ref)?e._ref:f.isVal(e.id)?e.id:f.isVal(e.name)?e.name:null;e._ref&&(h.ref=e._ref);e._raw&&(h.raw=!0);e._data&&(h.data=
e._data);e._guard&&(h.guard=!0);e._ref=e._key=e._raw=e._data=e._guard=null}}else f.isVal(e)&&(h.type=f.TYPE_TEXT,h.body=e);null!==h.ref&&(B.refs[h.ref]=h);h.parent=d;h.idx=a;h.ns=d&&d.ns?d.ns:"svg"===h.tag||"math"===h.tag?h.tag:null;if(f.isArr(h.body))for(d=0,a=h.body.length;d<a;d++){c=h.body[d];var e=g=null,p=k=!1;f.isFunc(c)&&(c=c());if(null==c)k=!0;else{var t=f.isArr(c),n=t?!1:f.isObj(c);if(t)c.length?f.isArr(c[0])?p=!0:f.isFunc(c[0])?g=z(b[1],b[2]):(e=l(c,h,d,B),g=e.key):k=!0;else if(n)if(f.isFunc(c.redraw))c.moveTo(h,
d),e=c.node,g=c.view[1];else{h.body[d--]=""+c;continue}else""===c?k=!0:0<d&&h.body[d-1].type===f.TYPE_TEXT?(h.body[d-1].body+=""+c,k=!0):e=l(""+c,h,d,B)}k||p?(p?f.insertArr(h.body,c,d,1):h.body.splice(d,1),a=h.body.length,d--):(null!==g&&(h.hasKeys=!0),h.body[d]=e||c)}return h}function p(b,d){d&&y(b.hooks,"Recycle",q,[d,b]);if(f.isArr(b.body)){var a=0;b.body.forEach(function(c,e){var h=f.isArr(c);if(d){var k=m(c,b,d,a);if(null!==k){var g=k[0],k=k[1];g===a&&a++;g=d.body[g];h&&g.vm?2===k?g.vm.moveTo(b,
e,c[1]):1===k&&r(c[0],c[1],c[2],c[3],b,e):b.body[e]=p(c,g);return}}h?r(c[0],c[1],c[2],c[3],b,e):b.body[e]=p(c)})}return b}function A(b,d,c){var a=!b.el;if(b.type==f.TYPE_ELEM)if(a&&(b.el=d&&d.nodeName?d:b.ns?J.createElementNS(E[b.ns],b.tag):J.createElement(b.tag),b.props&&t(b)),f.isArr(b.body)){d=0;for(var e=b.el.firstChild;d<b.body.length;d++)e=A(b.body[d],null,e)?e:e.nextSibling||null}else f.isVal(b.body)&&(b.raw?b.el.innerHTML=b.body:a&&(b.el.textContent=b.body));else b.type==f.TYPE_TEXT&&a&&(b.el=
J.createTextNode(b.body));b.el._node=b;if(c===b.el)return!1;if((d=b.parent)&&d.el)return y(b.hooks,a?"Insert":"Reinsert",u,[b,c]),!0}function u(b,d){b.parent.el.insertBefore(b.el,d)}function m(b,d,c,a,e){var h=f.isArr(b),k=h?b[2]||null:b.key,g=c.hasKeys,p=d.hasKeys;c=c.body;d=d.body;if(null!==k&&g&&(k=f.indexOfKey(k,c),-1<k))return[k,2];a=a||0;if(a>c.length-1)return null;e=0===e?0:e||c.length-1;for(k=null;a<=e;a++)if(g=c[a],null!==g&&g.el)if(h&&g.vm){if(g.vm.view[0]===b[0]){if(g.vm.view[1]===z(b[1],
b[2]))return[a,2];var t=!1;if(I.viewScan)for(var w=0;w<d.length;w++){var n=d[w];if(!n.el&&n.vm&&n.vm.view[0]===g.vm.view[0]&&n.vm.view[1]===g.vm.view[1]){t=!0;break}}t||k||!p||-1!=f.indexOfKey(g.key,d)||(k=[a,1])}}else if(b.type===g.type&&(b.type===f.TYPE_TEXT||null!==b.tag&&b.tag===g.tag)&&(null===g.key||!p||-1==f.indexOfKey(g.key,d)))return[a,1];return k}function q(b,d){d.el=b.el;b.el=null;if(d.type===f.TYPE_TEXT&&d.body!==b.body)d.el.nodeValue=d.body;else{t(d,b);var c=!f.isArr(d.body),a=!f.isArr(b.body);
c&&d.body!==b.body?a&&d.el.firstChild?d.el.firstChild.nodeValue=d.body:d.raw?d.el.innerHTML=d.body:d.el.textContent=d.body:a&&!c&&(d.el.textContent="");b.moved=!0}}function y(b,d,c,a,e,h){if(b){var k=b["will"+d];f.isArr(k)&&(k=k[0]);var g=b["did"+d];f.isArr(g)&&(g=g[0]);b=function(){c.apply(null,a);g&&g.apply(null,h||e||a)};k?(k=k.apply(null,e||a),f.isProm(k)?k.then(b):b()):b()}else c.apply(null,a)}function D(b){if(b in K)return K[b];var d={tag:null,id:null,"class":null};d.tag=b.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,
function(b,a,e,c){e&&(d.id=e);c&&(d["class"]=c.replace(/\./g," ").trim());return a||"div"});return K[b]=d}function w(b,d,c,a){return function(e){var c,k=e.target._node,g=null;if(f.isFunc(b))c=b.call(d,k,e);else if(f.isArr(b))g=b.slice(1),c=b[0].apply(d,g.concat(k,e));else if(f.isObj(b))for(var p in b){var t=b[p];e.target.matches(p)&&(f.isArr(t)?(g=t.slice(1),c=t[0].apply(d,g.concat(k,e))):f.isFunc(t)&&(c=t.call(d,k,e)))}!1===c&&(e.preventDefault(),e.stopPropagation());a.opts.hasOwnProperty("watch")&&
a.opts.watch.fire({type:"event",vm:a,node:k,event:e,data:g})}}function t(b,d){var c=!d;d=d||{};if(d.props||b.props){var a=d.props||{},e=b.props||{},h=a.style,k=e.style;if(f.isObj(h)||f.isObj(k))F(b.el,b.tag,h||{},k||{},M,N,b.ns,c),a.style=e.style=null;F(b.el,b.tag,a,e,O,H,b.ns,c);k&&(e.style=k)}}function F(b,d,c,a,e,h,k,g){for(var f in a)null!==a[f]&&("."===f[0]?b[f.substr(1)]!==a[f]:a[f]!==c[f])&&e(b,f,a[f],k,g);for(f in c)null!==c[f]&&null==a[f]&&h(b,f,k,g)}function M(b,d,a){b.style[d]=f.autoPx(d,
a)}function N(b,d){b.style[d]=""}function O(b,d,a,c,e){"."===d[0]?(d=d.substr(1),"svg"===c?b[d].baseVal=a:b[d]=a):"class"===d?b.className=a:"id"===d||f.isEvProp(d)?b[d]=a:!1===a?H(b,d,c,e):b.setAttribute(d,!0===a?"":a)}function H(b,d,a,c){c||("."===d[0]?(d=d.substr(1),"svg"===a?b[d].baseVal=null:b[d]=null):"class"===d?b.className="":"id"===d||f.isEvProp(d)?b[d]=null:b.removeAttribute(d))}var E={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},K={},J="undefined"==typeof document?
{}:document,I={useRaf:!0,viewScan:!1,useDOM:!1};v.view=r;v.view.config=function(b){I=b};var G=null;v.view.extend=function(b,d){G=!G||d?[]:G;G.push(b)};var f=v.util;return v})(domvm);(function(v){var z=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,r=v.util;v.html=function(c){var a="";switch(c.type){case r.TYPE_ELEM:a+="<"+c.tag;if(c.props){var x=r.isVal(c.props.style)?c.props.style:"",l=r.isObj(c.props.style)?c.props.style:null;if(l)for(var p in l)null!==l[p]&&(x+=r.camelDash(p)+": "+r.autoPx(p,l[p])+"; ");for(p in c.props)r.isEvProp(p)||"."===p[0]||(l=c.props[p],r.isFunc(l)&&(l=l()),r.isObj(l)||(!0===l?a+=" "+p:!1!==l&&null!==l&&
"."!==p[0]&&(a+=" "+p+'="'+l+'"')));x.length&&(a+=' style="'+x.trim()+'"')}if(c.ns&&"svg"!==c.tag&&"math"!==c.tag&&!c.body)return a+"/>";a+=">";break;case r.TYPE_TEXT:return c.body}z.test(c.tag)||(r.isArr(c.body)?c.body.forEach(function(c){a+=v.html(c)}):a+=c.body||"",a+="</"+c.tag+">");return a}})(domvm);(function(v){var z=v.util;v.watch=function(r){function c(){}function a(a,A,u,m,q){q=q||{};q.method=(q.method||a).toUpperCase();if(null!==u){var y=Object.prototype.toString.call(u);"[object Array]"===y||"[object Object]"===y?(q.headers=q.headers||new Headers,q.headers.set("Content-Type","application/json"),q.body=JSON.stringify(u)):q.body=""+u}var y=m,D=c;m instanceof Array&&(y=m[0],m[1]&&(D=m[1]));var w={type:"fetch",fetch:{method:a,url:A,body:u}};m=fetch(A,q).then(function(a){if(200<=a.status&&300>
a.status)return a;var c=Error(a.status+": "+a.statusText);c.data=a;return Promise.reject(c)}).then(function(a){switch(a.headers.get("Content-Type").split("; ")[0]){case "application/json":return a.json();case "text/plain":return a.text();default:return a}}).then(y,D).then(function(a){!1!==a&&l.fire(w);return a},function(a){w.error=a;l.fire(w);return a});m._fetchArgs=[a,A,u,[y,D],q];return m}var x=[];z.isFunc(r)&&x.push(r);var l={on:function(a){x.push(a);return l},off:function(a){x.splice(x.indexOf(a),
1);return l},fire:z.raft(function(){z.execAll(x,arguments);return l}),prop:function(p,A){var u=p,m=function(a,c){if(arguments.length&&a!==u){var p=u;u=a;!1!==c&&l.fire({type:"prop",prop:m,data:{old:p,"new":a}})}return u};if(A&&A.then){m.update=c;if(A._fetchArgs){var q=A._fetchArgs[3];A._fetchArgs[3]=[function(a){return m(q[0]?q[0](a):a)},q[1]];m.update=function(){a.apply(null,A._fetchArgs)}}A.then(m)}return m.toString=m},sync:function(a,c,l){var m=a,q=c;"string"==typeof a&&(m=function(c){return"e."===
a.substr(0,2)?c[a.substr(2)]:c.target[a]});return function(a,p){var w=this!==window?this:null;w&&"string"==typeof c&&(q=function(a,p){var l=w[c];w[c]=a;r&&a!==l&&!1!==p&&r()});q(m(p),l)}},get:function(c,l,u){return a("get",c,null,l,u)},"delete":function(c,l,u){return a("delete",c,null,l,u)},post:function(c,l,u,m){return a("post",c,l,u,m)},put:function(c,l,u,m){return a("put",c,l,u,m)},patch:function(c,l,u,m){return a("patch",c,l,u,m)}};return l}})(domvm);(function(v){function z(a,c,l,m,q,y){var r=null,w=null,t=null;if("/"==l[0]){t=l;w=!1;m={};y=t.split("#");c=y[0].split("?");r=c[0];y=y[1];c[1]&&(q={},c[1].split("&").map(function(a){a=a.split("=");q[a[0]]=null==a[1]?!0:a[1]}));var F,x;for(x in a){l=a[x];var v=l.path;if(F=r.match(l.regexPath)){w=x;-1!==v.indexOf(":")&&(m={},F.shift(),v.replace(/:([^\/]+)/g,function(a,c){m[c]=F.shift()}));break}}}else{w=l;l=a[w];var v=c+l.path,z=l.vars||{},H=/^[^\/]+$/,t=-1!==v.indexOf(":")?r=v.replace(/:([^\/]+)/g,
function(a,c){if((z[c]||H).test(m[c]))return m[c]+="";throw Error("Invalid value for route '"+v+"' segment '"+c+"': '"+m[c]+"'");}):r=v;if(q){var t=t+"?",E;for(E in q)t+=E+(!0!==q[E]?"="+q[E]:"")+"&";t=t.slice(0,-1)}t+=y?"#"+y:""}return{href:t,name:w,path:r,segs:m,hash:y,query:q}}function r(a,c){for(var l in a){var m=a[l];m.regexPath=new RegExp("^"+c+m.path.replace(/:([^\/]+)/g,function(a,c){var l=""+m.vars[c];return"("+l.substring(1,l.lastIndexOf("/"))+")"})+"$")}}var c=[],a=null,x=!1,l="";v.route=
function(p,v){function u(){var a=location,a=x?a.href.substr(a.origin.length):a.hash.substr(1)||"/";return z(D,l,a)}var m=null,q={href:function(a,c,m,p,r){var u=z(D,l,a,c,m,p);return x?(a=function(a){q["goto"](u,null,null,null,r);a.preventDefault()},a.href=u.href,a):"#"+u.href},config:function(a){(x=a.useHist)&&(l=a.root||"");m=a.init||null},refresh:function(){q["goto"](u(),null,null,null,!0)},"goto":function(m,p,q,r,u){u=u||y;m.href||(m=z(D,l,m,p,q,r));if(!1===m.name)console.log("Could not find route");
else{p=null;for(q=0;q<c.length;q++)if(c[q].path===m.path){p=q;break}null===p&&(c.splice(a+1,1E4),c.push(m),p=c.length-1);m=c[a];q=c[p];r=!0;null!==a&&(r=(r=D[m.name].onexit)?r.apply(null,(m?[m.segs,m.query,m.hash]:[]).concat(q)):!0);if(!1!==r&&!1!==D[q.name].onenter.apply(null,(q?[q.segs,q.query,q.hash]:[]).concat(m))){if(x)history[u?"replaceState":"pushState"](null,"title",q.href);a=p}y=!1}},location:function(){return y?u():c[a]}},y=!0,D=p(q,v);r(D,l);onhashchange=onpopstate=function(a){(x||"popstate"!=
a.type)&&q["goto"](u(),null,null,null,!0)};m&&m();return q}})(domvm);
