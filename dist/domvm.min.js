/*
 https://github.com/leeoniya/domvm (1.x-dev)
*/
("undefined"!==typeof global?global:this).domvm={};(function(x){var u=("undefined"==typeof window?{}:window).requestAnimationFrame,t={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},g={TYPE_ELEM:1,
TYPE_TEXT:2,isArr:function(c){return c instanceof Array},isVal:function(c){c=typeof c;return"string"===c||"number"===c},isObj:function(c){return"object"===typeof c&&null!==c&&!g.isArr(c)},isFunc:function(c){return"function"===typeof c},isProm:function(c){return"object"===typeof c&&g.isFunc(c.then)},execAll:function(c,f,p,b,m,C){var r;c&&(g.isArr(c)?c:[c]).forEach(function(c){r=c.call(null,f,p,b,m,C)});return r},tick:function(c,f){f&&u?u&&u(function(){g.tick(c,f-1)}):g.isArr(c)?c[0].apply(null,c.slice(1)):
c()},insertArr:function(c,f,p,b){c.splice.apply(c,[p,b].concat(f))},isEvProp:function(c){return"on"===c.substr(0,2)},isDynProp:function(c,f){switch(c){case "input":case "textarea":case "select":case "option":switch(f){case "value":case "checked":case "selected":case "selectedIndex":return!0}}},camelDash:function(c){return c.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},autoPx:function(c,f){return isNaN(f)||t[c]?f:f+"px"},deepSet:function(c,f,p){f=f.split(".");var b=f.pop();f.forEach(function(b){c[b]||
(c[b]={});c=c[b]});c[b]=p},deepGet:function(c,f){var p=f.split(".");do c=c[p.shift()];while(p.length);return c},keyedIdx:function(c,f,p,b,m){for(b=0;b<f.length;b++)if(m=f[b],m.key===c)if(p){if(m.vm&&m.vm.view[0]===p)return b}else return b;return-1},raft:function(c){function f(){p=0;c.apply(b,m)}if(!u)return c;var p,b,m;return function(){b=this;m=arguments;p||(p=u(f))}}};x.utils=g})(domvm);(function(x){function u(){for(var a;a=L.pop();)a[0].apply(null,a.slice(1))}function t(a,e){return!1===e?null:null==e&&null!=a?a:k.isVal(e)||k.isObj(e)||k.isArr(e)||k.isFunc(e)?e:null}function g(a,e,z,b,d,n){function v(a,e,d){if(d)a[e]=a[e]||[],a[e].push(d);else for(var c in e)a[c]=a[c]||[],a[c].push(e[c])}function l(a,e,c){d=a;n=e;q.update(c,!1);null!=q.node&&(d.body[n]=q.node);return w(0,!1)}function g(a){return null==a?"":a}function w(a,c){if(a){for(var b=q;a--&&b.parent;)b=b.parent;b.redraw(0,
!0);return b.vm}(b=q.node)&&f(q,"willRedraw",q);var y=q.refs;q.refs={};var l=q.render.call(q.api,q,e,z);if(!1===l)return q.node.moved=!0,q.node.wasSame=!0,q.refs=y,q;y=m(l,d,n,q);y.vm=q;q.node=y;l=k.isVal(z)&&"^"===z[0]?z.substr(1):k.isVal(y.ref)&&"^"===y.ref[0]?y.ref.substr(1):null;y.key=null!=z?z:y.key;for(var v=d;v;)v.vm&&(q.parent||(q.parent=v.vm),null!==l&&k.deepSet(v.vm.refs,l,y)),v=v.parent;if((l=b)&&(y.type!==b.type||y.tag!==b.tag))var l=null,h=!0,g=b.el.parentNode;C(y,l);d&&(d.body[n]=y);
!1!==c&&(b&&p(b),!b&&B||r(y,null,y.el),h&&(g||y.parent.el).insertBefore(y.el,g.childNodes[b.idx]));b&&f(q,"didRedraw",q);!1!==c&&k.tick(u,2);return q}var B=!d;k.isArr(a)&&(e=a[1],z=a[2],b=a[3],a=a[0]);z=t(e,z);var q={api:{},node:null,view:[a,z],model:e,opts:b||{},render:null,update:function(a,d){null==a||z===e&&!k.isVal(z)||(e=q.model=a);return!1!==d?w(0):q},on:function(a,e){v(q.events,a,e)},hook:function(a,e){q.hooks=q.hooks||{};v(q.hooks,a,e)},events:{},hooks:null,redraw:I.useRaf?k.raft(w):w,patch:function(a,
e){var d=null!=a.el;if(k.isObj(e)){var b="class"in e?(g(a["class"])+" "+g(e["class"])).trim():a.props["class"],c="style"in e?e.style:a.props.style;d&&(d=Object.create(a.props),d["class"]=b,d.style=c,d={tag:a.tag,el:a.el,ns:a.ns,props:d},h(d,a));a.props["class"]=b;a.props.style=c}else b=a.parent,d=C(m(e,b,a.idx,q),a),b.body[a.idx]=d},emit:function(a){for(var e=Array.prototype.slice.call(arguments),d=q,b;d;){if(b=d.events[a]){e[0]=b;k.execAll.apply(null,e);break}d=d.parent}},refs:{},parent:null,mount:function(a,
e){var d=null;e&&(a.textContent="",d=a,a=null);r(q.node,d,null,a);return q},attach:function(a){c(q.node,a);return q},unmount:function(){p(q.node)},moveTo:l,updIdx:function(a){n=a}};b&&b.hooks&&q.hook(b.hooks);k.execAll(G,q);q.render=a.call(q.api,q,e,z);return d?l(d,n):w(0)}function c(a,e){a.el=e;e._node=a;for(var b in a.props){var y=a.props[b],d=k.isEvProp(b)?b:"."===b[0]?b.substr(1):null;null!==d&&(e[d]=y)}if(k.isArr(a.body))for(b=0;b<a.body.length;b++)c(a.body[b],e.childNodes[b])}function f(a,e,
b,c,d,n){if(a&&a.hooks&&(a=a.hooks[e]))if(I.useRaf&&"did"==e.substr(0,3))L.push([k.execAll,a,b,c,d,n]);else return k.execAll(a,b,c,d,n)}function p(a,e){var c=a.el&&!a.moved;if(c){var y=f(a.vm,"willUnmount",a.vm),d=f(a,"willRemove",a),n=y||d;a.removed=!0}a.wasSame?a.wasSame=!1:(k.isArr(a.body)&&a.body.forEach(function(a,d){p(a,e||n)}),e||(n?n.then(function(){b(a,c)}):b(a,c)));a.moved=!1}function b(a,e){null!=a.el&&a.el.parentNode&&(e&&(a.el.parentNode.removeChild(a.el),a.el=null,f(a.vm,"didUnmount",
a.vm),f(a,"didRemove",a)),k.isArr(a.body)&&a.body.forEach(function(a,e){b(a,!a.moved)}))}function m(a,e,b,c){var d=a;a={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,wasSame:!1,removed:!1,hooks:null,tag:null,"class":null,ns:null,guard:!1,raw:!1,props:null,el:null,hasKeys:!1,body:null};k.isFunc(d)&&(d=d());if(k.isArr(d)&&d.length){a.type=k.TYPE_ELEM;if(1<d.length){var h=1;k.isObj(d[1])&&(a.props=d[1],h=2);a.body=d.length==h+1?k.isVal(d[h])?d[h]:k.isFunc(d[h])?d[h]():d.slice(h):d.slice(h)}a.tag=
d[0];A(a);if(a.props){var d=a.props,v;for(v in d)k.isEvProp(v)?d[v]=n(d[v],c.opts.evctx||c.model||null,a,c):k.isFunc(d[v])&&("href"==v?(d.onclick=d[v],d.href=d[v].href):d[v]=d[v]()),k.isDynProp(a.tag,v)&&(d["."+v]=d[v]);if(k.isObj(d.style))for(var l in d.style)v=d.style[l],k.isFunc(v)&&(d.style[l]=v());k.isObj(d._hooks)&&(a.hooks=d._hooks,d._hooks=null);a.key=k.isVal(d._key)?d._key:k.isVal(d._ref)?d._ref:k.isVal(d.id)?d.id:k.isVal(d.name)?d.name:null;null!=d._ref&&(a.ref=d._ref);d._raw&&(a.raw=!0);
null!=d._data&&(a.data=d._data);d._guard&&(a.guard=!0);d._ref=d._key=d._raw=d._data=d._guard=null}}else k.isVal(d)&&(a.type=k.TYPE_TEXT,a.body=d);null!==a.ref&&k.deepSet(c.refs,a.ref,a);a.parent=e;a.idx=b;a.ns=e&&e.ns?e.ns:"svg"===a.tag||"math"===a.tag?a.tag:null;if(k.isArr(a.body))for(e=0,b=a.body.length;e<b;e++){l=a.body[e];var d=v=null,f=h=!1;k.isFunc(l)&&(l=l());if(null==l)h=!0;else{var C=k.isArr(l),p=C?!1:k.isObj(l);if(C)l.length?"string"==typeof l[0]&&""!==l[0]?(d=m(l,a,e,c),v=d.key):k.isFunc(l[0])?
v=t(l[1],l[2]):f=!0:h=!0;else if(p)if(k.isFunc(l.redraw))l.moveTo(a,e),d=l.node,v=l.view[1];else{a.body[e--]=""+l;continue}else""===l?h=!0:0<e&&a.body[e-1].type===k.TYPE_TEXT?(a.body[e-1].body+=""+l,h=!0):d=m(""+l,a,e,c)}h||f?(f?k.insertArr(a.body,l,e,1):a.body.splice(e,1),b=a.body.length,e--):(null!==v&&(a.hasKeys=!0),a.body[e]=d||l)}return a}function C(a,e){e&&(f(a,"willRecycle",e,a),B(e,a),f(a,"didRecycle",e,a));if(k.isArr(a.body)){var b=0;a.body.forEach(function(c,d){var h=k.isArr(c);if(e){var n=
w(c,a,e,b);if(null!==n){var l=n[0],n=n[1];l===b&&b++;l=e.body[l];l.vm?h?2===n?l.vm.moveTo(a,d,c[1]):1===n&&g(c[0],c[1],c[2],c[3],a,d):c.vm&&2===n&&c.vm===l.vm&&l.vm.moveTo(a,d):a.body[d]=C(c,l);return}}h?g(c[0],c[1],c[2],c[3],a,d):a.body[d]=C(c)})}return a}function r(a,e,b,c){for(var d=!a.el;b&&b._node.removed;)b=b.nextSibling;d&&f(a.vm,"willMount",a.vm);if(a.type==k.TYPE_ELEM)if(d&&(a.el=e||(a.ns?J.createElementNS(E[a.ns],a.tag):J.createElement(a.tag)),a.props&&h(a)),k.isArr(a.body)){e=0;for(var n=
a.el.firstChild;e<a.body.length;e++)n=r(a.body[e],null,n)}else k.isVal(a.body)&&(a.raw?a.el.innerHTML=a.body:d&&(a.el.textContent=a.body));else a.type==k.TYPE_TEXT&&d&&(a.el=J.createTextNode(a.body));a.el._node=a;e=a.parent;b!==a.el&&(c||e&&e.el)&&(e=d?"Insert":"Reinsert",f(a,"will"+e,a),(c||a.parent.el).insertBefore(a.el,b),f(a,"did"+e,a));d&&a.vm&&a.vm.hooks&&!a.moved&&f(a.vm,"didMount",a.vm);return b!==a.el?b:b.nextSibling}function w(a,e,b,c,d){var n=k.isArr(a),h=n?t(a[1],a[2]):a.key,l=b.hasKeys,
m=e.hasKeys;b=b.body;e=e.body;if(null!==h&&l)return a=k.keyedIdx(h,b,n?a[0]:null),-1<a?[a,2]:null;c=c||0;if(c>b.length-1)return null;d=0===d?0:d||b.length-1;for(h=null;c<=d;c++)if(l=b[c],null!==l&&l.el)if(n&&l.vm){if(l.vm.view[0]===a[0]){if(l.vm.view[1]===t(a[1],a[2]))return[c,2];!h&&m&&-1==k.keyedIdx(l.key,e,l.vm.view[0])&&(h=[c,1])}}else if(a.type===l.type&&(a.type===k.TYPE_TEXT||null!==a.tag&&a.tag===l.tag)&&(null===l.key||!m||-1==k.keyedIdx(l.key,e,l.vm?l.vm.view[0]:null)))return[c,1];return h}
function B(a,e){e.el=a.el;a.el=null;e.el&&(e.el._node=e);if(e.type===k.TYPE_TEXT&&e.body!==a.body)e.el.nodeValue=e.body;else{h(e,a);var b=!k.isArr(e.body),c=!k.isArr(a.body);b&&e.body!==a.body?c&&e.el.firstChild?e.el.firstChild.nodeValue=e.body:e.raw?e.el.innerHTML=e.body:e.el.textContent=e.body:c&&!b&&(e.el.textContent="");a.moved=!0}}function A(a){/[.#]/.test(a.tag)&&(a.tag=a.tag.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(e,b,c,d){d&&(d=d.replace(/\./g," ").trim());if(c||d)e=
a.props||{},c&&null==e.id&&(e.id=c),d&&(a["class"]=d,e["class"]=d+(null!=e["class"]?" "+e["class"]:"")),a.props=e;return b||"div"}))}function n(a,e,b,c){return function(b){var n,h=b.target._node,l=null;if(k.isFunc(a))n=a.call(e,b,h,c);else if(k.isArr(a))l=a.slice(1),n=a[0].apply(e,l.concat(b,h,c));else if(k.isObj(a))for(var m in a){var f=a[m];b.target.matches(m)&&(k.isArr(f)?(l=f.slice(1),n=f[0].apply(e,l.concat(b,h,c))):k.isFunc(f)&&(n=f.call(e,b,h,c)))}!1===n&&(b.preventDefault(),b.stopPropagation());
c.opts.hasOwnProperty("watch")&&c.opts.watch.fire({type:"event",vm:c,node:h,event:b,data:l})}}function h(a,e){var b=!e;e=e||{};if(e.props||a.props){var c=e.props||{},d=a.props||{},n=c.style,h=d.style;if(k.isObj(n)||k.isObj(h))F(a.el,a.tag,n||{},h||{},M,D,a.ns,b),c.style=d.style=null;F(a.el,a.tag,c,d,K,H,a.ns,b);h&&(d.style=h)}}function F(a,b,c,h,d,n,k,l){for(var m in h)null!==h[m]&&("."===m[0]?a[m.substr(1)]!==h[m]:h[m]!==c[m])&&d(a,m,h[m],k,l);for(m in c)null!==c[m]&&null==h[m]&&n(a,m,k,l)}function M(a,
b,c){a.style[b]=k.autoPx(b,c)}function D(a,b){a.style[b]=""}function K(a,b,c,h,d){"."===b[0]?(b=b.substr(1),"svg"===h?a[b].baseVal=c:a[b]=c):"class"===b?a.className=c:"id"===b||k.isEvProp(b)?a[b]=c:!1===c?H(a,b,h,d):a.setAttribute(b,!0===c?"":c)}function H(a,b,c,h){h||("."===b[0]?(b=b.substr(1),"svg"===c?a[b].baseVal=null:a[b]=null):"class"===b?a.className="":"id"===b||k.isEvProp(b)?a[b]=null:a.removeAttribute(b))}var E={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},
J="undefined"==typeof document?{}:document,L=[],I={useRaf:!0};x.view=g;x.view.config=function(a){I=a};var G=null;x.view.extend=function(a,b){G=!G||b?[]:G;G.push(a)};var k=x.utils;return x})(domvm);(function(x){var u=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,t=x.utils;x.html=function(g){var c="";switch(g.type){case t.TYPE_ELEM:c+="<"+g.tag;if(g.props){var f=t.isVal(g.props.style)?g.props.style:"",p=t.isObj(g.props.style)?g.props.style:null;if(p)for(var b in p)null!==p[b]&&(f+=t.camelDash(b)+": "+t.autoPx(b,p[b])+"; ");for(b in g.props)t.isEvProp(b)||"."===b[0]||(p=g.props[b],t.isFunc(p)&&(p=p()),t.isObj(p)||(!0===p?c+=" "+b:!1!==p&&null!==p&&
"."!==b[0]&&(c+=" "+b+'="'+p+'"')));f.length&&(c+=' style="'+f.trim()+'"')}if(g.ns&&"svg"!==g.tag&&"math"!==g.tag&&!g.body)return c+"/>";c+=">";break;case t.TYPE_TEXT:return g.body}u.test(g.tag)||(t.isArr(g.body)?g.body.forEach(function(b){c+=x.html(b)}):c+=g.body||"",c+="</"+g.tag+">");return c}})(domvm);(function(x){var u=x.utils;x.watch=function(t){function g(){}function c(b,c,f,r,w){w=w||{};w.method=b.toUpperCase();"credentials"in w||(w.credentials="same-origin");null!==f&&(u.isArr(f)||u.isObj(f)?(w.headers=w.headers||new Headers,w.headers.set("Content-Type","application/json"),w.body=JSON.stringify(f)):w.body=""+f);var B=r,A=g;r instanceof Array&&(B=r[0],r[1]&&(A=r[1]));var n={type:"fetch",fetch:{method:b,url:c,body:f}};r=fetch(c,w).then(function(b){if(200<=b.status&&300>b.status)return b;var c=
Error(b.status+": "+b.statusText);c.data=b;return Promise.reject(c)}).then(function(b){switch(b.headers.get("Content-Type").split("; ")[0]){case "application/json":return b.json();case "text/plain":return b.text();default:return b}}).then(B,A).then(function(b){!1!==b&&p.fire(n);return b},function(b){n.error=b;p.fire(n);return b});r._fetchArgs=[b,c,f,[B,A],w];return r}var f=[];u.isFunc(t)&&f.push(t);var p={on:function(b){f.push(b);return p},off:function(b){f.splice(f.indexOf(b),1);return p},fire:u.raft(function(b){u.execAll(f,
b);return p}),prop:function(b,m){var f=b,r=function(b,c,n){if(arguments.length&&b!==f){var h=f;f=b;n=n||{type:"prop",prop:r,data:{old:h,"new":b}};u.isFunc(c)?c(n):!1!==c&&p.fire(n)}return f};r._prop=!0;if(m&&m.then){r.update=g;if(m._fetchArgs){var w=m._fetchArgs[3];m._fetchArgs[3]=[function(b){return r(w[0]?w[0](b):b)},w[1]];r.update=function(){c.apply(null,m._fetchArgs)}}m.then(r)}return r.toString=r},sync:function(b,c,f){var r=b,g=c;u.isFunc(r)||(r=function(c,f,n){if("string"==typeof b){var h,m;
"e."==b.substr(0,2)?(h=c,m=b.substr(2)):(h=c.target,m=b)}return u.deepGet(h,m)});u.isArr(g)&&(g=function(b,f,n){var h=u.deepGet(c[0],c[1]);b!==h&&(u.deepSet(c[0],c[1],b),u.isFunc(f)?f(n):!1!==f&&p.fire(n))});return function(b,c,n){var h={type:"sync",vm:n,node:c,event:b};g(r(b,c,n),f,h)}},fetch:c,get:function(b,f,g){g?b+=p.query(f):g=f;return c("get",b,null,g)},"delete":function(b,f,g){g?b+=p.query(f):g=f;return c("delete",b,null,g)},post:function(b,f,g){return c("post",b,f,g)},put:function(b,f,g){return c("put",
b,f,g)},patch:function(b,f,g){return c("patch",b,f,g)},query:function(b){if(!u.isObj(b))return"";var c=[],f=encodeURIComponent,g;for(g in b)c.push(f(g)+"="+f(b[g]));return c.length?"?"+c.join("&"):""}};return p}})(domvm);(function(x){function u(b,c,f,g,p,u){var t=null,n=null,h=null;if("/"==f[0]){h=f;n=!1;g={};u=h.split("#");c=u[0].split("?");t=c[0];u=u[1];c[1]&&(p={},c[1].split("&").map(function(b){b=b.split("=");p[b[0]]=null==b[1]?!0:b[1]}));var F,x;for(x in b){f=b[x];var D=f.path;if(F=t.match(f.regexPath)){n=x;-1!==D.indexOf(":")&&(g={},F.shift(),D.replace(/:([^\/]+)/g,function(b,c){g[c]=F.shift()}));break}}}else{n=f;f=b[n];var D=c+f.path,K=f.vars||{},H=/^[^\/]+$/,h=-1!==D.indexOf(":")?t=D.replace(/:([^\/]+)/g,
function(b,c){if((K[c]||H).test(g[c]))return g[c]+="";throw Error("Invalid value for route '"+D+"' segment '"+c+"': '"+g[c]+"'");}):t=D;if(p){var h=h+"?",E;for(E in p)h+=E+(!0!==p[E]?"="+p[E]:"")+"&";h=h.slice(0,-1)}h+=u?"#"+u:""}return{href:h,name:n,path:t,segs:g,hash:u,query:p}}function t(b,c){for(var f in b){var g=b[f];g.regexPath=new RegExp("^"+c+g.path.replace(/:([^\/]+)/g,function(b,c){var f=""+g.vars[c];return"("+f.substring(1,f.lastIndexOf("/"))+")"})+"$")}}var g=[],c=null,f=!1,p="";x.route=
function(b,m){function x(){var b=location,b=f?b.href.substr(b.origin.length):b.hash.substr(1)||"/";return u(A,p,b)}var r=null,w={href:function(b,c,g,m,r){var t=u(A,p,b,c,g,m);return f?(b=function(b){w["goto"](t,null,null,null,r);b.preventDefault()},b.href=t.href,b):"#"+t.href},config:function(b){(f=b.useHist)&&(p=b.root||"");r=b.init||null},refresh:function(){w["goto"](x(),null,null,null,!0)},"goto":function(b,h,m,r,t){t=t||B;b.href||(b=u(A,p,b,h,m,r));if(!1===b.name)console.log("Could not find route");
else{h=null;for(m=0;m<g.length;m++)if(g[m].href===b.href){h=m;break}null===h&&(g.splice(c+1,1E4),g.push(b),h=g.length-1);b=g[c];m=g[h];r=!0;null!==c&&(r=(r=A[b.name].onexit)?r.apply(null,(b?[b.segs,b.query,b.hash]:[]).concat(m)):!0);if(!1!==r&&!1!==A[m.name].onenter.apply(null,(m?[m.segs,m.query,m.hash]:[]).concat(b))){if(f)history[t?"replaceState":"pushState"](null,"title",m.href);c=h}B=!1}},location:function(){return B?x():g[c]}},B=!0,A=b(w,m);t(A,p);window.onhashchange=window.onpopstate=function(b){(f||
"popstate"!=b.type)&&w["goto"](x(),null,null,null,!0)};r&&r();return w}})(domvm);
