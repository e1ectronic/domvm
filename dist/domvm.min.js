/*
 https://github.com/leeoniya/domvm (1.x-dev)
*/
("undefined"!==typeof global?global:this).domvm={};(function(x){var v=("undefined"==typeof window?{}:window).requestAnimationFrame,u={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},g={TYPE_ELEM:1,
TYPE_TEXT:2,isArr:function(c){return c instanceof Array},isVal:function(c){c=typeof c;return"string"===c||"number"===c},isObj:function(c){return"object"===typeof c&&null!==c&&!g.isArr(c)},isFunc:function(c){return"function"===typeof c},isProm:function(c){return"object"===typeof c&&g.isFunc(c.then)},execAll:function(c,f,p,b,n,z){var t;c&&(g.isArr(c)?c:[c]).forEach(function(c){t=c.call(null,f,p,b,n,z)});return t},tick:function(c,f){f&&v?v&&v(function(){g.tick(c,f-1)}):g.isArr(c)?c[0].apply(null,c.slice(1)):
c()},insertArr:function(c,f,p,b){c.splice.apply(c,[p,b].concat(f))},isEvProp:function(c){return"on"===c.substr(0,2)},isDynProp:function(c,f){switch(c){case "input":case "textarea":case "select":case "option":switch(f){case "value":case "checked":case "selected":case "selectedIndex":return!0}}},camelDash:function(c){return c.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},autoPx:function(c,f){return isNaN(f)||u[c]?f:f+"px"},deepSet:function(c,f,p){f=f.split(".");var b=f.pop();f.forEach(function(b){c[b]||
(c[b]={});c=c[b]});c[b]=p},deepGet:function(c,f){var p=f.split(".");do c=c[p.shift()];while(p.length);return c},keyedIdx:function(c,f,p,b,n){for(b=0;b<f.length;b++)if(n=f[b],n.key===c)if(p){if(n.vm&&n.vm.view[0]===p)return b}else return b;return-1},raft:function(c){function f(){p=0;c.apply(b,n)}if(!v)return c;var p,b,n;return function(){b=this;n=arguments;p||(p=v(f))}}};x.utils=g})(domvm);(function(x){function v(){for(var a;a=L.pop();)a[0].apply(null,a.slice(1))}function u(a,e){return!1===e?null:null==e&&null!=a?a:k.isVal(e)||k.isObj(e)||k.isArr(e)||k.isFunc(e)?e:null}function g(a,e,A,b,d,q){function F(a,e,d){if(d)a[e]=a[e]||[],a[e].push(d);else for(var c in e)a[c]=a[c]||[],a[c].push(e[c])}function l(a,e,c){d=a;q=e;r.update(c,!1);null!=r.node&&(d.body[q]=r.node);return g(0,!1)}function m(a){return null==a?"":a}function g(a,c){if(a){for(var b=r;a--&&b.parent;)b=b.parent;b.redraw(0,
!0);return b.vm}(b=r.node)&&f(r,"willRedraw",r);var y=r.refs;r.refs={};var l=r.render.call(r.api,r,e,A);if(!1===l)return r.node.moved=!0,r.node.wasSame=!0,r.refs=y,r;y=n(l,d,q,r);y.vm=r;r.node=y;l=k.isVal(A)&&"^"===A[0]?A.substr(1):k.isVal(y.ref)&&"^"===y.ref[0]?y.ref.substr(1):null;y.key=null!=A?A:y.key;for(var h=d;h;)h.vm&&(r.parent||(r.parent=h.vm),null!==l&&k.deepSet(h.vm.refs,l,y)),h=h.parent;if((l=b)&&(y.type!==b.type||y.tag!==b.tag))var l=null,m=!0,F=b.el.parentNode;z(y,l);d&&(d.body[q]=y);
!1!==c&&(b&&p(b),!b&&w||t(y,null,y.el),m&&(F||y.parent.el).insertBefore(y.el,F.childNodes[b.idx]));b&&f(r,"didRedraw",r);!1!==c&&k.tick(v,2);return r}var w=!d;k.isArr(a)&&(e=a[1],A=a[2],b=a[3],a=a[0]);A=u(e,A);var r={api:{},node:null,view:[a,A],model:e,opts:b||{},render:null,update:function(a,d){null==a||A===e&&!k.isVal(A)||(e=r.model=a);return!1!==d?g(0):r},on:function(a,e){F(r.events,a,e)},hook:function(a,e){r.hooks=r.hooks||{};F(r.hooks,a,e)},events:{},hooks:null,redraw:J.useRaf?k.raft(g):g,patch:function(a,
e){var d=null!=a.el;if(k.isObj(e)){var b="class"in e?(m(a["class"])+" "+m(e["class"])).trim():a.props["class"],c="style"in e?e.style:a.props.style;d&&(d=Object.create(a.props),d["class"]=b,d.style=c,d={tag:a.tag,el:a.el,ns:a.ns,props:d},h(d,a));a.props["class"]=b;a.props.style=c}else b=a.parent,d=z(n(e,b,a.idx,r),a),b.body[a.idx]=d},emit:function(a){for(var e=Array.prototype.slice.call(arguments),d=r,b;d;){if(b=d.events[a]){e[0]=b;k.execAll.apply(null,e);break}d=d.parent}},refs:{},parent:null,mount:function(a,
e){var d=null;e&&(a.textContent="",d=a,a=null);t(r.node,d,null,a);return r},attach:function(a){c(r.node,a);return r},unmount:function(){p(r.node)},moveTo:l,updIdx:function(a){q=a}};b&&b.hooks&&r.hook(b.hooks);k.execAll(G,r);r.render=a.call(r.api,r,e,A);return d?l(d,q):g(0)}function c(a,e){a.el=e;e._node=a;for(var b in a.props){var y=a.props[b],d=k.isEvProp(b)?b:"."===b[0]?b.substr(1):null;null!==d&&(e[d]=y)}if(k.isArr(a.body))for(b=0;b<a.body.length;b++)c(a.body[b],e.childNodes[b])}function f(a,e,
b,c,d,q){if(a&&a.hooks&&(a=a.hooks[e]))if(J.useRaf&&"did"==e.substr(0,3))L.push([k.execAll,a,b,c,d,q]);else return k.execAll(a,b,c,d,q)}function p(a,e){var c=a.el&&!a.moved;if(c){var y=f(a.vm,"willUnmount",a.vm),d=f(a,"willRemove",a),q=y||d;a.removed=!0}a.wasSame?a.wasSame=!1:(k.isArr(a.body)&&a.body.forEach(function(a,d){p(a,e||q)}),e||(q?q.then(function(){b(a,c)}):b(a,c)));a.moved=!1}function b(a,e){null!=a.el&&a.el.parentNode&&(e&&(a.el.parentNode.removeChild(a.el),a.el=null,f(a.vm,"didUnmount",
a.vm),f(a,"didRemove",a)),k.isArr(a.body)&&a.body.forEach(function(a,e){b(a,!a.moved)}))}function n(a,e,b,c){var d=a;a={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,wasSame:!1,removed:!1,hooks:null,tag:null,"class":null,ns:null,guard:!1,raw:!1,props:null,el:null,hasKeys:!1,body:null};k.isFunc(d)&&(d=d());if(k.isArr(d)&&d.length){a.type=k.TYPE_ELEM;if(1<d.length){var q=1;k.isObj(d[1])&&(a.props=d[1],q=2);a.body=d.length==q+1?k.isVal(d[q])?d[q]:k.isFunc(d[q])?d[q]():d.slice(q):d.slice(q)}a.tag=
d[0];d=a.tag;q=M[d];q||(q=["",""],q={tag:(d.match(/^[-\w]+/)||["div"])[0],id:(d.match(/#([-\w]+)/)||q)[1],"class":(d.match(/\.([-\w.]+)/)||q)[1].replace(/\./g," ")},M[d]=q);a.tag=q.tag;if(q.id||q["class"])d=a.props||{},q.id&&null==d.id&&(d.id=q.id),q["class"]&&(a["class"]=q["class"],d["class"]=q["class"]+(null!=d["class"]?" "+d["class"]:"")),a.props=d;if(a.props){var d=a.props,h;for(h in d)k.isEvProp(h)?d[h]=B(d[h],c.opts.evctx||c.model||null,a,c):k.isFunc(d[h])&&("href"==h?(d.onclick=d[h],d.href=
d[h].href):d[h]=d[h]()),k.isDynProp(a.tag,h)&&(d["."+h]=d[h]);if(k.isObj(d.style))for(var l in d.style)h=d.style[l],k.isFunc(h)&&(d.style[l]=h());k.isObj(d._hooks)&&(a.hooks=d._hooks,d._hooks=null);a.key=k.isVal(d._key)?d._key:k.isVal(d._ref)?d._ref:k.isVal(d.id)?d.id:k.isVal(d.name)?d.name:null;null!=d._ref&&(a.ref=d._ref);d._raw&&(a.raw=!0);null!=d._data&&(a.data=d._data);d._guard&&(a.guard=!0);d._ref=d._key=d._raw=d._data=d._guard=null}}else k.isVal(d)&&(a.type=k.TYPE_TEXT,a.body=d);null!==a.ref&&
k.deepSet(c.refs,a.ref,a);a.parent=e;a.idx=b;a.ns=e&&e.ns?e.ns:"svg"===a.tag||"math"===a.tag?a.tag:null;if(k.isArr(a.body))for(e=0,b=a.body.length;e<b;e++){l=a.body[e];var d=h=null,m=q=!1;k.isFunc(l)&&(l=l());if(null==l)q=!0;else{var f=k.isArr(l),z=f?!1:k.isObj(l);if(f)l.length?"string"==typeof l[0]&&""!==l[0]?(d=n(l,a,e,c),h=d.key):k.isFunc(l[0])?h=u(l[1],l[2]):m=!0:q=!0;else if(z)if(k.isFunc(l.redraw))l.moveTo(a,e),d=l.node,h=l.view[1];else{a.body[e--]=""+l;continue}else""===l?q=!0:0<e&&a.body[e-
1].type===k.TYPE_TEXT?(a.body[e-1].body+=""+l,q=!0):d=n(""+l,a,e,c)}q||m?(m?k.insertArr(a.body,l,e,1):a.body.splice(e,1),b=a.body.length,e--):(null!==h&&(a.hasKeys=!0),a.body[e]=d||l)}return a}function z(a,e){e&&(f(a,"willRecycle",e,a),C(e,a),f(a,"didRecycle",e,a));if(k.isArr(a.body)){var b=0;a.body.forEach(function(c,d){var h=k.isArr(c);if(e){var m=w(c,a,e,b);if(null!==m){var l=m[0],m=m[1];l===b&&b++;l=e.body[l];l.vm?h?2===m?l.vm.moveTo(a,d,c[1]):1===m&&g(c[0],c[1],c[2],c[3],a,d):c.vm&&2===m&&c.vm===
l.vm&&l.vm.moveTo(a,d):a.body[d]=z(c,l);return}}h?g(c[0],c[1],c[2],c[3],a,d):a.body[d]=z(c)})}return a}function t(a,e,b,c){for(var d=!a.el;b&&b._node.removed;)b=b.nextSibling;d&&f(a.vm,"willMount",a.vm);if(a.type==k.TYPE_ELEM)if(d&&(a.el=e||(a.ns?E.createElementNS(K[a.ns],a.tag):E.createElement(a.tag)),a.props&&h(a)),k.isArr(a.body)){e=0;for(var m=a.el.firstChild;e<a.body.length;e++)m=t(a.body[e],null,m)}else k.isVal(a.body)&&(a.raw?a.el.innerHTML=a.body:d&&(a.el.textContent=a.body));else a.type==
k.TYPE_TEXT&&d&&(a.el=E.createTextNode(a.body));a.el._node=a;e=a.parent;b!==a.el&&(c||e&&e.el)&&(e=d?"Insert":"Reinsert",f(a,"will"+e,a),(c||a.parent.el).insertBefore(a.el,b),f(a,"did"+e,a));d&&a.vm&&a.vm.hooks&&!a.moved&&f(a.vm,"didMount",a.vm);return b!==a.el?b:b.nextSibling}function w(a,e,b,c,d){var h=k.isArr(a),m=h?u(a[1],a[2]):a.key,l=b.hasKeys,n=e.hasKeys;b=b.body;e=e.body;if(null!==m&&l)return a=k.keyedIdx(m,b,h?a[0]:null),-1<a?[a,2]:null;c=c||0;if(c>b.length-1)return null;d=0===d?0:d||b.length-
1;for(m=null;c<=d;c++)if(l=b[c],null!==l&&l.el)if(h&&l.vm){if(l.vm.view[0]===a[0]){if(l.vm.view[1]===u(a[1],a[2]))return[c,2];!m&&n&&-1==k.keyedIdx(l.key,e,l.vm.view[0])&&(m=[c,1])}}else if(a.type===l.type&&(a.type===k.TYPE_TEXT||null!==a.tag&&a.tag===l.tag)&&(null===l.key||!n||-1==k.keyedIdx(l.key,e,l.vm?l.vm.view[0]:null)))return[c,1];return m}function C(a,e){e.el=a.el;a.el=null;e.el&&(e.el._node=e);if(e.type===k.TYPE_TEXT&&e.body!==a.body)e.el.nodeValue=e.body;else{h(e,a);var b=!k.isArr(e.body),
c=!k.isArr(a.body);b&&e.body!==a.body?c&&e.el.firstChild?e.el.firstChild.nodeValue=e.body:e.raw?e.el.innerHTML=e.body:e.el.textContent=e.body:c&&!b&&(e.el.textContent="");a.moved=!0}}function B(a,e,b,c){return function(b){var h,m=b.target._node,l=null;if(k.isFunc(a))h=a.call(e,b,m,c);else if(k.isArr(a))l=a.slice(1),h=a[0].apply(e,l.concat(b,m,c));else if(k.isObj(a))for(var n in a){var f=a[n];b.target.matches(n)&&(k.isArr(f)?(l=f.slice(1),h=f[0].apply(e,l.concat(b,m,c))):k.isFunc(f)&&(h=f.call(e,b,
m,c)))}!1===h&&(b.preventDefault(),b.stopPropagation());c.opts.hasOwnProperty("watch")&&c.opts.watch.fire({type:"event",vm:c,node:m,event:b,data:l})}}function h(a,b){var c=!b;b=b||{};if(b.props||a.props){var h=b.props||{},d=a.props||{},n=h.style,f=d.style;if(k.isObj(n)||k.isObj(f))m(a.el,a.tag,n||{},f||{},H,N,a.ns,c),h.style=d.style=null;m(a.el,a.tag,h,d,D,I,a.ns,c);f&&(d.style=f)}}function m(a,b,c,h,d,m,k,l){for(var n in h)null!==h[n]&&("."===n[0]?a[n.substr(1)]!==h[n]:h[n]!==c[n])&&d(a,n,h[n],k,
l);for(n in c)null!==c[n]&&null==h[n]&&m(a,n,k,l)}function H(a,b,c){a.style[b]=k.autoPx(b,c)}function N(a,b){a.style[b]=""}function D(a,b,c,h,d){"."===b[0]?(b=b.substr(1),"svg"===h?a[b].baseVal=c:a[b]=c):"class"===b?a.className=c:"id"===b||k.isEvProp(b)?a[b]=c:!1===c?I(a,b,h,d):a.setAttribute(b,!0===c?"":c)}function I(a,b,c,h){h||("."===b[0]?(b=b.substr(1),"svg"===c?a[b].baseVal=null:a[b]=null):"class"===b?a.className="":"id"===b||k.isEvProp(b)?a[b]=null:a.removeAttribute(b))}var K={svg:"http://www.w3.org/2000/svg",
math:"http://www.w3.org/1998/Math/MathML"},E="undefined"==typeof document?{}:document,M={},L=[],J={useRaf:!0};x.view=g;x.view.config=function(a){J=a};var G=null;x.view.extend=function(a,b){G=!G||b?[]:G;G.push(a)};var k=x.utils;return x})(domvm);(function(x){var v=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,u=x.utils;x.html=function(g){var c="";switch(g.type){case u.TYPE_ELEM:c+="<"+g.tag;if(g.props){var f=u.isVal(g.props.style)?g.props.style:"",p=u.isObj(g.props.style)?g.props.style:null;if(p)for(var b in p)null!==p[b]&&(f+=u.camelDash(b)+": "+u.autoPx(b,p[b])+"; ");for(b in g.props)u.isEvProp(b)||"."===b[0]||(p=g.props[b],u.isFunc(p)&&(p=p()),u.isObj(p)||(!0===p?c+=" "+b:!1!==p&&null!==p&&
"."!==b[0]&&(c+=" "+b+'="'+p+'"')));f.length&&(c+=' style="'+f.trim()+'"')}if(g.ns&&"svg"!==g.tag&&"math"!==g.tag&&!g.body)return c+"/>";c+=">";break;case u.TYPE_TEXT:return g.body}v.test(g.tag)||(u.isArr(g.body)?g.body.forEach(function(b){c+=x.html(b)}):c+=g.body||"",c+="</"+g.tag+">");return c}})(domvm);(function(x){var v=x.utils;x.watch=function(u){function g(){}function c(b,c,f,t,w){w=w||{};w.method=b.toUpperCase();"credentials"in w||(w.credentials="same-origin");null!==f&&(v.isArr(f)||v.isObj(f)?(w.headers=w.headers||new Headers,w.headers.set("Content-Type","application/json"),w.body=JSON.stringify(f)):w.body=""+f);var C=t,B=g;t instanceof Array&&(C=t[0],t[1]&&(B=t[1]));var h={type:"fetch",fetch:{method:b,url:c,body:f}};t=fetch(c,w).then(function(b){if(200<=b.status&&300>b.status)return b;var c=
Error(b.status+": "+b.statusText);c.data=b;return Promise.reject(c)}).then(function(b){switch(b.headers.get("Content-Type").split("; ")[0]){case "application/json":return b.json();case "text/plain":return b.text();default:return b}}).then(C,B).then(function(b){!1!==b&&p.fire(h);return b},function(b){h.error=b;p.fire(h);return b});t._fetchArgs=[b,c,f,[C,B],w];return t}var f=[];v.isFunc(u)&&f.push(u);var p={on:function(b){f.push(b);return p},off:function(b){f.splice(f.indexOf(b),1);return p},fire:v.raft(function(b){v.execAll(f,
b);return p}),prop:function(b,f){var z=b,t=function(b,c,h){if(arguments.length&&b!==z){var f=z;z=b;h=h||{type:"prop",prop:t,data:{old:f,"new":b}};v.isFunc(c)?c(h):!1!==c&&p.fire(h)}return z};t._prop=!0;if(f&&f.then){t.update=g;if(f._fetchArgs){var w=f._fetchArgs[3];f._fetchArgs[3]=[function(b){return t(w[0]?w[0](b):b)},w[1]];t.update=function(){c.apply(null,f._fetchArgs)}}f.then(t)}return t.toString=t},sync:function(b,c,f){var t=b,g=c;v.isFunc(t)||(t=function(c,f,h){if("string"==typeof b){var m,n;
"e."==b.substr(0,2)?(m=c,n=b.substr(2)):(m=c.target,n=b)}return v.deepGet(m,n)});v.isArr(g)&&(g=function(b,f,h){var m=v.deepGet(c[0],c[1]);b!==m&&(v.deepSet(c[0],c[1],b),v.isFunc(f)?f(h):!1!==f&&p.fire(h))});return function(b,c,h){var m={type:"sync",vm:h,node:c,event:b};g(t(b,c,h),f,m)}},fetch:c,get:function(b,f,g){g?b+=p.query(f):g=f;return c("get",b,null,g)},"delete":function(b,f,g){g?b+=p.query(f):g=f;return c("delete",b,null,g)},post:function(b,f,g){return c("post",b,f,g)},put:function(b,f,g){return c("put",
b,f,g)},patch:function(b,f,g){return c("patch",b,f,g)},query:function(b){if(!v.isObj(b))return"";var c=[],f=encodeURIComponent,g;for(g in b)c.push(f(g)+"="+f(b[g]));return c.length?"?"+c.join("&"):""}};return p}})(domvm);(function(x){function v(b,c,f,g,p,v){var u=null,h=null,m=null;if("/"==f[0]){m=f;h=!1;g={};v=m.split("#");c=v[0].split("?");u=c[0];v=v[1];c[1]&&(p={},c[1].split("&").map(function(b){b=b.split("=");p[b[0]]=null==b[1]?!0:b[1]}));var H,x;for(x in b){f=b[x];var D=f.path;if(H=u.match(f.regexPath)){h=x;-1!==D.indexOf(":")&&(g={},H.shift(),D.replace(/:([^\/]+)/g,function(b,c){g[c]=H.shift()}));break}}}else{h=f;f=b[h];var D=c+f.path,I=f.vars||{},K=/^[^\/]+$/,m=-1!==D.indexOf(":")?u=D.replace(/:([^\/]+)/g,
function(b,c){if((I[c]||K).test(g[c]))return g[c]+="";throw Error("Invalid value for route '"+D+"' segment '"+c+"': '"+g[c]+"'");}):u=D;if(p){var m=m+"?",E;for(E in p)m+=E+(!0!==p[E]?"="+p[E]:"")+"&";m=m.slice(0,-1)}m+=v?"#"+v:""}return{href:m,name:h,path:u,segs:g,hash:v,query:p}}function u(b,c){for(var f in b){var g=b[f];g.regexPath=new RegExp("^"+c+g.path.replace(/:([^\/]+)/g,function(b,c){var f=""+g.vars[c];return"("+f.substring(1,f.lastIndexOf("/"))+")"})+"$")}}var g=[],c=null,f=!1,p="";x.route=
function(b,n){function x(){var b=location,b=f?b.href.substr(b.origin.length):b.hash.substr(1)||"/";return v(B,p,b)}var t=null,w={href:function(b,c,g,n,t){var u=v(B,p,b,c,g,n);return f?(b=function(b){w["goto"](u,null,null,null,t);b.preventDefault()},b.href=u.href,b):"#"+u.href},config:function(b){(f=b.useHist)&&(p=b.root||"");t=b.init||null},refresh:function(){w["goto"](x(),null,null,null,!0)},"goto":function(b,m,n,t,u){u=u||C;b.href||(b=v(B,p,b,m,n,t));if(!1===b.name)console.log("Could not find route");
else{m=null;for(n=0;n<g.length;n++)if(g[n].href===b.href){m=n;break}null===m&&(g.splice(c+1,1E4),g.push(b),m=g.length-1);b=g[c];n=g[m];t=!0;null!==c&&(t=(t=B[b.name].onexit)?t.apply(null,(b?[b.segs,b.query,b.hash]:[]).concat(n)):!0);if(!1!==t&&!1!==B[n.name].onenter.apply(null,(n?[n.segs,n.query,n.hash]:[]).concat(b))){if(f)history[u?"replaceState":"pushState"](null,"title",n.href);c=m}C=!1}},location:function(){return C?x():g[c]}},C=!0,B=b(w,n);u(B,p);window.onhashchange=window.onpopstate=function(b){(f||
"popstate"!=b.type)&&w["goto"](x(),null,null,null,!0)};t&&t();return w}})(domvm);
