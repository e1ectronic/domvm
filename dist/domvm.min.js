/*
 https://github.com/leeoniya/domvm (1.x-dev)
*/
("undefined"!==typeof global?global:this).domvm={};(function(x){var t=("undefined"==typeof window?{}:window).requestAnimationFrame,r={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},k={TYPE_ELEM:1,
TYPE_TEXT:2,isArr:function(c){return c instanceof Array},isVal:function(c){c=typeof c;return"string"===c||"number"===c},isObj:function(c){return"object"===typeof c&&null!==c&&!k.isArr(c)},isFunc:function(c){return"function"===typeof c},isProm:function(c){return"object"===typeof c&&k.isFunc(c.then)},execAll:function(c,f,n,b,g,C){var p;c&&(k.isArr(c)?c:[c]).forEach(function(c){p=c.call(null,f,n,b,g,C)});return p},tick:function(c,f){f&&t?t&&t(function(){k.tick(c,f-1)}):k.isArr(c)?c[0].apply(null,c.slice(1)):
c()},insertArr:function(c,f,n,b){c.splice.apply(c,[n,b].concat(f))},isEvProp:function(c){return"on"===c.substr(0,2)},isDynProp:function(c,f){switch(c){case "input":case "textarea":case "select":case "option":switch(f){case "value":case "checked":case "selected":case "selectedIndex":return!0}}},camelDash:function(c){return c.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},autoPx:function(c,f){return isNaN(f)||r[c]?f:f+"px"},deepSet:function(c,f,n){f=f.split(".");var b=f.pop();f.forEach(function(b){c[b]||
(c[b]={});c=c[b]});c[b]=n},deepGet:function(c,f){var n=f.split(".");do c=c[n.shift()];while(n.length);return c},keyedIdx:function(c,f,n,b,g){for(b=0;b<f.length;b++)if(g=f[b],g.key===c)if(n){if(g.vm&&g.vm.view[0]===n)return b}else return b;return-1},raft:function(c){function f(){n=0;c.apply(b,g)}if(!t)return c;var n,b,g;return function(){b=this;g=arguments;n||(n=t(f))}}};x.utils=k})(domvm);(function(x){function t(){for(var a;a=L.pop();)a[0].apply(null,a.slice(1))}function r(a,d){return!1===d?null:null==d&&null!=a?a:l.isVal(d)||l.isObj(d)||l.isArr(d)||l.isFunc(d)?d:null}function k(a,d,z,b,e,q){function v(a,d,e){if(e)a[d]=a[d]||[],a[d].push(e);else for(var c in d)a[c]=a[c]||[],a[c].push(d[c])}function m(a,d,c){e=a;q=d;u.update(c,!1);return w(0,!1)}function k(a){return null==a?"":a}function w(a,c){if(a){for(var b=u;a--&&b.parent;)b=b.parent;b.redraw(0,!0);return b.vm}(b=u.node)&&f(u,"willRedraw",
u);u.refs={};var y=u.render.call(u.api,u,d,z),y=g(y,e,q,u);y.vm=u;u.node=y;var m=l.isVal(z)&&"^"===z[0]?z.substr(1):l.isVal(y.ref)&&"^"===y.ref[0]?y.ref.substr(1):null;y.key=null!=z?z:y.key;for(var v=e;v;)v.vm&&(u.parent||(u.parent=v.vm),null!==m&&l.deepSet(v.vm.refs,m,y)),v=v.parent;if((m=b)&&(y.type!==b.type||y.tag!==b.tag))var m=null,h=!0,k=b.el.parentNode;C(y,m);e&&(e.body[q]=y);!1!==c&&(b&&n(b),!b&&B||p(y,null,y.el),h&&(k||y.parent.el).insertBefore(y.el,k.childNodes[b.idx]));b&&f(u,"didRedraw",
u);!1!==c&&l.tick(t,2);return u}var B=!e;l.isArr(a)&&(d=a[1],z=a[2],b=a[3],a=a[0]);z=r(d,z);var u={api:{},node:null,view:[a,z],model:d,opts:b||{},render:null,update:function(a,e){null==a||z===d&&!l.isVal(z)||(d=u.model=a);return!1!==e?w(0):u},on:function(a,d){v(u.events,a,d)},hook:function(a,d){u.hooks=u.hooks||{};v(u.hooks,a,d)},events:{},hooks:null,redraw:I.useRaf?l.raft(w):w,patch:function(a,d){var e=null!=a.el;if(l.isObj(d)){var b="class"in d?(k(a["class"])+" "+k(d["class"])).trim():a.props["class"],
c="style"in d?d.style:a.props.style;e&&(e=Object.create(a.props),e["class"]=b,e.style=c,e={tag:a.tag,el:a.el,ns:a.ns,props:e},h(e,a));a.props["class"]=b;a.props.style=c}else b=a.parent,e=C(g(d,b,a.idx,u),a),b.body[a.idx]=e},emit:function(a){for(var d=Array.prototype.slice.call(arguments),e=u,b;e;){if(b=e.events[a]){d[0]=b;l.execAll.apply(null,d);break}e=e.parent}},refs:{},parent:null,mount:function(a,d){var e=null;d&&(a.textContent="",e=a,a=null);p(u.node,e,null,a);return u},attach:function(a){c(u.node,
a);return u},unmount:function(){n(u.node)},moveTo:m,updIdx:function(a){q=a}};b&&b.hooks&&u.hook(b.hooks);l.execAll(G,u);u.render=a.call(u.api,u,d,z);return e?m(e,q):w(0)}function c(a,d){a.el=d;d._node=a;for(var b in a.props){var y=a.props[b],e=l.isEvProp(b)?b:"."===b[0]?b.substr(1):null;null!==e&&(d[e]=y)}if(l.isArr(a.body))for(b=0;b<a.body.length;b++)c(a.body[b],d.childNodes[b])}function f(a,d,b,c,e,g){if(a&&a.hooks&&(a=a.hooks[d]))if(I.useRaf&&"did"==d.substr(0,3))L.push([l.execAll,a,b,c,e,g]);
else return l.execAll(a,b,c,e,g)}function n(a,d){var c=a.el&&!a.moved;if(c){var y=f(a.vm,"willUnmount",a.vm),e=f(a,"willRemove",a),g=y||e;a.removed=!0}l.isArr(a.body)&&a.body.forEach(function(a,e){n(a,d||g)});d||(g?g.then(function(){b(a,c)}):b(a,c))}function b(a,d){null!=a.el&&a.el.parentNode&&(d&&(a.el.parentNode.removeChild(a.el),a.el=null,f(a.vm,"didUnmount",a.vm),f(a,"didRemove",a)),l.isArr(a.body)&&a.body.forEach(function(a,d){b(a,!0)}),a.vm=a.body=null)}function g(a,d,b,c){var e=a;a={type:null,
key:null,ref:null,idx:null,parent:null,moved:!1,removed:!1,hooks:null,tag:null,"class":null,ns:null,guard:!1,raw:!1,props:null,el:null,hasKeys:!1,body:null};l.isFunc(e)&&(e=e());if(l.isArr(e)&&e.length){a.type=l.TYPE_ELEM;if(1<e.length){var h=1;l.isObj(e[1])&&(a.props=e[1],h=2);a.body=e.length==h+1?l.isVal(e[h])?e[h]:l.isFunc(e[h])?e[h]():e.slice(h):e.slice(h)}a.tag=e[0];A(a);if(a.props){var e=a.props,v;for(v in e)l.isEvProp(v)?e[v]=q(e[v],c.opts.evctx||c.model||null,a,c):l.isFunc(e[v])&&("href"==
v?(e.onclick=e[v],e.href=e[v].href):e[v]=e[v]()),l.isDynProp(a.tag,v)&&(e["."+v]=e[v]);if(l.isObj(e.style))for(var m in e.style)v=e.style[m],l.isFunc(v)&&(e.style[m]=v());l.isObj(e._hooks)&&(a.hooks=e._hooks,e._hooks=null);a.key=l.isVal(e._key)?e._key:l.isVal(e._ref)?e._ref:l.isVal(e.id)?e.id:l.isVal(e.name)?e.name:null;null!=e._ref&&(a.ref=e._ref);e._raw&&(a.raw=!0);null!=e._data&&(a.data=e._data);e._guard&&(a.guard=!0);e._ref=e._key=e._raw=e._data=e._guard=null}}else l.isVal(e)&&(a.type=l.TYPE_TEXT,
a.body=e);null!==a.ref&&l.deepSet(c.refs,a.ref,a);a.parent=d;a.idx=b;a.ns=d&&d.ns?d.ns:"svg"===a.tag||"math"===a.tag?a.tag:null;if(l.isArr(a.body))for(d=0,b=a.body.length;d<b;d++){m=a.body[d];var e=v=null,f=h=!1;l.isFunc(m)&&(m=m());if(null==m)h=!0;else{var C=l.isArr(m),n=C?!1:l.isObj(m);if(C)m.length?"string"==typeof m[0]&&""!==m[0]?(e=g(m,a,d,c),v=e.key):l.isFunc(m[0])?v=r(m[1],m[2]):f=!0:h=!0;else if(n)if(l.isFunc(m.redraw))m.moveTo(a,d),e=m.node,v=m.view[1];else{a.body[d--]=""+m;continue}else""===
m?h=!0:0<d&&a.body[d-1].type===l.TYPE_TEXT?(a.body[d-1].body+=""+m,h=!0):e=g(""+m,a,d,c)}h||f?(f?l.insertArr(a.body,m,d,1):a.body.splice(d,1),b=a.body.length,d--):(null!==v&&(a.hasKeys=!0),a.body[d]=e||m)}return a}function C(a,d){d&&(f(a,"willRecycle",d,a),B(d,a),f(a,"didRecycle",d,a));if(l.isArr(a.body)){var b=0;a.body.forEach(function(c,e){var h=l.isArr(c);if(d){var g=w(c,a,d,b);if(null!==g){var m=g[0],g=g[1];m===b&&b++;m=d.body[m];m.vm?h?2===g?m.vm.moveTo(a,e,c[1]):1===g&&k(c[0],c[1],c[2],c[3],
a,e):c.vm&&2===g&&c.vm===m.vm&&m.vm.moveTo(a,e):a.body[e]=C(c,m);return}}h?k(c[0],c[1],c[2],c[3],a,e):a.body[e]=C(c)})}return a}function p(a,d,b,c){for(var e=!a.el;b&&b._node.removed;)b=b.nextSibling;e&&f(a.vm,"willMount",a.vm);if(a.type==l.TYPE_ELEM)if(e&&(a.el=d||(a.ns?J.createElementNS(E[a.ns],a.tag):J.createElement(a.tag)),a.props&&h(a)),l.isArr(a.body)){d=0;for(var g=a.el.firstChild;d<a.body.length;d++)g=p(a.body[d],null,g)}else l.isVal(a.body)&&(a.raw?a.el.innerHTML=a.body:e&&(a.el.textContent=
a.body));else a.type==l.TYPE_TEXT&&e&&(a.el=J.createTextNode(a.body));a.el._node=a;d=a.parent;b!==a.el&&(c||d&&d.el)&&(d=e?"Insert":"Reinsert",f(a,"will"+d,a),(c||a.parent.el).insertBefore(a.el,b),f(a,"did"+d,a));e&&a.vm&&a.vm.hooks&&!a.moved&&f(a.vm,"didMount",a.vm);return b!==a.el?b:b.nextSibling}function w(a,d,b,c,e){var g=l.isArr(a),h=g?r(a[1],a[2]):a.key,m=b.hasKeys,q=d.hasKeys;b=b.body;d=d.body;if(null!==h&&m)return a=l.keyedIdx(h,b,g?a[0]:null),-1<a?[a,2]:null;c=c||0;if(c>b.length-1)return null;
e=0===e?0:e||b.length-1;for(h=null;c<=e;c++)if(m=b[c],null!==m&&m.el)if(g&&m.vm){if(m.vm.view[0]===a[0]){if(m.vm.view[1]===r(a[1],a[2]))return[c,2];!h&&q&&-1==l.keyedIdx(m.key,d,m.vm.view[0])&&(h=[c,1])}}else if(a.type===m.type&&(a.type===l.TYPE_TEXT||null!==a.tag&&a.tag===m.tag)&&(null===m.key||!q||-1==l.keyedIdx(m.key,d,m.vm?m.vm.view[0]:null)))return[c,1];return h}function B(a,d){d.el=a.el;a.el=null;d.el&&(d.el._node=d);if(d.type===l.TYPE_TEXT&&d.body!==a.body)d.el.nodeValue=d.body;else{h(d,a);
var b=!l.isArr(d.body),c=!l.isArr(a.body);b&&d.body!==a.body?c&&d.el.firstChild?d.el.firstChild.nodeValue=d.body:d.raw?d.el.innerHTML=d.body:d.el.textContent=d.body:c&&!b&&(d.el.textContent="");a.moved=!0}}function A(a){/[.#]/.test(a.tag)&&(a.tag=a.tag.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(d,b,c,e){e&&(e=e.replace(/\./g," ").trim());if(c||e)d=a.props||{},c&&null==d.id&&(d.id=c),e&&(a["class"]=e,d["class"]=e+(null!=d["class"]?" "+d["class"]:"")),a.props=d;return b||"div"}))}
function q(a,d,b,c){return function(b){var g,h=b.target._node,m=null;if(l.isFunc(a))g=a.call(d,b,h,c);else if(l.isArr(a))m=a.slice(1),g=a[0].apply(d,m.concat(b,h,c));else if(l.isObj(a))for(var q in a){var f=a[q];b.target.matches(q)&&(l.isArr(f)?(m=f.slice(1),g=f[0].apply(d,m.concat(b,h,c))):l.isFunc(f)&&(g=f.call(d,b,h,c)))}!1===g&&(b.preventDefault(),b.stopPropagation());c.opts.hasOwnProperty("watch")&&c.opts.watch.fire({type:"event",vm:c,node:h,event:b,data:m})}}function h(a,d){var b=!d;d=d||{};
if(d.props||a.props){var c=d.props||{},e=a.props||{},g=c.style,h=e.style;if(l.isObj(g)||l.isObj(h))F(a.el,a.tag,g||{},h||{},M,D,a.ns,b),c.style=e.style=null;F(a.el,a.tag,c,e,K,H,a.ns,b);h&&(e.style=h)}}function F(a,b,c,h,e,g,l,m){for(var q in h)null!==h[q]&&("."===q[0]?a[q.substr(1)]!==h[q]:h[q]!==c[q])&&e(a,q,h[q],l,m);for(q in c)null!==c[q]&&null==h[q]&&g(a,q,l,m)}function M(a,b,c){a.style[b]=l.autoPx(b,c)}function D(a,b){a.style[b]=""}function K(a,b,c,h,e){"."===b[0]?(b=b.substr(1),"svg"===h?a[b].baseVal=
c:a[b]=c):"class"===b?a.className=c:"id"===b||l.isEvProp(b)?a[b]=c:!1===c?H(a,b,h,e):a.setAttribute(b,!0===c?"":c)}function H(a,b,c,h){h||("."===b[0]?(b=b.substr(1),"svg"===c?a[b].baseVal=null:a[b]=null):"class"===b?a.className="":"id"===b||l.isEvProp(b)?a[b]=null:a.removeAttribute(b))}var E={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},J="undefined"==typeof document?{}:document,L=[],I={useRaf:!0};x.view=k;x.view.config=function(a){I=a};var G=null;x.view.extend=function(a,
b){G=!G||b?[]:G;G.push(a)};var l=x.utils;return x})(domvm);(function(x){var t=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,r=x.utils;x.html=function(k){var c="";switch(k.type){case r.TYPE_ELEM:c+="<"+k.tag;if(k.props){var f=r.isVal(k.props.style)?k.props.style:"",n=r.isObj(k.props.style)?k.props.style:null;if(n)for(var b in n)null!==n[b]&&(f+=r.camelDash(b)+": "+r.autoPx(b,n[b])+"; ");for(b in k.props)r.isEvProp(b)||"."===b[0]||(n=k.props[b],r.isFunc(n)&&(n=n()),r.isObj(n)||(!0===n?c+=" "+b:!1!==n&&null!==n&&
"."!==b[0]&&(c+=" "+b+'="'+n+'"')));f.length&&(c+=' style="'+f.trim()+'"')}if(k.ns&&"svg"!==k.tag&&"math"!==k.tag&&!k.body)return c+"/>";c+=">";break;case r.TYPE_TEXT:return k.body}t.test(k.tag)||(r.isArr(k.body)?k.body.forEach(function(b){c+=x.html(b)}):c+=k.body||"",c+="</"+k.tag+">");return c}})(domvm);(function(x){var t=x.utils;x.watch=function(r){function k(){}function c(b,c,f,p,w){w=w||{};w.method=b.toUpperCase();"credentials"in w||(w.credentials="same-origin");null!==f&&(t.isArr(f)||t.isObj(f)?(w.headers=w.headers||new Headers,w.headers.set("Content-Type","application/json"),w.body=JSON.stringify(f)):w.body=""+f);var B=p,A=k;p instanceof Array&&(B=p[0],p[1]&&(A=p[1]));var q={type:"fetch",fetch:{method:b,url:c,body:f}};p=fetch(c,w).then(function(b){if(200<=b.status&&300>b.status)return b;var c=
Error(b.status+": "+b.statusText);c.data=b;return Promise.reject(c)}).then(function(b){switch(b.headers.get("Content-Type").split("; ")[0]){case "application/json":return b.json();case "text/plain":return b.text();default:return b}}).then(B,A).then(function(b){!1!==b&&n.fire(q);return b},function(b){q.error=b;n.fire(q);return b});p._fetchArgs=[b,c,f,[B,A],w];return p}var f=[];t.isFunc(r)&&f.push(r);var n={on:function(b){f.push(b);return n},off:function(b){f.splice(f.indexOf(b),1);return n},fire:t.raft(function(b){t.execAll(f,
b);return n}),prop:function(b,g){var f=b,p=function(b,c,g){if(arguments.length&&b!==f){var h=f;f=b;g=g||{type:"prop",prop:p,data:{old:h,"new":b}};t.isFunc(c)?c(g):!1!==c&&n.fire(g)}return f};p._prop=!0;if(g&&g.then){p.update=k;if(g._fetchArgs){var w=g._fetchArgs[3];g._fetchArgs[3]=[function(b){return p(w[0]?w[0](b):b)},w[1]];p.update=function(){c.apply(null,g._fetchArgs)}}g.then(p)}return p.toString=p},sync:function(b,c,f){var p=b,k=c;t.isFunc(p)||(p=function(c,g,f){if("string"==typeof b){var h,k;
"e."==b.substr(0,2)?(h=c,k=b.substr(2)):(h=c.target,k=b)}return t.deepGet(h,k)});t.isArr(k)&&(k=function(b,f,q){var h=t.deepGet(c[0],c[1]);b!==h&&(t.deepSet(c[0],c[1],b),t.isFunc(f)?f(q):!1!==f&&n.fire(q))});return function(b,c,g){var h={type:"sync",vm:g,node:c,event:b};k(p(b,c,g),f,h)}},fetch:c,get:function(b,g,f){f?b+=n.query(g):f=g;return c("get",b,null,f)},"delete":function(b,g,f){f?b+=n.query(g):f=g;return c("delete",b,null,f)},post:function(b,f,k){return c("post",b,f,k)},put:function(b,f,k){return c("put",
b,f,k)},patch:function(b,f,k){return c("patch",b,f,k)},query:function(b){if(!t.isObj(b))return"";var c=[],f=encodeURIComponent,k;for(k in b)c.push(f(k)+"="+f(b[k]));return c.length?"?"+c.join("&"):""}};return n}})(domvm);(function(x){function t(b,c,f,k,n,t){var r=null,q=null,h=null;if("/"==f[0]){h=f;q=!1;k={};t=h.split("#");c=t[0].split("?");r=c[0];t=t[1];c[1]&&(n={},c[1].split("&").map(function(b){b=b.split("=");n[b[0]]=null==b[1]?!0:b[1]}));var F,x;for(x in b){f=b[x];var D=f.path;if(F=r.match(f.regexPath)){q=x;-1!==D.indexOf(":")&&(k={},F.shift(),D.replace(/:([^\/]+)/g,function(b,c){k[c]=F.shift()}));break}}}else{q=f;f=b[q];var D=c+f.path,K=f.vars||{},H=/^[^\/]+$/,h=-1!==D.indexOf(":")?r=D.replace(/:([^\/]+)/g,
function(b,c){if((K[c]||H).test(k[c]))return k[c]+="";throw Error("Invalid value for route '"+D+"' segment '"+c+"': '"+k[c]+"'");}):r=D;if(n){var h=h+"?",E;for(E in n)h+=E+(!0!==n[E]?"="+n[E]:"")+"&";h=h.slice(0,-1)}h+=t?"#"+t:""}return{href:h,name:q,path:r,segs:k,hash:t,query:n}}function r(b,c){for(var f in b){var k=b[f];k.regexPath=new RegExp("^"+c+k.path.replace(/:([^\/]+)/g,function(b,c){var f=""+k.vars[c];return"("+f.substring(1,f.lastIndexOf("/"))+")"})+"$")}}var k=[],c=null,f=!1,n="";x.route=
function(b,g){function x(){var b=location,b=f?b.href.substr(b.origin.length):b.hash.substr(1)||"/";return t(A,n,b)}var p=null,w={href:function(b,c,k,g,p){var r=t(A,n,b,c,k,g);return f?(b=function(b){w["goto"](r,null,null,null,p);b.preventDefault()},b.href=r.href,b):"#"+r.href},config:function(b){(f=b.useHist)&&(n=b.root||"");p=b.init||null},refresh:function(){w["goto"](x(),null,null,null,!0)},"goto":function(b,h,g,p,r){r=r||B;b.href||(b=t(A,n,b,h,g,p));if(!1===b.name)console.log("Could not find route");
else{h=null;for(g=0;g<k.length;g++)if(k[g].href===b.href){h=g;break}null===h&&(k.splice(c+1,1E4),k.push(b),h=k.length-1);b=k[c];g=k[h];p=!0;null!==c&&(p=(p=A[b.name].onexit)?p.apply(null,(b?[b.segs,b.query,b.hash]:[]).concat(g)):!0);if(!1!==p&&!1!==A[g.name].onenter.apply(null,(g?[g.segs,g.query,g.hash]:[]).concat(b))){if(f)history[r?"replaceState":"pushState"](null,"title",g.href);c=h}B=!1}},location:function(){return B?x():k[c]}},B=!0,A=b(w,g);r(A,n);window.onhashchange=window.onpopstate=function(b){(f||
"popstate"!=b.type)&&w["goto"](x(),null,null,null,!0)};p&&p();return w}})(domvm);
