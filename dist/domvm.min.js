// https://github.com/leeoniya/domvm
("object"===typeof module&&"object"===typeof module.exports&&function(q){module.exports=q()}||"function"===typeof define&&function(q){define("domvm",q)}||function(q){window.domvm=q()})(function(){return{}});(function(q){var w="undefined"==typeof window?{}:window,n={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(e){return e instanceof Array},isVal:function(e){e=typeof e;return"string"===e||"number"===e},isObj:function(e){return"object"===typeof e&&null!==e&&!n.isArr(e)},isFunc:function(e){return"function"===typeof e},execAll:function(e,g){e.forEach(function(e){return e.apply(null,g)})},insertArr:function(e,g,l,b){e.splice.apply(e,[l,b].concat(g))},isEvProp:function(e){return"on"===e.substr(0,2)},camelDash:function(e){return e.replace(/([a-z])([A-Z])/g,
"$1-$2").toLowerCase()},raft:function(e){function g(){l=0;e.apply(b,f)}if(!w.requestAnimationFrame)return e;var l,b,f;return function(){b=this;f=arguments;l||(l=w.requestAnimationFrame(g))}}};domvm.util=n})(domvm);(function(q){function w(a,d,h,A,c,u,z){function k(a,d,c){u=a;z=d;return f(c,!1)}function f(a,c){m.execAll(p.events.willRedraw);p.imp=null!=a?a:A;p.refs={};var k=p.node,v=p.render.call(d,p.imp),v=g(v,u,z,p);v.key=m.isVal(h)?h:v.key;v.vm=p;p.node=v;var t=k;if(k&&(v.type!==k.type||v.tag!==k.tag))var t=null,n=!0;l(v,t);u&&(u.body[z]=v);!1!==c&&(k&&e(k),!k&&r||b(v),n&&(k.el.parentNode.replaceChild(v.el,k.el),k.el=null));setTimeout(function(){var a=p,c;for(c in a.refs)a.refs[c]=a.refs[c].el;m.execAll(p.events.didRedraw)},
0);return p}function t(a){var c=null,d=a.split(":");2==d.length&&(a=d[0],c=+d[1]);var d=Array.prototype.slice.call(arguments,1),h=p.node;if(null!==c){for(;c&&h.parent;)h=h.parent,h.vm&&c--;(c=(c=h.vm?h.vm.events:null)?c[a]:null)&&c.apply(null,d)}else for(;h&&(!h.vm||!(c=(c=h.vm.events)?c[a]:null)||!1!==c.apply(null,d));)h=h.parent}var r=!u;m.isArr(a)&&(d=a[1],h=a[2],A=a[3],a=a[0]);!1===h&&(A=d,h=d=null);var p={exp:{},imp:A||{},node:null,view:[a,d,h],render:null,on:function(a,c){if(c)p.events[a].push(c);
else for(var d in a)p.events[d].push(a[d])},events:{willRedraw:[],didRedraw:[],willDestroy:[],didDestroy:[]},redraw:B.useRaf?m.raft(f):f,patch:function(a,c){var d=a.parent,h=l(g(c,d,a.idx,p),a);d.body[a.idx]=h;var k=h.key;m.isVal(k)&&(d.keyMap[k]=h)},emit:t,refs:{},mount:function(a){b(p.node);a.insertBefore(p.node.el,null);return p},attach:function(a){n(p.node,a);return p},destroy:function(a){m.execAll(p.events.willDestroy);if(u)if(a){for(a=z+1;a<u.body.length;a++){var c=u.body[a];c.idx=a-1;c.vm&&
c.vm.updIdx(c.idx)}u.body.splice(z,1)}else u.body[z]=null;e(p.node,!0);p.node.vm=null;m.execAll(p.events.didDestroy)},moveTo:k,updIdx:function(a){z=a}};p.events._redraw=p.redraw;p.render=a.call(p.exp,p,d,h,A);t.redraw=function(a){a=m.isVal(a)?a:1E3;t("_redraw:"+a)};return u?k(u,z,A):f(A)}function n(a,d){a.el=d;if(m.isArr(a.body))for(var h=0;h<a.body.length;h++)n(a.body[h],d.childNodes[h])}function e(a,d){m.isArr(a.body)&&(a.body.forEach(function(a,d){a&&(a.vm&&!a.moved?a.vm.destroy():a.el&&a.el.parentNode?
a.el.parentNode.removeChild(a.el):e(a))}),a.body=null);a.vm=null;d&&a.el&&(a.el.parentNode.removeChild(a.el),a.el=null)}function g(a,d,h,e){var c=a;a={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,keyMap:null,body:null};m.isFunc(c)&&(c=c());if(m.isArr(c)&&c.length){a.type=m.TYPE_ELEM;if(1<c.length){var b=1;m.isObj(c[1])&&(a.props=c[1],b=2);a.body=c.length==b+1?m.isVal(c[b])?c[b]:m.isFunc(c[b])?c[b]():c.slice(b):c.slice(b)}c=c[0];if(/[.#]/.test(c)){if(c=
t(c),a.tag=c.tag,c.id||c["class"])a.props=a.props||{},a.props.id=c.id,a.props["class"]=c["class"]}else a.tag=c;if(a.props){var c=a.props,f;for(f in c)m.isEvProp(f)?c[f]=C(c[f],e.view[1]||null):m.isFunc(c[f])&&("href"==f?(c.onclick=c[f],c.href=c[f].url):c[f]=c[f]());if(m.isObj(c.style))for(var k in c.style)f=c.style[k],m.isFunc(f)&&(c.style[k]=f());a.key=m.isVal(c._key)?c._key:m.isVal(c._ref)?c._ref:m.isVal(c.id)?c.id:m.isVal(c.name)?c.name:null;c._ref&&(a.ref=c._ref);c._raw&&(a.raw=!0);c._guard&&
(a.guard=!0);c._ref=c._key=c._raw=c._guard=null}}else m.isVal(c)&&(a.type=m.TYPE_TEXT,a.body=c);null!==a.ref&&(e.refs[a.ref]=a);a.parent=d;a.idx=h;a.ns=d&&d.ns?d.ns:"svg"===a.tag||"math"===a.tag?a.tag:null;if(m.isArr(a.body)){d={};h=!1;k=0;for(f=a.body.length;k<f;k++){var c=a.body[k],l=b=null,n=!1,r=!1;m.isFunc(c)&&(c=c());if(null==c)n=!0;else{var p=m.isArr(c),q=p?!1:m.isObj(c);if(p)c.length?m.isArr(c[0])?r=!0:m.isFunc(c[0])?b=c[2]:(l=g(c,a,k,e),b=l.key):n=!0;else if(q)if(m.isFunc(c.redraw))c.moveTo(a,
k),l=c.node,b=c.view[2];else{a.body[k--]=""+c;continue}else""===c?n=!0:0<k&&a.body[k-1].type===m.TYPE_TEXT?(a.body[k-1].body+=""+c,n=!0):l=g(""+c,a,k,e)}n||r?(r?m.insertArr(a.body,c,k,1):a.body.splice(k,1),f=a.body.length,k--):(m.isVal(b)&&(d[b]=k,h=!0),a.body[k]=l||c)}h&&(a.keyMap=d)}return a}function l(a,d){d&&r(d,a);m.isArr(a.body)&&a.body.forEach(function(h,b){var c=m.isArr(h);if(d){var e=f(h,a,d);if(null!==e){var g=e[1],e=d.body[e[0]];c&&e.vm?2===g?e.vm.moveTo(a,b,h[3]):1===g&&w(h[0],h[1],h[2],
h[3],h[4],a,b):a.body[b]=l(h,e);return}}c?w(h[0],h[1],h[2],h[3],h[4],a,b):a.body[b]=l(h)});return a}function b(a){var d=!a.el;a.type==m.TYPE_ELEM?(d&&(a.el=a.ns?D.createElementNS(H[a.ns],a.tag):D.createElement(a.tag),a.props&&F(a)),m.isArr(a.body)?a.body.forEach(b):d&&m.isVal(a.body)&&(a.raw?a.el.innerHTML=a.body:a.el.textContent=a.body)):a.type==m.TYPE_TEXT&&d&&(a.el=D.createTextNode(a.body));a.el._node=a;(d=a.parent)&&d.el&&d.el.childNodes[a.idx]!==a.el&&d.el.insertBefore(a.el,d.el.childNodes[a.idx])}
function f(a,d,h,b,c){var e=m.isArr(a),f=e?a[2]||null:a.key,k=h.keyMap,g=d.keyMap;h=h.body;d=d.body;if(null!==f&&k&&m.isVal(k[f]))return[k[f],2];b=b||0;if(b>h.length-1)return null;c=0===c?0:c||h.length-1;for(f=null;b<=c;b++)if(k=h[b],null!==k&&k.el)if(e&&k.vm){if(k.vm.view[0]===a[0]){if(k.vm.view[1]===a[1])return[b,2];var l=!1;if(B.viewScan)for(var t=0;t<d.length;t++){var p=d[t];if(!p.el&&p.vm&&p.vm.view[0]===k.vm.view[0]&&p.vm.view[1]===k.vm.view[1]){l=!0;break}}l||f||!g||m.isVal(g[k.key])||(f=[b,
1])}}else if(!(a.type!==k.type||a.type!==m.TYPE_TEXT&&(null===a.tag||a.tag!==k.tag)||null!==k.key&&g&&m.isVal(g[k.key])))return[b,1];return f}function r(a,d){d.el=a.el;a.el=null;if(d.type===m.TYPE_TEXT&&d.body!==a.body)d.el.nodeValue=d.body;else{F(d,a);var h=!m.isArr(d.body),b=!m.isArr(a.body);h&&d.body!==a.body?b&&d.el.firstChild?d.el.firstChild.nodeValue=d.body:d.raw?d.el.innerHTML=d.body:d.el.textContent=d.body:b&&!h&&(d.el.textContent="");a.moved=!0}}function t(a){if(a in E)return E[a];var d=
{tag:null,id:null,"class":null};d.tag=a.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(a,b,c,e){c&&(d.id=c);e&&(d["class"]=e.replace(/\./g," ").trim());return b||"div"});return E[a]=d}function C(a,d){return function(h){var b;if(m.isFunc(a))b=a.call(d,h);else if(m.isObj(a))for(var c in a)h.target.matches(c)&&(b=a[c].call(d,h));!1===b&&(h.preventDefault(),h.stopPropagation())}}function F(a,d){var b=!d;d=d||{};if(d.props||a.props){var e=d.props||{},c=a.props||{},f=e.style,g=c.style;
if(m.isObj(f)||m.isObj(g))G(a.el,f||{},g||{},I,J,a.ns,b),e.style=c.style=null;G(a.el,e,c,x,y,a.ns,b);g&&(c.style=g)}}function G(a,d,b,e,c,f,g){for(var k in b)null!==b[k]&&(k in d&&b[k]===d[k]||e(a,k,b[k],f,g));for(k in d)null!==d[k]&&(k in b||c(a,k,f,g))}function I(a,d,b){a.style[d]=isNaN(b)||K[d]?b:b+"px"}function J(a,d){a.style[d]=""}function x(a,d,b,e,c){"."===d[0]?(d=d.substr(1),"svg"===e?a[d].baseVal=b:a[d]=b):"class"===d?a.className=b:"id"===d||m.isEvProp(d)?a[d]=b:!1===b?y(a,d,e,c):(!0===b&&
(b=""),a.setAttribute(d,b))}function y(a,d,b,e){e||("."===d[0]?(d=d.substr(1),"svg"===b?a[d].baseVal=null:a[d]=null):"class"===d?a.className="":"id"===d||m.isEvProp(d)?a[d]=null:a.removeAttribute(d))}var H={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},E={},D="undefined"==typeof document?{}:document,K={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,
"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},B={useRaf:!0,viewScan:!1,useDOM:!1};q.view=w;q.config=function(a){B=a};var m=q.util;return q})(domvm);(function(q){var w=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,n=q.util;q.html=function(e){var g="";switch(e.type){case n.TYPE_ELEM:g+="<"+e.tag;if(e.props){var l=n.isVal(e.props.style)?e.props.style:"",b=n.isObj(e.props.style)?e.props.style:null;if(b)for(var f in b)null!==b[f]&&(l+=n.camelDash(f)+": "+b[f]+";");for(f in e.props)n.isEvProp(f)||(b=e.props[f],n.isFunc(b)&&(b=b()),n.isObj(b)||(!0===b?g+=" "+f:!1!==b&&null!==b&&"."!==f[0]&&(g+=" "+f+'="'+
b+'"')));l.length&&(g+=' style="'+l+'"')}if(e.ns&&"svg"!==e.tag&&"math"!==e.tag&&!e.body)return g+"/>";g+=">";break;case n.TYPE_TEXT:return e.body}w.test(e.tag)||(n.isArr(e.body)?e.body.forEach(function(b){g+=q.html(b)}):g+=e.body||"",g+="</"+e.tag+">");return g}})(domvm);(function(q){q.watch=function(q){function n(){}function e(e,l,b,f,r){r=r||{};r.method=(r.method||e).toUpperCase();null!==b&&(e=Object.prototype.toString.call(b),"[object Array]"===e||"[object Object]"===e?(r.headers=r.headers||new Headers,r.headers.set("Content-Type","application/json"),r.body=JSON.stringify(b)):r.body=""+b);b=f;e=n;f instanceof Array&&(b=f[0],f[1]&&(e=f[1]));return fetch(l,r).then(function(b){if(200<=b.status&&300>b.status)return b;var e=Error(b.statusText);e.resp=b;throw e;}).then(function(b){switch(b.headers.get("Content-Type").split("; ")[0]){case "application/json":return b.json();
case "text/plain":return b.text();default:return b}}).then(b,e).then(function(b){!1!==b&&q()},n)}return{prop:function(e){var l=e;return function(b,e){arguments.length&&b!==l&&(l=b,q&&!1!==e&&q());return l}},sync:function(e,l,b){var f=e,n=l;"string"==typeof e&&(f=function(b){return"e."===e.substr(0,2)?b[e.substr(2)]:b.target[e]});return function(e){var g=this!==window?this:null;g&&"string"==typeof l&&(n=function(b,e){var f=g[l];g[l]=b;q&&b!==f&&!1!==e&&q()});n(f(e),b)}},get:function(g,l,b){return e("get",
g,null,l,b)},"delete":function(g,l,b){return e("delete",g,null,l,b)},post:function(g,l,b,f){return e("post",g,l,b,f)},put:function(g,l,b,f){return e("put",g,l,b,f)},patch:function(g,l,b,f){return e("patch",g,l,b,f)}}}})(domvm);(function(q){q.route=function(q,n){function e(b,e){var f=t[b],g=C+f.url;if(e&&-1!==g.indexOf(":")){e=e.slice();var l=!0,g=g.replace(/:([^\/]+)/g,function(b,g){var n=e.shift();if(f.params&&f.params[g]){if((""+n).match(f.params[g]))return n;l=!1}else return n});return l?g:l}return g}var g=!0,l={href:function(){var b=arguments,f=function(e){l["goto"].apply(null,b);e.preventDefault()};f.url=e.apply(null,b);return f},"goto":function(l,n,q){n=n||[];q=q||g;var r=e(l,n);if(!1===r)console.log("Could not find route");
else{for(var x=null,y=0;y<f.length;y++)if(f[y].url===r){x=y;break}null===x&&(f.splice(b+1,1E4),f.push({name:l,route:t[l],params:n,url:r}),x=f.length-1);y=f[x];Array.prototype.slice.call(arguments);var w=!0;null!==b&&(w=f[b].route.onexit.call(null,f[x].params.concat(y)));!1!==w&&!1!==f[x].route.onenter.apply(null,n.concat(f[b]))&&(history[q?"replaceState":"pushState"]([l,n],"title",r),b=x);g=!1}},current:function(){return f[b]}},b=null,f=[],r=q(l,n),t=r.routes,C=r.root||"/";window.onpopstate=function(b){l["goto"].apply(null,
b.state.concat(!0))};return l}})(domvm);
