/*
 https://github.com/leeoniya/domvm
*/
("undefined"!==typeof global?global:this).domvm={};(function(v){var z="undefined"==typeof window?{}:window,r={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},a={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(c){return c instanceof
Array},isVal:function(c){c=typeof c;return"string"===c||"number"===c},isObj:function(c){return"object"===typeof c&&null!==c&&!a.isArr(c)},isFunc:function(c){return"function"===typeof c},isProm:function(c){return"object"===typeof c&&a.isFunc(c.then)},execAll:function(c,w){c&&(a.isArr(c)?c:[c]).forEach(function(c){return c.apply(null,w)})},insertArr:function(c,a,m,f){c.splice.apply(c,[m,f].concat(a))},isEvProp:function(c){return"on"===c.substr(0,2)},isDynProp:function(c,a){switch(c){case "input":case "textarea":case "select":case "option":switch(a){case "value":case "checked":case "selected":case "selectedIndex":return!0}}},
camelDash:function(c){return c.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},autoPx:function(c,a){return isNaN(a)||r[c]?a:a+"px"},indexOfKey:function(c,a,m,f){for(m=0;m<a.length;m++)if(a[m].key===c)return m;return-1},raft:function(c){function a(){m=0;c.apply(f,y)}if(!z.requestAnimationFrame)return c;var m,f,y;return function(){f=this;y=arguments;m||(m=z.requestAnimationFrame(a))}}};v.util=a})(domvm);(function(v){function z(b,d){return!1===d?null:null==d&&null!=b?b:g.isVal(d)||g.isObj(d)||g.isArr(d)||g.isFunc(d)?d:null}function r(b,d,t,A,e,h){function B(b,d,e){if(e)b[d]=b[d]||[],b[d].push(e);else for(var h in d)b[h]=b[h]||[],b[h].push(d[h])}function D(b,d,t){e=b;h=d;n.update(t,!1);return p(0,!1)}function p(b,A){if(b){for(var D=n;b--&&D.parent;)D=D.parent;D.redraw(0,!0);return D.vm}var B=n.node;B&&n.hooks&&g.execAll(n.hooks.willRedraw);n.refs={};var a=n.render.call(n.api,n,d,t),a=m(a,e,h,n);a.vm=
n;n.node=a;var l=g.isVal(t)&&"^"===t[0]?t.substr(1):g.isVal(a.ref)&&"^"===a.ref[0]?a.ref.substr(1):null;a.key=g.isVal(t)?t:a.key;for(var E=e;E;)E.vm&&(n.parent||(n.parent=E.vm),null!==l&&(E.vm.refs[l]=a)),E=E.parent;!(l=B)||a.type===B.type&&a.tag===B.tag||(l=null,D=!0);f(a,l);e&&(e.body[h]=a);!1!==A&&(B&&c(B),!B&&k||y(a,null,a.el),D&&(B.el.parentNode.replaceChild(a.el,B.el),B.el=null));Promise.resolve().then(function(){B&&n.hooks&&g.execAll(n.hooks.didRedraw)});return n}function l(b){n.hooks&&g.execAll(n.hooks.willUnmount);
if(e)if(b){for(b=h+1;b<e.body.length;b++){var d=e.body[b];d.idx=b-1;d.vm&&d.vm.updIdx(d.idx)}e.body.splice(h,1)}else e.body[h]=null;c(n.node,!0);n.node.vm=null;n.hooks&&g.execAll(n.hooks.didUnmount)}var k=!e;g.isArr(b)&&(d=b[1],t=b[2],A=b[3],b=b[0]);t=z(d,t);var n={api:{},node:null,view:[b,t],model:d,opts:A||{},render:null,update:function(b,e){null==b||t===d&&!g.isVal(t)||(d=n.model=b);return!1!==e?p(0):n},on:function(b,d){B(n.events,b,d)},hook:function(b,d){n.hooks=n.hooks||{};B(n.hooks,b,d)},events:{},
hooks:null,redraw:J.useRaf?g.raft(p):p,patch:function(b,d){var e=b.parent,h=f(m(d,e,b.idx,n),b);e.body[b.idx]=h},emit:function(b){for(var d=Array.prototype.slice.call(arguments,1),e=n;e;){if(e.events[b]){g.execAll(e.events[b],d);break}e=e.parent}},refs:{},parent:null,mount:function(b,d){var e=null;d&&(b.textContent="",e=b,b=null);y(n.node,e,null,b);return n},attach:function(b){a(n.node,b);return n},unmount:function(){x(n.hooks,"Unmount",l,[])},moveTo:D,updIdx:function(b){h=b}};A&&A.hooks&&n.hook(A.hooks);
g.execAll(H,[n]);n.render=b.call(n.api,n,d,t);return e?D(e,h):p(0)}function a(b,d){b.el=d;d._node=b;for(var t in b.props){var A=b.props[t],e=g.isEvProp(t)?t:"."===t[0]?t.substr(1):null;null!==e&&(d[e]=A)}if(g.isArr(b.body))for(t=0;t<b.body.length;t++)a(b.body[t],d.childNodes[t])}function c(b,d){g.isArr(b.body)&&(b.body.forEach(function(b,d){b&&(b.vm&&!b.moved?b.vm.unmount():c(b,!0))}),b.body=null);b.vm=null;d&&b.el&&b.el.parentNode&&x(b.hooks,"Remove",w,[b])}function w(b){b.el.parentNode.removeChild(b.el);
b.el=null}function m(b,d,t,A){var e=b,h={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,hooks:null,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,hasKeys:!1,body:null};g.isFunc(e)&&(e=e());if(g.isArr(e)&&e.length){h.type=g.TYPE_ELEM;if(1<e.length){var c=1;g.isObj(e[1])&&(h.props=e[1],c=2);h.body=e.length==c+1?g.isVal(e[c])?e[c]:g.isFunc(e[c])?e[c]():e.slice(c):e.slice(c)}e=e[0];if(/[.#]/.test(e)){if(e=C(e),h.tag=e.tag,e.id||e["class"])h.props=h.props||{},h.props.id=e.id,h.props["class"]=
e["class"]}else h.tag=e;if(h.props){var e=h.props,a;for(a in e)g.isEvProp(a)?e[a]=p(e[a],A.opts.evctx||A.model||null,h,A):g.isFunc(e[a])&&("href"==a?(e.onclick=e[a],e.href=e[a].href):e[a]=e[a]()),g.isDynProp(h.tag,a)&&(e["."+a]=e[a]);if(g.isObj(e.style))for(var f in e.style)a=e.style[f],g.isFunc(a)&&(e.style[f]=a());g.isObj(e._hooks)&&(h.hooks=e._hooks,e._hooks=null);h.key=g.isVal(e._key)?e._key:g.isVal(e._ref)?e._ref:g.isVal(e.id)?e.id:g.isVal(e.name)?e.name:null;e._ref&&(h.ref=e._ref);e._raw&&(h.raw=
!0);e._data&&(h.data=e._data);e._guard&&(h.guard=!0);e._ref=e._key=e._raw=e._data=e._guard=null}}else g.isVal(e)&&(h.type=g.TYPE_TEXT,h.body=e);null!==h.ref&&(A.refs[h.ref]=h);h.parent=d;h.idx=t;h.ns=d&&d.ns?d.ns:"svg"===h.tag||"math"===h.tag?h.tag:null;if(g.isArr(h.body))for(d=0,t=h.body.length;d<t;d++){f=h.body[d];var e=a=null,l=c=!1;g.isFunc(f)&&(f=f());if(null==f)c=!0;else{var k=g.isArr(f),n=k?!1:g.isObj(f);if(k)f.length?g.isArr(f[0])?l=!0:g.isFunc(f[0])?a=z(b[1],b[2]):(e=m(f,h,d,A),a=e.key):
c=!0;else if(n)if(g.isFunc(f.redraw))f.moveTo(h,d),e=f.node,a=f.view[1];else{h.body[d--]=""+f;continue}else""===f?c=!0:0<d&&h.body[d-1].type===g.TYPE_TEXT?(h.body[d-1].body+=""+f,c=!0):e=m(""+f,h,d,A)}c||l?(l?g.insertArr(h.body,f,d,1):h.body.splice(d,1),t=h.body.length,d--):(null!==a&&(h.hasKeys=!0),h.body[d]=e||f)}return h}function f(b,d){d&&x(b.hooks,"Recycle",q,[d,b]);if(g.isArr(b.body)){var a=0;b.body.forEach(function(c,e){var h=g.isArr(c);if(d){var l=k(c,b,d,a);if(null!==l){var p=l[0],l=l[1];
p===a&&a++;p=d.body[p];h&&p.vm?2===l?p.vm.moveTo(b,e,c[1]):1===l&&r(c[0],c[1],c[2],c[3],b,e):b.body[e]=f(c,p);return}}h?r(c[0],c[1],c[2],c[3],b,e):b.body[e]=f(c)})}return b}function y(b,d,c,a){var e=!b.el;e&&b.vm&&b.vm.hooks&&g.execAll(b.vm.hooks.willMount);if(b.type==g.TYPE_ELEM)if(e&&(b.el=d||(b.ns?K.createElementNS(F[b.ns],b.tag):K.createElement(b.tag)),b.props&&l(b)),g.isArr(b.body)){d=0;for(var h=b.el.firstChild;d<b.body.length;d++)h=y(b.body[d],null,h)?h:h.nextSibling||null}else g.isVal(b.body)&&
(b.raw?b.el.innerHTML=b.body:e&&(b.el.textContent=b.body));else b.type==g.TYPE_TEXT&&e&&(b.el=K.createTextNode(b.body));d=!0;b.el._node=b;c===b.el&&(d=!1);h=b.parent;d&&(a||h&&h.el)&&(x(b.hooks,e?"Insert":"Reinsert",u,[b,c,a]),d=!0);e&&b.vm&&b.vm.hooks&&g.execAll(b.vm.hooks.didMount);return d}function u(b,d,c){(c||b.parent.el).insertBefore(b.el,d)}function k(b,d,c,a,e){var h=g.isArr(b),f=h?b[2]||null:b.key,l=c.hasKeys,p=d.hasKeys;c=c.body;d=d.body;if(null!==f&&l&&(f=g.indexOfKey(f,c),-1<f))return[f,
2];a=a||0;if(a>c.length-1)return null;e=0===e?0:e||c.length-1;for(f=null;a<=e;a++)if(l=c[a],null!==l&&l.el)if(h&&l.vm){if(l.vm.view[0]===b[0]){if(l.vm.view[1]===z(b[1],b[2]))return[a,2];var k=!1;if(J.viewScan)for(var y=0;y<d.length;y++){var n=d[y];if(!n.el&&n.vm&&n.vm.view[0]===l.vm.view[0]&&n.vm.view[1]===l.vm.view[1]){k=!0;break}}k||f||!p||-1!=g.indexOfKey(l.key,d)||(f=[a,1])}}else if(b.type===l.type&&(b.type===g.TYPE_TEXT||null!==b.tag&&b.tag===l.tag)&&(null===l.key||!p||-1==g.indexOfKey(l.key,
d)))return[a,1];return f}function q(b,d){d.el=b.el;b.el=null;if(d.type===g.TYPE_TEXT&&d.body!==b.body)d.el.nodeValue=d.body;else{l(d,b);var c=!g.isArr(d.body),a=!g.isArr(b.body);c&&d.body!==b.body?a&&d.el.firstChild?d.el.firstChild.nodeValue=d.body:d.raw?d.el.innerHTML=d.body:d.el.textContent=d.body:a&&!c&&(d.el.textContent="");b.moved=!0}}function x(b,d,c,a,e,h){if(b){var f=b["will"+d];g.isArr(f)&&(f=f[0]);var l=b["did"+d];g.isArr(l)&&(l=l[0]);b=function(){c.apply(null,a);l&&l.apply(null,h||e||a)};
f?(f=f.apply(null,e||a),g.isProm(f)?f.then(b):b()):b()}else c.apply(null,a)}function C(b){if(b in L)return L[b];var d={tag:null,id:null,"class":null};d.tag=b.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(b,c,e,a){e&&(d.id=e);a&&(d["class"]=a.replace(/\./g," ").trim());return c||"div"});return L[b]=d}function p(b,d,c,a){return function(e){var c,f=e.target._node,l=null;if(g.isFunc(b))c=b.call(d,e,f,a);else if(g.isArr(b))l=b.slice(1),c=b[0].apply(d,l.concat(e,f,a));else if(g.isObj(b))for(var p in b){var k=
b[p];e.target.matches(p)&&(g.isArr(k)?(l=k.slice(1),c=k[0].apply(d,l.concat(e,f,a))):g.isFunc(k)&&(c=k.call(d,e,f,a)))}!1===c&&(e.preventDefault(),e.stopPropagation());a.opts.hasOwnProperty("watch")&&a.opts.watch.fire({type:"event",vm:a,node:f,event:e,data:l})}}function l(b,d){var c=!d;d=d||{};if(d.props||b.props){var a=d.props||{},e=b.props||{},f=a.style,l=e.style;if(g.isObj(f)||g.isObj(l))G(b.el,b.tag,f||{},l||{},M,N,b.ns,c),a.style=e.style=null;G(b.el,b.tag,a,e,O,I,b.ns,c);l&&(e.style=l)}}function G(b,
d,c,a,e,f,l,g){for(var p in a)null!==a[p]&&("."===p[0]?b[p.substr(1)]!==a[p]:a[p]!==c[p])&&e(b,p,a[p],l,g);for(p in c)null!==c[p]&&null==a[p]&&f(b,p,l,g)}function M(b,d,a){b.style[d]=g.autoPx(d,a)}function N(b,d){b.style[d]=""}function O(b,d,a,c,e){"."===d[0]?(d=d.substr(1),"svg"===c?b[d].baseVal=a:b[d]=a):"class"===d?b.className=a:"id"===d||g.isEvProp(d)?b[d]=a:!1===a?I(b,d,c,e):b.setAttribute(d,!0===a?"":a)}function I(b,d,a,c){c||("."===d[0]?(d=d.substr(1),"svg"===a?b[d].baseVal=null:b[d]=null):
"class"===d?b.className="":"id"===d||g.isEvProp(d)?b[d]=null:b.removeAttribute(d))}var F={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},L={},K="undefined"==typeof document?{}:document,J={useRaf:!0,viewScan:!1,useDOM:!1};v.view=r;v.view.config=function(b){J=b};var H=null;v.view.extend=function(b,d){H=!H||d?[]:H;H.push(b)};var g=v.util;return v})(domvm);(function(v){var z=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,r=v.util;v.html=function(a){var c="";switch(a.type){case r.TYPE_ELEM:c+="<"+a.tag;if(a.props){var w=r.isVal(a.props.style)?a.props.style:"",m=r.isObj(a.props.style)?a.props.style:null;if(m)for(var f in m)null!==m[f]&&(w+=r.camelDash(f)+": "+r.autoPx(f,m[f])+"; ");for(f in a.props)r.isEvProp(f)||"."===f[0]||(m=a.props[f],r.isFunc(m)&&(m=m()),r.isObj(m)||(!0===m?c+=" "+f:!1!==m&&null!==m&&
"."!==f[0]&&(c+=" "+f+'="'+m+'"')));w.length&&(c+=' style="'+w.trim()+'"')}if(a.ns&&"svg"!==a.tag&&"math"!==a.tag&&!a.body)return c+"/>";c+=">";break;case r.TYPE_TEXT:return a.body}z.test(a.tag)||(r.isArr(a.body)?a.body.forEach(function(a){c+=v.html(a)}):c+=a.body||"",c+="</"+a.tag+">");return c}})(domvm);(function(v){var z=v.util;v.watch=function(r){function a(){}function c(c,y,u,k,q){q=q||{};q.method=(q.method||c).toUpperCase();if(null!==u){var x=Object.prototype.toString.call(u);"[object Array]"===x||"[object Object]"===x?(q.headers=q.headers||new Headers,q.headers.set("Content-Type","application/json"),q.body=JSON.stringify(u)):q.body=""+u}var x=k,C=a;k instanceof Array&&(x=k[0],k[1]&&(C=k[1]));var p={type:"fetch",fetch:{method:c,url:y,body:u}};k=fetch(y,q).then(function(a){if(200<=a.status&&300>
a.status)return a;var c=Error(a.status+": "+a.statusText);c.data=a;return Promise.reject(c)}).then(function(a){switch(a.headers.get("Content-Type").split("; ")[0]){case "application/json":return a.json();case "text/plain":return a.text();default:return a}}).then(x,C).then(function(a){!1!==a&&m.fire(p);return a},function(a){p.error=a;m.fire(p);return a});k._fetchArgs=[c,y,u,[x,C],q];return k}var w=[];z.isFunc(r)&&w.push(r);var m={on:function(a){w.push(a);return m},off:function(a){w.splice(w.indexOf(a),
1);return m},fire:z.raft(function(){z.execAll(w,arguments);return m}),prop:function(f,y){var u=f,k=function(a,c){if(arguments.length&&a!==u){var f=u;u=a;!1!==c&&m.fire({type:"prop",prop:k,data:{old:f,"new":a}})}return u};if(y&&y.then){k.update=a;if(y._fetchArgs){var q=y._fetchArgs[3];y._fetchArgs[3]=[function(a){return k(q[0]?q[0](a):a)},q[1]];k.update=function(){c.apply(null,y._fetchArgs)}}y.then(k)}return k.toString=k},sync:function(a,c,m){var k=a,q=c;"string"==typeof a&&(k=function(c){return"e."===
a.substr(0,2)?c[a.substr(2)]:c.target[a]});return function(a,f){var p=this!==window?this:null;p&&"string"==typeof c&&(q=function(a,f){var k=p[c];p[c]=a;r&&a!==k&&!1!==f&&r()});q(k(f),m)}},get:function(a,m,u){return c("get",a,null,m,u)},"delete":function(a,m,u){return c("delete",a,null,m,u)},post:function(a,m,u,k){return c("post",a,m,u,k)},put:function(a,m,u,k){return c("put",a,m,u,k)},patch:function(a,m,u,k){return c("patch",a,m,u,k)}};return m}})(domvm);(function(v){function z(a,c,m,k,q,x){var r=null,p=null,l=null;if("/"==m[0]){l=m;p=!1;k={};x=l.split("#");c=x[0].split("?");r=c[0];x=x[1];c[1]&&(q={},c[1].split("&").map(function(a){a=a.split("=");q[a[0]]=null==a[1]?!0:a[1]}));var G,w;for(w in a){m=a[w];var v=m.path;if(G=r.match(m.regexPath)){p=w;-1!==v.indexOf(":")&&(k={},G.shift(),v.replace(/:([^\/]+)/g,function(a,c){k[c]=G.shift()}));break}}}else{p=m;m=a[p];var v=c+m.path,z=m.vars||{},I=/^[^\/]+$/,l=-1!==v.indexOf(":")?r=v.replace(/:([^\/]+)/g,
function(a,c){if((z[c]||I).test(k[c]))return k[c]+="";throw Error("Invalid value for route '"+v+"' segment '"+c+"': '"+k[c]+"'");}):r=v;if(q){var l=l+"?",F;for(F in q)l+=F+(!0!==q[F]?"="+q[F]:"")+"&";l=l.slice(0,-1)}l+=x?"#"+x:""}return{href:l,name:p,path:r,segs:k,hash:x,query:q}}function r(a,c){for(var m in a){var k=a[m];k.regexPath=new RegExp("^"+c+k.path.replace(/:([^\/]+)/g,function(a,c){var f=""+k.vars[c];return"("+f.substring(1,f.lastIndexOf("/"))+")"})+"$")}}var a=[],c=null,w=!1,m="";v.route=
function(f,v){function u(){var a=location,a=w?a.href.substr(a.origin.length):a.hash.substr(1)||"/";return z(C,m,a)}var k=null,q={href:function(a,c,f,k,r){var u=z(C,m,a,c,f,k);return w?(a=function(a){q["goto"](u,null,null,null,r);a.preventDefault()},a.href=u.href,a):"#"+u.href},config:function(a){(w=a.useHist)&&(m=a.root||"");k=a.init||null},refresh:function(){q["goto"](u(),null,null,null,!0)},"goto":function(f,l,k,q,r){r=r||x;f.href||(f=z(C,m,f,l,k,q));if(!1===f.name)console.log("Could not find route");
else{l=null;for(k=0;k<a.length;k++)if(a[k].path===f.path){l=k;break}null===l&&(a.splice(c+1,1E4),a.push(f),l=a.length-1);f=a[c];k=a[l];q=!0;null!==c&&(q=(q=C[f.name].onexit)?q.apply(null,(f?[f.segs,f.query,f.hash]:[]).concat(k)):!0);if(!1!==q&&!1!==C[k.name].onenter.apply(null,(k?[k.segs,k.query,k.hash]:[]).concat(f))){if(w)history[r?"replaceState":"pushState"](null,"title",k.href);c=l}x=!1}},location:function(){return x?u():a[c]}},x=!0,C=f(q,v);r(C,m);window.onhashchange=window.onpopstate=function(a){(w||
"popstate"!=a.type)&&q["goto"](u(),null,null,null,!0)};k&&k();return q}})(domvm);
